[["index.html", "TUFLOW FV Water Quality Module User Manual ", " TUFLOW FV Water Quality Module User Manual January 2022 "],["introduction.html", "Introduction About this manual How to use this manual", " Introduction About this manual This document is the user manual for the TUFLOW Water Quality Module (WQM), release 2022.00. How to use this manual Instructions are provided below on how to use this manual, including aspects of navigation, table filtering, plot animation and network diagram interaction. These instructions are not provided elsewhere. Navigation This manual is designed for digital use within any web browser and has the following features: Section headers, to level three, are directly navigable via the left hand pane table of contents. This table of contents pane can be toggled on and off from view via the s key if more or less page width is required The angled arrows that float at the left and right hand side midpoints of every page can be used to navigate sequentially back and forth to the commencement of preceding or subsequent top level sections Model commands, parameters and cross references for tables and figures are navigable through hyperlinks, where appropriate The space bar can be used to scroll down within each page without skipping text. Shift + space bar will similarly scroll up Browser back and forward buttons (or their equivalent keyboard shortcuts alt + \\(\\langle\\)left arrow\\(\\rangle\\) and alt + \\(\\langle\\)right arrow\\(\\rangle\\), respectively) can be used to navigate through browsing history. Some browsers may not return to the location in a page last visited, but to the last clicked section header. Hyperlinks have been built into the body of the manual to avoid this potential and these hyperlinks should be used to navigate back and forth in the first instance It is recommended that this manual be viewed in a browser window that is maximised or operating in full screen mode, with the latter (although browser dependent) typically toggled via the F11 key. When following hyperlinks, the target is displayed at the top of the landing page. The exception to this occurs when a target is located near the bottom of the landing pages content. In this case the target will appear below the top of the landing page. Searching This entire manual content can be searched by using the search box at the top of the table of contents pane (i.e. screen top left near the TUFLOW logo). This search box can be toggled on and off by clicking the search icon (magnifying glass) at the top left of any page. The table of contents is dynamically filtered in response to entering text in the search box, and clicking on any remaining table of contents entry will navigate directly to the searched text. Searched text will be highlighted within a page for easy identification, and instances can be navigated through by using the up and down arrow keys. Clearing the search box will restore the table of contents. Tables Where appropriate, tables are searchable via use of the search box, which is located at the top right of any search enabled table. Not all tables are searchable. When text is entered into the search box then table rows are dynamically filtered to only show those that contain the search text. This allows on-the-fly condensing of large tables so that only relevant content is presented. Tables can be sorted alphabetically (or reverse alphabetically) with respect to any column by clicking column headers. Where appropriate, the number of rows displayed is selectable via the Show entries drop down. Undisplayed rows can be accessed by clicking Previous or Next or by using the numbered navigation boxes, all of which are located at the bottom of each table. Below is an example of a searchable table. Type nitrate (without the inverted commas) into the search box to see the table behaviour, or change the number of rows displayed (given this demonstration table has nine rows, only selecting 5 will change the number of rows displayed) and use the navigation buttons at the bottom of the table to look through all the data. The right hand column has hyperlinked words that allow navigation between related commands, or different versions of the same command, for ease of access. All hyperlinks have been deliberately disabled in this demonstration table, but are active (and explained) in tables elsewhere in this manual. Command Description Links oxygen flux == \\(\\langle\\)\\(F_{sed}^{O_2}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of oxyegn. Simulation construction section 4.6.4. \\(\\text{ }\\) nitrogen model == \\(\\langle\\)AmmoniumNitrate\\(\\rangle\\) Used to commence an inorganic nitrogen constituent model block via specification of a constituent model from the inorganic nitrogen constituent model class. Simulation construction section 4.7.3.3. \\(\\text{ }\\) atmospheric deposition == \\(\\langle\\)\\(\\left[{TN}\\right]_{rain}\\),\\(R_{atm-dry}^{TN}\\),\\(f_{TN}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to control the wet and dry atmospheric deposition of inorganic nitrogen. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) denitrification == \\(\\langle\\)Michaelis Menten,\\(R_{denit}^{NO_3}\\),\\(K_{denit-O2-MM}^{NO_3}\\),\\(\\theta_{denit}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to activate the Michaelis Menten model and control denitrification and its response to ambient oxygen concentrations and temperature. Simulation construction section 4.7.3.3.1 exponential denitrification == \\(\\langle\\)exponential,\\(R_{denit}^{NO_3}\\),\\(K_{denit-O2-exp}^{NO_3}\\),\\(\\theta_{denit}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to activate the exponential model and control denitrification and its response to ambient oxygen concentrations and temperature. Simulation construction section4.7.3.3.1 Michaelis Menten FRP min max == \\(\\langle\\)\\(\\left[FRP\\right]_{min}^{FRP}\\),\\(\\left[FRP\\right]_{max}^{FRP}\\)\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to set minimum and maximum FRP concentrations. Simulation construction section 4.7.3.4.1 \\(\\text{ }\\) temperature limitation == \\(\\langle\\)none\\(\\rangle\\) Used in a phytoplankton constituent model block to turn off phytoplankton group temperature limitation. Simulation construction section 4.7.3.5.1.1 standard temperature limitation == \\(\\langle\\)standard,\\(T_{std}^{phy}\\),\\(T_{opt}^{phy}\\),\\(T_{max}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set the standard phytoplankton group temperature limitation function. Simulation construction section 4.7.3.5.1.1 none oxygen == \\(\\langle\\)on;off\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to switch the dependence of FRP processes on dissolved oxygen on or off. Simulation construction section 4.7.3.4.1 \\(\\text{ }\\) Colour coding is often used for distinguishing different tabulated data types. In the above example, WQM commands are pink and the associated argument options for each command are blue and contained in angled parentheses. Colour coding applied to other table types is explained throughout this manual when required. Figures Where appropriate, this manual contains interactive figures that support understanding of processes and the influence of specifiable parameters on water quality outcomes. The figure below provides an example. Move the slider or press play to see the effect a sediment property has on water column concentrations. Zoom in by clicking and dragging out a box within the plot axes to be enlarged, and double click to return to the original axis limits. Mouse hover over a line on the figure to see plotted values. Networks Interactive networks are used to assist in describing simulation architectures and process descriptions. In all cases, networks comprise nodes and connecting lines. In the case of architecture networks, nodes are coloured and labelled circles. These nodes represent items within water quality architectural levels and are coloured as simulation classes, model classes, constituent models, or computed variables. Architectural relationships are displayed as connecting directional lines, with each lines colour matching that of its originating node In the case of process descriptions, nodes are coloured and labelled and are either circles (processes) or squares (computed variables). Circular process nodes are coloured as sources or sinks of computed variables. Where a process is both source and sink, its fill and outline are coloured accordingly. Square computed variables are all presented as the same colour. Process and computed variable relationships are displayed as connecting directional lines, with each lines colour indicating whether its direction is a source or sink with respect to its originating node. Connecting lines may have midpoint labels, and where present, these indicate indirect relationships to additional processes or computed variables. Single click anywhere on a network to activate interaction. A clicked network will show as being boxed in blue when activated. Once activated: Single clicking or hovering over a node will highlight its nearest neighbours. Single clicking anywhere off the network will deselect these. The intention is that this allows users to quickly identify related processes and computed variables Using the Select by id drop down menu will select a particular node of interest. Its nearest neighbours will also be automatically selected Single clicking, holding and dragging a node will drag the network or node Using the mouse wheel will zoom in and out of the network Double clicking on any node that has the label starting text Cluster on group : will explode the nodes to see its containing subsiduary nodes Double clicking on any node within an exploded group will implode the group back to its original state Clicking the Reinitialize clustering button at the bottom of a network that uses clustering will return an exploded network to its original position, zoom and unexploded state. Not all networks use clustering so this button may not always be present Networks are deactivated when anywhere outside its blue box is clicked. In some instances, the network may explode to a position outside the original view frame, and some nodes or connecting lines might disappear. This is intentional, and prevents networks rescaling and becoming unreadably small. If this does happen and content of interest is off screen, simply use the mouse wheel to zoom out, or click, hold and drag the network in a direction that will bring obscured nodes back on screen, or do both. Below are example architecture and process description networks to explore. Commands Where specific commands are described, they appear in highlighted text, and often as a clickable link to the corresponding command description in Appendix B. That Appendix is a searchable table of all commands, as per the demonstration table presented in this section. The below is an example of a WQM command (the hyperlink has been disabled for this example). \\(\\newcommand{\\blockindent}{\\hspace{0.5cm}}\\) simulation class == Where commands specify computed variable parameters (e.g. half saturation concentrations, sediment fluxes etc.) then for consistency and brevity, these parameters are included directly in the command example using their notation (see following section that describes notation) rather than descriptive words. These notated parameters are also often a clickable link to descriptive explanations in Appendix O. The link below is an example of a WQM command with variables presented in their respective notations. Hyperlinks have been removed in this example. \\(\\blockindent\\) oxygen benthic == \\(K_{sed-O_2}^{O_2}\\), \\(\\theta_{sed}^{O_2}\\) Parameter notation The primary groups of computed variable parameters are listed below, with the letter or symbol used to denote each. Typical generalisations of units are parenthesised. Fluxes, \\(F\\) (mass/moles per unit area/volume per unit time) Rates, \\(R\\) (per unit time) Concentrations, \\(K\\) (mass or moles per unit volume) Temperature coefficients, \\(\\theta\\) (dimensionless) Fractions, \\(f\\) (dimensionless decimal between 0.0 and 1.0) Ratios, \\(X\\) (dimensionless decimal that may be greater than 1.0, but always non-negative) Limitation functions, \\(L\\) (a dimensionless decimal between 0.0 and 1.0) Power exponents, \\(P\\) (typically dimensionless), and Velocities, \\(V\\) (metres per day) Typically (but not always) an instance of each of these groups will describe a computed variable and a process. Where appropriate, the computed variable and process are denoted as superscripts and subscripts, respectively. For example: The flux of oxygen across the sediment-water interface is notated as \\(F_{sed}^{O_2}\\) The rate of denitrification of nitrate is notated as \\(R_{denit}^{NO_3}\\), The half saturation concentration of oxygen controlling the flux of free reactive phosphorus across the sediment-water interface is notated as \\(K_{sed-O_2}^{FRP}\\) The temperature coefficient controlling the flux of ammonium across the sediment-water interface is notated as \\(\\theta_{sed}^{NH_4}\\) The fraction of total nitrogen rainfall concentration (or dry atmospheric fallout) that is nitrate is notated as \\(f_{atm-TN}^{NO_3}\\) In describing calculation processes (primarily in the Appendices) where a quantity is recomputed by the WQM as a direct modification of a user input or previously calculated quantity, then \\(\\left&lt; computed \\right&gt;\\) is used in the quantitys subscript. For example, a user can specify a sediment flux of ammonium, which is a parameter notated as \\(F_{sed}^{NH_4}\\). The WQM can modify this parameter based on dynamic environmental conditions, and if so, the modified quantity is notated as \\(F_{sed \\left&lt; computed \\right&gt;}^{NH_4}\\). Concentration nomenclature Examples of processes and model simulations are provided in this manual, and these in turn refer to computed variable concentrations. These concentrations are denoted in square brackets, such as \\(\\left[NO_3\\right]\\) for nitrate. The commonly accepted nomenclature for these variable concentrations is used in this manual, such as nitrate concentration. The numerical value of this concentration refers, however, to the concentration of elemental nitrogen within nitrate molecules: 6 mg/L of nitrate means 6 mg/L of elemental nitrogen that is contained within nitrate molecules, not 6 mg/L of nitrate molecules. This is implicit in all references to all computed variables. More detail in this regard is provided in Section 4.2, which should be reviewed carefully. Feedback Constructive suggestions to improve this manual are welcome, and can be emailed to support@tuflow.com. "],["Overview-1.html", "Section 1 Overview 1.1 Context 1.2 Features 1.3 Science 1.4 Support", " Section 1 Overview 1.1 Context The TUFLOW Water Quality Module (WQM) enables the two- or three-dimensional simulation of water quality and ecological processes in natural and constructed waterways such as (but not limited to) lakes, tidal estuaries, river systems and coastal oceans. The modules design is flexible so as to support tailoring of its setup to meet individual application demands and complexity. TUFLOWs WQM is currently supported for use with TUFLOW FV. \\(\\newcommand{\\blockindent}{\\hspace{0.5cm}}\\) 1.2 Features 1.2.1 Usability Several key features have been included in the design of the WQM to support its use. Some are listed below. Simulation units. The units of simulation (including specification of initial conditions, boundary conditions and computed variable parameters) can be selected as either the commonly used mg/L (and \\(\\mu\\)g/L for phytoplankton) system, or the mmol/m\\(^3\\) system Library defaults. The WQM comes packaged with a fully populated library of default settings for all computed variable parameters. This means that users can quickly set up water quality simulations that automatically draw on these library defaults, with a view to then progressively overriding these defaults and therefore customising simulations to suit Command syntax. The WQM uses familiar TUFLOW style command == argument(s) syntax that has a long established pedigree within other TUFLOW products, for example: \\(\\blockindent\\) oxygen benthic == 4.0, 1.07 Log file user feedback. WQM simulations generate a log file that reports all simulation configuration details for immediate review Output variable names. The WQM output variable names are descriptive and include the units used, for example WQ_DISSOLVED_OXYGEN_MGL Specification of concentration limits. The WQM allows users to optionally specify minimum and maximum concentation limits for each computed variable, and the WQM will reset concentrations to these limits if exceedences are detected. All instances of resetting are reported to the WQM log file as continuous commentary Inbuilt guidance on parameter specification. The WQM checks all user specified parameters and compares them to typical ranges. If a parameters specified value falls outside a typical range, then a warning is reported to the WQM log file. These ranges are listed in Appendix O of this manual 1.2.2 Constituents and processes Constituents currently simulated by the WQM include: Dissolved oxygen Silicate Inorganic nitrogen Inorganic phosphorus Organic matter (labile and refractory), and Phytoplankton (multiple groups) Processes captured by the WQM include: Water column transformations between constituents (e.g. nitrification) Benthic sediment  water column interactions (e.g. sediment oxygen consumption) Atmospheric exchange (e.g. oxygen dissolution and rainfall deposition) Primary productivity, respiration and exudation of one or more phytoplankton groups Future near-term releases of the WQM will include the ability to simulate: Pathogens Zooplankton Biogeochemical particles (linked dynamically to TUFLOW FVs Particle Tracking Module (PTM)) Benthos (e.g. bivalves and macrophytes) Future mid-term releases will include: Sediment diagenesis Geochemistry 1.3 Science The science underpinning the WQM is that developed at the School of Agriculture and Environments Oceans Institute at The University of Western Australia. The WQM has wrapped this world class science into a form that is easily accessed via familiar TUFLOW style commands and workflows, and offers the additional features described in Section 1.2.1. 1.4 Support BMT sells, distributes and supports the WQM. Contact support@tuflow.com or sales@tuflow.com for support and sales inquiries, respectively. Several supporting appendices have also been included in this manual. These contain interactive content to assist users in understanding and applying the WQM, beyond what might typically be included in a static user manual. These Appendices are: Appendix A Description of command syntax and nomenclature Appendix B Listing of all commands, and their syntax, arguments, descriptions and cross references Appendix C Listing and descriptions of all computed variables, with chemical information Appendices D to N Detailed process descriptions, including worked examples using a purpose built small demonstration model Appendix O Explanations of all parameters, with symbology, minimums and maximum values, units and commentary Appendix P Listing and explanation of intermediate quantities that influence the evolution of simulated computed variables Appendix Q Demonstration of the mass balance properties of core WQM computed variables "],["Architecture-1.html", "Section 2 Architecture 2.1 Context 2.2 Simulation Tiers 2.3 Linkage with TUFLOW FV 2.4 Linkage with Other Hydrodynamic Models", " Section 2 Architecture This section provides a description of the WQMs architecture. This description is intentionally introductory, and details required to set up and execute simulations that deploy the WQM are provided in Section 4. The manuals introduction should be reviewed for instructions regarding the use of interactive components deployed in this manual. \\(\\newcommand{\\blockindent}{\\hspace{0.5cm}}\\) 2.1 Context As our understanding of the natural environment advances, the questions asked of water quality and ecological numerical models are rapidly increasing in breadth and complexity. Setting up, calibrating and executing defensible environmental models has therefore become an increasingly challenging proposition. The architecture of the WQM has been deliberately designed to assist users in overcoming some of these challenges, and in doing so improve the efficiency and effectiveness with which numerical modelling can support environmental management. Importantly, the WQMs architecture provides a mechanism by which users can rapidly initiate and execute water quality simulations without (at least in early modelling stages) concerning themselves with the often time consuming set up and parameterisation of simulated environmental processes. In short, the WQM has been designed to provide immediate and easy access to its supporting state of the art environmental modelling science. The architecture that provides this easy access is tiered and these tiers are described below. 2.2 Simulation Tiers The WQMs tiers are described below using the nomenclature of Figure 2.1. Every WQM simulation has the following tiers: Tier 1: Exactly one instance from a simulation class. This is user defined Tier 2: A suite of instances from a model class. The suite (and therefore number) of these instances is preset per simulation class. The exception to this is the phytoplankton model class, which when included in a simulation class can have as many instances within the suite as required by the user, with one instance (the default) per simulated phytoplankton group Tier 3: Exactly one constituent model per model class instance (these are user selectable and there may be more than one constituent model available to choose from within a given model class instance) Tier 4: At least one computed variable per constituent model (the suite of computed variables is preset within each constituent model) Figure 2.1: WQM tiers Notwithstanding the above, a user need not specify any of the above in order to rapidly set up and execute a first pass WQM simulation. In this case, the WQM will automatically set the simplest instances of the simulation class, model classes, constituent models and computed variables by drawing on library defaults. Simulation tiers are described below. 2.2.1 Tier 1: Simulation Class This is the highest and overarching tier of the WQMs architecture. Using a single command, this tier sets the overall water quality simulation structure, including the suite of model classes to be deployed (with potentially multiple phytoplankton model classes), and therefore the corresponding suite of constituent models and computed variables. The available simulation classes are provided in Table 2.1 as their keywords, together with example uses of each. The simulation class instances are cumulative, that is, a more complex class instance will include all the capability of simpler class instances. Complexity increases with table row in Table 2.1. Table 2.1: WQM simulation class instances Simulation Class Instance Potential Uses DO Simulation of rudimentary dissolved oxygen dynamics such as:\\(\\cdot\\blockindent\\)Desalination return water impact analyses\\(\\cdot\\blockindent\\)Seasonal reservoir oxygen analyses\\(\\cdot\\blockindent\\)Agricultural drain oxygen analyses Inorganics Simulation of relatively simple aquatic ecosystems that experience primary productivity such as:\\(\\cdot\\blockindent\\)Shallow urban lakes\\(\\cdot\\blockindent\\)Smaller estuaries\\(\\cdot\\blockindent\\)Coastal ocean zones that are relatively free of organic materials or sediments\\(\\cdot\\blockindent\\)Mine voids Organics Simulation of more complex aquatic ecosystems such as:\\(\\cdot\\blockindent\\)Impacted coastal embayments or nearshore zones\\(\\cdot\\blockindent\\)Impacted lakes\\(\\cdot\\blockindent\\)Larger estuaries\\(\\cdot\\blockindent\\)Wetlands\\(\\cdot\\blockindent\\)Aquaculture operations\\(\\cdot\\blockindent\\)Environments receiving point and/or diffuse source organic pollutants Users can simply specify one preset simulation class (e.g. organics) in a water quality control file (Section 4.4 and following sections), and the WQM will draw on inbuilt library defaults to automatically construct and execute a water quality simulation, with no further user input required (beyond specification of water quality initial conditions, see Section 4.4.2). For example, a user may simply specify simulation class == organics and initial conditions, and the WQM will construct itself, execute and report simulation details via a log file. This initial level of simplicity is intended. 2.2.2 Tier 2: Model Class Each simulation class instance contains a preset suite of model class instances. These suites cannot be changed (although there may be multiple phytoplankton model class instances in simulation classes that include phytoplankton), and are provided in Table 2.2 and as a network in Figure 2.2. For example, simulation class instance inorganics has the fixed suite of oxygen, silicate, inorganic nitrogen, inorganic phosphorus and (potentially multiple) phytoplankton model class instances. Table 2.2: WQM simulation class instances and corresponding preset model class suites Simulation Class Instance Model Class Suite DO \\(\\cdot\\blockindent\\)Oxygen Inorganics \\(\\cdot\\blockindent\\)Oxygen\\(\\cdot\\blockindent\\)Silicate\\(\\cdot\\blockindent\\)Inorganic Nitrogen\\(\\cdot\\blockindent\\)Inorganic Phosphorus\\(\\cdot\\blockindent\\)Phytoplankton (potentailly multiple) Organics \\(\\cdot\\blockindent\\)Oxygen\\(\\cdot\\blockindent\\)Silicate\\(\\cdot\\blockindent\\)Inorganic Nitrogen\\(\\cdot\\blockindent\\)Inorganic Phosphorus\\(\\cdot\\blockindent\\)Organic matter\\(\\cdot\\blockindent\\)Phytoplankton (potentially multiple) Figure 2.2: WQM simulation class and model class instances 2.2.3 Tier 3: Constituent Model Whilst the suite of model class instances is set per simulation class instance, constituent models are interchangeable within a model class. In this way, a simulation class instance (at Tier 1) can be customised at the constituent model tier (at Tier 3), despite having a preset suite of model classes (at Tier 2, with potentially multiple phytoplankton model class instances). Available constituent models are provided in Table 2.3, and presented graphically in Figure 2.3 as a direct extension of Figure 2.2. Table 2.3: WQM model classes and corresponding available constituent models Model Class Available Constituent Models Oxygen O2 Silicate Si Inorganic Nitrogen AmmoniumNitrate Inorganic Phosphorus FRPhs FRPhads Organic Matter Labile Refractory Phytoplankton Basic Advanced Figure 2.3: WQM simulation class and model class instances, with available constituent models For example, multiple phosphorus constituent models are available within the phosphorus model class, where these models execute different water quality processes and contain different computed variables. In this example, this can be set with a single line command: phosphorus model == frphsads \\(\\blockindent\\) \\(\\langle commands \\rangle\\) end phosphorus model This allows a user to interchange one phosphorus constituent model for another within the phosphorus model class, thereby customising the overarching simulation class instance. The environmental processes simulated within each constituent model are fixed. Despite this, these processes can nonetheless be switched on and off as required, offering an additional layer of customisation. For example, if oxygen is not required to be included in silicate sediment flux calculations, the linkage between these processes and oxygen can be turned off by setting: oxygen == off Alternatively, if a user wishes to simulate all inorganic processes other than nitrification for example, then the rate describing this unwanted process can simply be set to zero (as per the following command - the first numerical argument is the nitrification rate) and it will be turned off. All library defaults also set rate processes to zero. \\(\\blockindent\\) nitrification == 0.0, 0.0, 1.0 All processes included within each constituent model, and their respective WQM commands, are described in Sections 3 and 4, respectively. 2.2.4 Tier 4: Computed Variables Each Tier 3 constituent model contains a fixed set of computed variables. Table 2.4 (which is a direct extension of Table 2.3) provides the mapping between model classes, constituent models and their associated computed variables. These maps are also provided graphically in Figure 2.4, which is an extension of Figure 2.3, but presented in a non-hierarchical form. Click or hover over outer nodes to track their paths up the simulation tree. Table 2.4: WQM model classes, available constituent models and computed variables Model Class Available Constituent Models Computed Variables Oxygen O2 Dissolved oxygen Silicate Si Silicate Inorganic Nitrogen AmmoniumNitrate AmmoniumNitrate Inorganic Phosphorus FRPhs Free reactive phosphorus (FRP) FRPhads FRPAdsorbed FRP Organic Matter Labile Labile dissolved and particulate organic carbon, nitrogen and phosphorus Refractory Labile dissolved and particulate organic carbon, nitrogen and phosphorusRefractory organic carbon, nitrogen and phosphorus Phytoplankton Basic Phytoplankton concentration and potentially cell density Advanced Phytoplankton concentration, internal nitrogen, internal phosphorus and potentially cell density Figure 2.4: WQM simulation class and model class instances, available constituent models and computed variables Parameters that govern the behaviour of computed variables are set within each constituent model. Parameters that are not set by the user are populated automatically from the WQM library defaults. 2.3 Linkage with TUFLOW FV 2.3.1 Process Support is currently provided for linkage of the WQM with TUFLOW FV. Within this linkage, TUFLOW FV considers the WQM as a peripheral model with which it interacts at arms length. The role of TUFLOW FV is that it (in approximate run time order): Requests the number of water quality constituents from the WQM at start up, based on user setup specifications (e.g. the setting of the simulation class instance, with any constituent model modifications) Automatically sets up the corresponding number of tracers (one for each computed variable) within its simulation (users do not specify these tracers) Is then responsible for the: Application of WQM initial conditions Conservative advection and dispersion of these tracers (that represent the WQMs computed variables) Application of WQM boundary conditions Calling the WQM at a user specified time step for the WQM to execute non-conservative transformation calculations on the suite of passive tracers Writing of WQM results files For example, if a WQM simulation was set to consider only dissolved oxygen, then TUFLOW FV would automatically allocate one tracer for the dissolved oxygen variable (the user does not need to specify passive tracers within TUFLOW FV), and advect and disperse that tracer throughout the model domain in response to initial and boundary conditions. At a user defined interval, TUFLOW FV would send the two- or three-dimensional tracer concentration field to the WQM for it to be modified in response to non-conservative ecological processes The WQM would then return this modified tracer field to TUFLOW FV for subsequent advection and dispersion, with this exchange process continuing to simulation end. 2.3.2 Treatment of light The TUFLOW FV heat module must be activated in order to use the WQM. One reason for this (beyond the need to compute water temperature) is that the heat module includes calculation of the light field within the model domain. This light field is used by various WQM constituent models, with the most notable being phytoplankton which uses photosynthetically available radiation (PAR). In order to provide this light field, TUFLOW FV splits the shortwave radiation specified in the heat module into four bands: near infrared (NIR) photosynthetically available radiation (PAR) ultraviolet A (UVA), and ultraviolet B (UVB) This split can be executed using TUFLOW FV defaults, or be user specified. The corresponding band extinction coefficients in water with zero suspended sediment can also be specified in TUFLOW FV, as can the corresponding four extinction coefficients that apply when suspended sediment is present. Defaults are also available for all these coefficients. TUFLOW FV uses these coefficients, along with other simulation properties, to compute the four light band intensities at the faces and centroids of each computational cell. These intensities are passed to the WQM for use in constituent model calculations. This approach ensures consistency in the treatment of light between TUFLOW FV and the WQM. The WQM can also modify the light field sent to it from TUFLOW FV via calculation of phytoplankton self shading (section N.1). This is intended to represent the water column shading induced by surface phytoplankton primary productivity. If this occurs, the WQM returns a modified light extinction coefficient field to TUFLOW FV that is then used in subsequent hydrodynamic heat and light calculations. This modification only occurs for simulation classes beyond DO, i.e. only for simulation classes that include the phytoplankton constituent model. 2.4 Linkage with Other Hydrodynamic Models The above communication between TUFLOW FV and the WQM is affected via implementation of a publicly available application programming interface (API). This API effectively sets the rules by which TUFLOW FV and the WQM communicate, and separates their roles. This API has been designed so that TUFLOW FV can drive any other water quality model that includes the API in its compilation. This is intentional, and allows users of other ecological models to access the hydrodynamic power of TUFLOW FV for their simulations. Contact support@tuflow.com for further information or assistance in this regard. "],["ProcessDescriptions-1.html", "Section 3 Process Descriptions 3.1 Simulation Class: DO 3.2 Simulation Class: Inorganics 3.3 Simulation Class: Organics", " Section 3 Process Descriptions Previous chapters have presented an overview of the architecture and capabilities of the WQM, together with a summary of its interactions with TUFLOW FV. This chapter presents the details of each simulation class (see Table 2.1) in terms of its available model classes, the constituent models within those model classes, and the associated computed variables. Process descriptions are listed in this section primarily by name in tables and/or networks, without inclusion of detail. This is deliberate. For clarity, equations supporting all process descriptions have been provided and explained in the Appendices, and every process tabulated in this section has been hyperlinked to the relevant section in that Appendix. Tabular process hyperlinks are colour coded as sources or sinks relative to each computed variable, where applicable. Potential interactions of a computed variable with higher order computed variables (for example oxygen with phytoplankton) are included in this section only in descriptions of higher order variables. Where a computed variables process is modified by a lower order computed variable (e.g. silicate benthic flux modified by oxygen), then the lower order computed variable name is shown diagrammatically in a contrasting style overlying relevant process arrows in network diagrams. Computed variables listed in the tables are hyperlinked to basic molecular information in Appendix C. The manuals introduction should be reviewed for guidance on the use of interactive components deployed in this section. 3.1 Simulation Class: DO 3.1.1 Overview The intent of this simulation class is that it provide a relatively simple entry point to commence water quality modelling. There are many applications for this class. For example it might be used to examine basic oxygen dynamics across seasons in a water supply reservoir or constructed urban lake, or the potential impacts of dense desalination plant return waters on local coastal sediment oxygenation processes. This simulation class includes only the oxygen model class, but given oxygens central role in environmental processes, it provides both a solid foundation for fundamental environmental investigations, and a platform from which to expand to more advanced simulation classes. 3.1.2 Model Class: Oxygen The following constituent models are available to select from within the oxygen model class. 3.1.2.1 Constituent Model: O2 The constituent model code and associated computed variables, processes and potentially interacting simulated quantities are provided in Figure 3.1 and Table 3.1. \\(\\newcommand{\\blockindent}{\\hspace{0.5cm}}\\) Figure 3.1: Constituent model: DO Table 3.1: Constituent model properties: O2 Computed Variables Units Processes Interacting Quantities DissolvedOxygen mg/L or mmol/m\\(^3\\) Atmospheric aeration \\(\\cdot\\blockindent\\)Wind speed\\(\\cdot\\blockindent\\)Dissolved oxygen Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties In this relatively simple model, the only process requiring parameterisation is the sediment flux of oxygen. 3.2 Simulation Class: Inorganics 3.2.1 Overview The intent of this simulation class is that it provide a framework for simulating typical water quality conditions where organic matter does not play a significant role in ecosystem processes. For example it might be used to examine basic inorganic nutrient processing in nearshore coastal environments that include relatively unimpacted sandy bed conditions, or mine voids that receive little catchment inflow. This simulation class could equally be applied to smaller, well flushed estuaries that receive relatively little catchment derived organic matter, or to basic studies of lakes and water supply reservoirs. The latter cases (amongst others) might also use this simulation class as a stepping stone towards subsequent and more detailed simulations that include organic matter cycling. This would simply require upgrade from this simulation class to the organics simulation class. This simulation class includes the oxygen, silicate, inorganic nitrogen, inorganic phosphorus and phytoplankton model classes. 3.2.2 Model Class: Oxygen This model class is the same as that described in Section 3.1.2. 3.2.3 Model Class: Silicate The following constituent models are available to select from within the silicate model class. 3.2.3.1 Constituent Model: Si The constituent model code and associated variables, processes and potentially interacting simulated quantities are provided in Figure 3.2 and Table 3.2. Figure 3.2: Constituent model: Si Table 3.2: Constituent model properties: Si Computed Variables Units Processes Interacting Quantities Silicate mg/L or mmol/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties This is a relatively simple model, with the only process requiring parameterisation being the sediment flux of silicate. This can optionally be set to depend on overlying oxygen concentration. 3.2.4 Model Class: Inorganic nitrogen The following constituent models are available to select from within the inorganic nitrogen model class. 3.2.4.1 Constituent Model: AmmoniumNitrate The constituent model code and associated variables, processes and potentially interacting simulated quantities are provided in Figure 3.3 and Table 3.3. Figure 3.3: Constituent model: AmmoniumNitrate Table 3.3: Constituent model properties: AmmoniumNitrate Computed Variables Units Processes Interacting Quantities Ammonium mg/L or mmol/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties Nitrification \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrification parameters\\(\\cdot\\blockindent\\)Ammonium Wet atmospheric deposition \\(\\cdot\\blockindent\\)Rainfall Dry atmospheric deposition \\(\\cdot\\blockindent\\)Atmospheric parameters Nitrate mg/L or mmol/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties Nitrification \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Nitrification parameters\\(\\cdot\\blockindent\\)Ammonium Denitrification \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Denitrification parameters\\(\\cdot\\blockindent\\)Nitrate Wet atmospheric deposition \\(\\cdot\\blockindent\\)Rainfall Dry atmospheric deposition \\(\\cdot\\blockindent\\)Atmospheric parameters This is a slightly more complex model than those described previously, and this reflects the complexity of nitrogenous environmental chemistry. In addition to specification of two computed variables and their respective sediment flux properties, rates and related parameters for nitrification and denitrification are also specifiable. By design, the library defaults for these processes are set to zero so that all processes are initially inactive. Users may activate these processes by specifying non-zero rate parameters. Whilst dissolved oxygen potentially modifies some processes described to this point (e.g. computed sediment flux rates), nitrification is the first of these processes that also potentially consumes dissolved oxygen. Specifically, if nitrification is simulated (i.e. non-zero rate parameters are specified) and allowed to include the effect of dissolved oxygen (the default), then dissolved oxygen concentrations are drawn down as the process operates. Table 3.4: Complementary lower order computed variables: AmmoniumNitrate Computed Variables Units Processes Interacting Quantities Dissolved Oxygen mg/L or mmol/m\\(^3\\) Nitrification \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Nitrification parameters\\(\\cdot\\blockindent\\)Ammonium Other inorganic nitrogen processes are also available within the WQM, including anaerobic oxidation of ammonia and dissimilatory nitrate reduction to ammonium (DNRA), however these require the intermediate nitrogen computed variables noted in Appendix G.2. Contact support@tuflow.com for assistance. 3.2.5 Model Class: Inorganic phosphorus The following constituent models are available to select from within the phosphorus model class. 3.2.5.1 Constituent Model: FRPhs The constituent model code and associated variables, processes and potentially interacting simulated quantities are provided in Figure 3.4 and Table 3.5. Figure 3.4: Constituent model: FRPhs Table 3.5: Constituent model properties: FRPhs Computed Variables Units Processes Interacting Quantities Free Reactive Phosphorus mg/L or mmol/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties Wet atmospheric deposition \\(\\cdot\\blockindent\\)Rainfall This is a reltively simple constituent model, but one that is critical to the simulation of higher order computed variables such as phytoplankton. 3.2.5.2 Constituent Model: FRPhsAds The constituent model code and associated variables, processes and potentially interacting simulated quantities are provided in Figure 3.5 and Table 3.6. Figure 3.5: Constituent Model: FRPhsAds Table 3.6: Constituent model properties: FRPhsAds Computed Variables Units Processes Interacting Quantities Free Reactive Phosphorus mg/L or mmol/m\\(^3\\) Sediment flux \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Sediment properties Wet atmospheric deposition \\(\\cdot\\blockindent\\)Rainfall Adsorption and desorption \\(\\cdot\\blockindent\\)Total suspended solids\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Adorption parameters Adsorbed Free Reactive Phosphorus mg/L or mmol/m\\(^3\\) Adsorption and desorption \\(\\cdot\\blockindent\\)Total suspended solids\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Adorption parameters Settling \\(\\cdot\\blockindent\\)Total suspended solids\\(\\cdot\\blockindent\\)Total suspended solids settling parameters Dry atmospheric deposition \\(\\cdot\\blockindent\\)Atmospheric parameters In order for this constituent model to be used, the TUFLOW FV Sediment Transport module (STM) must be activated to simulate total suspended sediment. A WQM simulation will not start if the TUFLOW STM is not activated. The WQM does not support simulation of suspended sediment in its own right, but does rely on TUFLOW FV to provide this information at each water quality timestep. In order to use this FRPhsAds constituent model therefore, the following must be in place: The TUFLOW FV STM must be activated and implemented At least one sediment fraction must be set up and executed within TUFLOW FV via the inclusion of a sediment control file, and specification of either of the following TUFLOW FV commands: include sediment == 1,0 ! Do not include sediment in density calculations or include sediment == 1,1 ! Include sediment in density calculations If multiple sediment fractions are specified to be simulated by the STM, then TUFLOW FV sends all these fractions individually through the API to the WQM, together with their respective metadata fields. Specifically, for each sediment fraction simulated in the TUFLOW FV STM, the WQM is sent: Concentration Settling velocity Uplift velocity, and D\\(_{50}\\) particle diameter The WQM uses this information to compute FRP adsorption and loss of adsorbed FRP through settling, using only those sediment fractions that meet a user specified maximum \\(D_{50}\\) criterion. 3.2.6 Model Class: Phytoplankton The following constituent models are available to select from within the phytoplankton model class. The differentiator between constituent models is the treatment of internal (to a phytoplankton cell) nutrient simulation. 3.2.6.1 Constituent Model: Basic This phytoplankton constituent model assumes that the ratios of both internal nitrogen and phosphorus concentrations to internal chlorophyll a (or carbon) concentration are fixed. These internal nutrients are not simulated explicitly, but increase and decrease proportionately with increasing and decreasing carbonaceous biomass, according to the specified (or default) nitrogen-chlorophyll a and phosphorus-chlorophyll a (or their carbon equivalents) ratios. Carbonaceous biomass is simulated dynamically and is the measure of phytoplankton concentration. Internal nutrient concentrations are not required to be specified as initial or boundary conditions, and are not treated as computed variables. The constituent model code and associated computed variables, processes and potentially interacting simulated quantities are provided in Figure 3.6 and Table 3.7. Silicate interactions only apply if phytoplankton is set to uptake silicate via specification of silicate limitation function parameters (section 4.7.3.5.1). The configuration for phytoplankton simulation presented below applies only to the inorganics simulation class. A different, and expanded, configuration applies when phytoplankton is simulated using this basic constituent model in the organics simulation class. This expanded configuration is described in section 3.3.7. Figure 3.6: Constituent model: Basic Table 3.7: Constituent model properties: Basic Computed Variables Units Processes Interacting Quantities Phytoplankton \\(\\mu\\)g Chl a/L or mmol C/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate (if activated) Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate Settling \\(\\cdot\\blockindent\\)Settling model\\(\\cdot\\blockindent\\)Cell density The three processes that govern phytoplankton behaviour are: Primary productivity (the photosynthetic conversion of light and carbon to stored energy and oxygen, also referred to as growth) Respiration (the expenditure of stored energy and oxygen to produce carbon), and Settling A range of light, temperature, salinity, nitrogen, phosphorus and silicate limitation functions can be parameterised and applied in various combinations to the first two processes above, and a range of settling models are available to tailor the third. By design, the associated library default rates are set to zero so as to render all processes initially inactive. Specification of non-zero rates activates these processes. The distinguishing property of this phytoplankton constituent model is that internal (phytoplankton cell) nutrient concentrations are considered to be fixed proportions of cell chlorophyll a (or carbon) concentrations. They are therefore not treated as computed variables, but rather as multiples of phytoplankton chlorophyll a (or carbon) (which is treated as a computed variable). The key implication of this is the method of calculation of the nitrogen and phosphorus uptake and limitation functions applied to primary productivity. These calculations depend only on ambient (i.e. external to a phytoplankton cell) water column nitrogen and phosphorus concentrations. Simulation of phytoplankton dynamics in the inorganics simulation class directly modifies the concentrations of a range of other computed variables. These are listed in Table 3.8. Silicate interactions only apply if phytoplankton is set to uptake silicate. Table 3.8: Complementary lower order computed variables: Basic Computed Variables Units Processes Interacting Quantities Dissolved Oxygen mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light Ammonium mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate Excretion \\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate Mortality \\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate Nitrate mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate FRP mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Silicate Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Silicate Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Silicate Silicate mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP 3.2.6.2 Constituent Model: Advanced This phytoplankton constituent model directly simulates internal (phytoplankton cell) nitrogen and phosphorus concentrations. These are allowed to vary between upper and lower limits, expressed as ratios to chlorophyll a (or carbon) concentrations. Internal nutrient concentrations (not as ratios) are required to be specified as initial and boundary conditions, and are treated as computed variables. The constituent model code and associated variables, processes and potentially interacting simulated quantities are provided in Figure 3.7 and Table 3.9. Silicate interactions only apply if phytoplankton is set to uptake silicate. The configuration for phytoplankton simulation presented below applies only to the inorganics simulation class. A different, and expanded, configuration applies when phytoplankton is simulated using this basic constituent model in the organics simulation class. This expanded configuration is described in section 3.3.7. Figure 3.7: Constituent model: Advanced Table 3.9: Constituent model properties: Advanced Computed Variables Units Processes Interacting Quantities Phytoplankton \\(\\mu\\)g Chl a/L or mmol C/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate Settling \\(\\cdot\\blockindent\\)Settling model\\(\\cdot\\blockindent\\)Cell density\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus Internal nitrogen mg N/L or mmol N/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate Uptake \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal phosphorus Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Internal phosphorus Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate Settling \\(\\cdot\\blockindent\\)Settling model\\(\\cdot\\blockindent\\)Cell density\\(\\cdot\\blockindent\\)Internal phosphorus Internal phosphorus mg P/L or mmol P/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Silicate Uptake \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Dissolved oxygen\\(\\cdot\\blockindent\\)Internal nitrogen Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Silicate Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Silicate Settling \\(\\cdot\\blockindent\\)Settling model\\(\\cdot\\blockindent\\)Cell density\\(\\cdot\\blockindent\\)Internal nitrogen The three processes that govern phytoplankton behaviour are: Primary productivity (the photosynthetic conversion of light and carbon to stored energy and oxygen, also referred to as growth) Respiration (the expenditure of stored energy and oxygen to produce carbon), and Settling A range of light, temperature, salinity, nitrogen, phosphorus and silicate limitation functions can be parameterised and applied in various combinations to the first two processes above, and a range of settling models are available to tailor the third. By design, the associated library default rates are set to zero so as to render all processes initially inactive. Specification of non-zero rates activates these processes. The distinguishing property of this phytoplankton constituent model is that internal (phytoplankton cell) nutrient concentrations are simulated directly. They are therefore treated as computed variables. The key implication of this is the method of calculation of the nitrogen and phosphorus uptake and limitation functions applied to primary productivity. These calculations depend on both internal nutrient stores and ambient (i.e. external to a phytoplankton cell) water column nitrogen and phosphorus concentrations. Simulation of phytoplankton dynamics in the inorganics simulation class directly modifies the concentrations of a range of other computed variables. These are listed in Table 3.10. Silicate interactions only apply if phytoplankton is set to uptake silicate. Table 3.10: Complementary lower order computed variables: Basic Computed Variables Units Processes Interacting Quantities Dissolved Oxygen mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate Respiration \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light Ammonium mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate Excretion \\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate Mortality \\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate Nitrate mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Silicate FRP mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus\\(\\cdot\\blockindent\\)Silicate Silicate mg/L or mmol/m\\(^3\\) Primary productivity \\(\\cdot\\blockindent\\)Water temperature\\(\\cdot\\blockindent\\)Salinity\\(\\cdot\\blockindent\\)Light\\(\\cdot\\blockindent\\)Nitrate\\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus Excretion \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus Mortality \\(\\cdot\\blockindent\\)Ammonium\\(\\cdot\\blockindent\\)FRP\\(\\cdot\\blockindent\\)Internal nitrogen\\(\\cdot\\blockindent\\)Internal phosphorus 3.3 Simulation Class: Organics 3.3.1 Overview 3.3.2 Constituent Model Class: Oxygen This constituent model class is the same as that described in Section 3.1.2 3.3.3 Constituent Model Class: Silicate This constituent model class is the same as that described in Section 3.2.3 3.3.4 Constituent Model Class: Nitrogen This constituent model class is the same as that described in Section 3.2.4 3.3.5 Constituent Model Class: Phosphorus This constituent model class is the same as that described in Section 3.2.5 3.3.6 Constituent Model Class: Organics 3.3.7 Constituent Model Class: Phytoplankton This constituent model class is the same as that described in Section 3.2.6, other than the addition of phytoplanktonic losses to organic matter as part of exudation and respiration (via excretion and mortality). Those processes and interactions are described below. "],["SimulationConstruction-1.html", "Section 4 Simulation Construction 4.1 Context 4.2 Units 4.3 General arrangement 4.4 TUFLOW FV control file commands 4.5 Water quality control file commands 4.6 Simulation Class: DO 4.7 Simulation Class: Inorganics 4.8 Simulation Class: Organics", " Section 4 Simulation Construction 4.1 Context Previous sections have presented the architecture and water quality processes available within the WQM. This section describes the construction of a TUFLOW simulation with the WQM activated. This includes descriptions of all commands, with hyperlinks to the Appendices where commands and explanations are listed in a searchable and sortable table for ease of access. TUFLOW FV is the hydrodynamic model used in all descriptions that follow. 4.2 Units The WQM allows for simulation construction in one of two unit systems (see Section 4.5.1): A milligrams per litre system (which includes micrograms per litre for phytoplankton) that aligns with typical units of laboratory reporting, and A millimoles per cubic metre system A single units system must be adopted for a WQM simulation, and unit systems cannot be mixed within a simulation. This specification has implications for at least the setting of numerical values for: Initial conditions Boundary conditions Computed variable parameters When the milligrams per litre system is used, the WQM executes internal conversions between milligrams and millimoles, because millimoles are the units expected by the core water quality calculation routines. This conversion follows the form: \\[\\begin{equation} n = \\frac{m}{M} \\tag{4.1} \\end{equation}\\] where \\(n\\) is millimoles (mmol), \\(m\\) is mass (mg) and \\(M\\) is molar weight (mg/mmol). A similar concept applies to concentration and flux quantities. As such, the WQM assigns values to \\(M\\) in converting from milligrams to millimoles, i.e. from user specified milligram initial conditions, boundary conditions and computed variable parameters, to the equivalent millimole quantities. The complete list of values of \\(M\\) for all simulated constituents is provided in Table C.1. The two possibilities for units for each parameter are provided in Appendix O, where relevant. As an example, if a user specifies the milligrams per litre units system (or allows the same default to be set) and a FRP flux == 3.1 in a materials block, then this value of 3.1 is assumed to be mg/m\\(^2\\)/day. Consistent with typical laboratory reporting conventions (see below), this mass flux is taken to be that of elemental phosphorus \\(P\\), not that of the phosphate molecule \\(PO_4^{3-}\\). This would mean (using Table C.1 and Equation (4.1)) that the equivalent millimole rate would be computed as: \\[\\begin{equation} n = \\frac{3.1}{31} = 0.1 \\hspace{0.1cm} \\text{mmol/m$^2$/day of P} \\tag{4.2} \\end{equation}\\] Given the above, users opting to construct WQM simulations in the milligrams units system need to clearly understand what is being reported in: Field and/or laboratory measurements, and Other numerical model predictions that may be used as WQM boundary conditions (such as catchment pollutant export models) In the case of laboratory nutrient measurements, it is conventional to report concentrations of the typical quantities used by the WQM as silicate-Si, ammonium-N, nitrate-N, FRP-P, organic-C, organic-N, and organic-P. Whilst these quantities might be referred to informally as (for example) nitrate concentrations, the reported number is most commonly the concentration of elemental nitrogen contained within nitrate. To be clear, if a nitrate-N concentration is reported by a laboratory to be 3.5 mg/L, this means that in every litre of water, there are 3.5 milligrams of elemental nitrogen contained within nitrate molecules. Given the molar masses of elemental nitrogen and nitrate, this 3.5 milligrams of elemental N means that there are 15.5 milligrams of nitrate molecules (15.5 = 3.5 x 62/14) in the same litre of water. In this example, the concentration with which the WQM expects to be provided is 3.5 mg/L, not 15.5 mg/L. The use of other model data to force WQM boundary conditions is also interpreted in this way. For example, a catchment model might report that an inflow to the WQM at an upstream riverine boundary condition has a total nitrogen concentration of 10.0 mg/L, and a user may have then speciated this to nitrate by applying a multiplicative factor of 0.15. If this resulting nitrate concentration of 1.5 mg/L is applied to the WQM as a boundary condition, it must be a concentration of elemental nitrogen within nitrate, which is consistent with what would be reported by a laboratory. This means that the user must be sure that the total nitrogen reported by the catchment model is in fact an elemental nitrogen concentration. If users elect to construct WQM simulations in units of millimoles, then no internal WQM conversions take place, and the nature of the quantity (molecular or elemental) being specified is not relevant. For example, the user could specify millimoles units and a FRP flux of 0.1. This could be interpreted as a mmol/m\\(^2\\)/day rate of either the \\(PO_4^{3-}\\) molecule, or just phosphorus \\(P\\). This is because in one millimole of \\(PO_4^{3-}\\), there is also one millimole of elemental \\(P\\). The same one to one relationship holds for all other WQM relevant computed quantities (see Table C.1), other than oxygen which is treated as a diatomic molecule. 4.3 General arrangement A water quality simulation is set up and executed under the umbrella of a TUFLOW FV control file (Figure 4.1, with other optional modules shown for illustrative purposes). That is: The TUFLOW FV control file (*.fvc) file remains the central file that initiates and coordinates an overall simulation. This mirrors the way in which other TUFLOW FV modules, such as the STM and PTM, are activated and executed The TUFLOW FV control file contains a path to a separate WQM control file (*.fvwq) that in turn contains all the commands required to configure a WQM simulation \\(\\newcommand{\\blockindent}{\\hspace{0.5cm}}\\) Figure 4.1: Simulation Coordination TUFLOW FV and WQM control file commands are presented following. 4.4 TUFLOW FV control file commands A TUFLOW FV simulation is executed as described in the TUFLOW FV user manual. If the WQM is to be activated in a simulation then the following commands are to be included. 4.4.1 WQM activation Activation of the WQM is affected by specification of the following mandatory command in the TUFLOW control file: water quality model == TUFLOW Following this activation, TUFLOW FV will look for the specification of the name of the separate WQM control file via the following mandatory command: water quality control file == .fvwq This *.fvwq is separate to the *.fvc and contains user specified information that describes the configuration of the water quality simulation. If the *.fvwq is located in the same directory as the *.fvc, then this filename specification needs no associated path. It is recommended however that the *.fvwq be located in a directory separate to the *.fvc so that log and other related water quality specific files can be easily curated. If this approach is adopted, the following additional *.fvc command is required, noting that the folder path is specified as relative to the folder in which the *.fvc resides: water quality model directory == &lt;relative path ..\\(\\backslash\\).. to WQ directory&gt;\\(\\backslash\\) This command must terminate in a \\(\\backslash\\) character. An example block of these three commands that together activate the WQM and point TUFLOW to the water quality control file ..\\(\\backslash\\)WQ\\(\\backslash\\)Model_000.fvwq is: water quality model == TUFLOW water quality model dir == ..\\WQ\\ water quality control file == .\\Model_000.fvwq 4.4.2 Initial and boundary conditions In addition to activating the WQM and specifying its control file, WQM initial and boundary condition information is also set through the TUFLOW FV control file. The processes for doing so are described below. These are followed by discussion of the related matter of constituent ordering within initial and boundary condition specifications. 4.4.2.1 Initial conditions Water quality initial conditions are specified within the TUFLOW FV control file, akin to the manner in which the sediment initial conditions are set on behalf of the sediment transport module. This specification is mandatory. There are currently a number of ways that water quality initial conditions may be specified, and all are affected through TUFLOW FV commands. If no water quality initial conditions are specified, then a simulation will not execute. Restart files generated from previous simulations can be used to initialise water quality simulations, provided that the restart and simulation model geometries, and water quality simulation computed variables and units are identical. A restart file is specified for all simulated quantities (not just water quality) and is controlled through commands described in the TUFLOW FV user manual. The key command is restart == .rst Other than a restart file, there are a number of ways that water quality initial conditions can be specified, all of which utilise existing TUFLOW FV methods. These are described in the TUFLOW FV user manual, of which some of the following are included: Globally uniform initial wq concentration == ordered initial conditions Globally laterally uniform, but varying with depth initial scalar profile == .csv Globally vertically uniform, but varying laterally initial condition 2d == .csv Three dimensional spatially varying initial condition 3d == .csv Initial conditions that use columnar data structures (e.g. *.csv files, and all of the above commands) are interpreted using the ordering rules noted below. The required ordering for each WQM simulation class is provided subsequently (sections 4.6, 4.7 and 4.8 for simulation classes DO, inorganics and organics, respectively). 4.4.2.2 Boundary conditions Water quality boundary conditions are also specified via the *.fvc file, either directly or via an include statement that points TUFLOW FV to a subsidiary boundary condition control file(s). This specification of water quality variable concentrations is optional, so in early water quality model construction stages this specification can be omitted. Omitted water quality boundary conditions will be set to zero. It is not recommended that this approach be taken beyond initial simulation setup stages, but that it be used only to develop a water quality simulation to the point where it executes without issuing error or unwanted warning messages. At this point, all water quality boundary conditions should be assigned. All TUFLOW boundary conditions that specify water temperature or salinity will also require specification of the behaviour of simulated water quality variables. Common boundary conditions to which this applies include inflows (e.g. types Q, QC, QN, QG and others) and tidal boundaries (e.g. types WLS). Wave and meteorological boundary conditions do not need specification of water quality conditions. As for initial conditions, boundary conditions that use columnar data structures (e.g. *.csv files) are interpreted using column headers specified in an expected order within calling TUFLOW FV BC blocks. Further detail and the associated ordering is provided in the following sections (sections 4.6, 4.7 and 4.8 for simulation classes DO, inorganics and organics, respectively). 4.4.2.3 Ordering Specification of initial conditions and most boundary conditions presently relies on listing water quality variables in a particular order. This applies in all instances when water quality initial or boundary conditions are provided in columnar or list form, which is most frequently in text file format. This is conceptually similar to the manner in which TUFLOW FV also relies on ordering of its initial and boundary conditions. Future releases of TUFLOW FV will allow alternative methods for specification of initial and boundary conditions that do not rely on assumed ordering. In the interim however, the following applies. 4.4.2.3.1 Initial Conditions Initial conditions, if set using means other than a restart file, must be specified with water quality constituents in a preset order. Header information is not used in setting water quality initial conditions - the ordering of values or columns is the sole means by which text based initial conditions are set. For example, the following *.fvc command sets globally uniform initial conditions for a typical inorganics simulation class: initial wq concentration == 7.5, 0.0, 4.2, 10.5, 0.6, 5.5 There are no references to headers or variable names, but TUFLOW FV assumes that these numbers correspond to the ordered variables of the particular configuration of the inorganics simulation class returned to it from the WQM. In this example, this ordering is: Dissolved oxygen (7.5 mg/L) Silicate (0.0 mg/L) Ammonium (4.2 mg/L) Nitrate (10.5 mg/L) Free reactive phosphorus (0.6 mg/L), and One phytoplankton group (5.5 \\(\\mu\\)g/L) Similarly, the expected ordering of columns in profile, 2D or 3D options is the only means by which TUFLOW FV interprets initial conditions: headers in these files are ignored. The expected ordering is the same as that for boundary condition specifications, as described below. 4.4.2.3.2 Boundary Conditions Ordering of water quality boundary conditions is only important when specifying header information via the bc header == (or equivalent) command within a TUFLOW FV *.fvc file BC block. It is in these commands (where comma separated header strings are specified) that TUFLOW FV expects a particular order of TUFLOW FV and WQM constituents. No column ordering is expected in boundary condition data files themselves. Ordering is only expected in the order of headers specified within a BC block within an TUFLOW FV control file. This is best illustrated by example. If a user has elected to deploy the inorganics simulation class without sediment, then the following will be simulated (beyond the basic velocity and water level hydrodynamic variable suite): Salinity Temperature Dissolved oxygen Silicate Ammonium Nitrate Free reactive phosphorus One (assumed for this example, but can be multiple) phytoplankton group These will eventually need proper boundary condition specification in boundary condition blocks and have supporting data provided in (usually) text files. In a simple model with only one WL boundary condition, a bc block of the following form would be required as a minimum to properly specify the hydrodynamic and water quality boundaries: bc == WL, 1, datafile.csv \\(\\blockindent\\) bc header == time, wsel, sali, temp, DOxy, SiO4, NH41, nitr, frph, bluegreen end bc To be clear: The names listed on the bc header == line (time, wse etc.) are not keywords or special names, and can be any names that a user chooses TUFLOW FV will however, assume that these names (whatever they have been set to) have been listed in such an order that they have a one to one correspondence to the ten computed variables as follows: time \\(\\rightarrow\\) Time stamp wsel \\(\\rightarrow\\) Water surface elevation sali \\(\\rightarrow\\) Salinity temp \\(\\rightarrow\\) Temperature DOxy \\(\\rightarrow\\) Dissolved oxygen SiO4 \\(\\rightarrow\\) Silicate NH41 \\(\\rightarrow\\) Ammonium nitr \\(\\rightarrow\\) Nitrate frph \\(\\rightarrow\\) Free reactive phosphorus bluegreen \\(\\rightarrow\\) Phytoplankton group one TUFLOW then matches the user specified names to the expected simulation variables, based on this ordering, to then interrogate boundary condition files. Following the above matching, TUFLOW FV interrogates the relevant boundary condition file (datafile.csv in the example above), where this file can have its columns arranged in any order: the order of these columns does not matter because TUFLOW FV will use the mapping previously developed via the bc header == command to look through all data file columns one by one, searching for the headers specified, regardless of the actual ordering of boundary condition file columns. For example, the silicate boundary condition data could be positioned in column 14 of the boundary condition file, but as long as it is labelled with the correct header (SiO4 as specified in bc header ==), TUFLOW FV will know to assign column 14 of the boundary condition data file to the silicate computed variable. Ordering is set by the users selection of simulation class and constituent models, and is explicitly listed in each simulation class section (Sections 4.6.5, 4.7.5 and 4.8.5 for DO, inorganics and organics, respectively). The expected ordering for a particular simulation is also reported in the simulation water quality log file for checking. 4.5 Water quality control file commands The water quality control file comprises three parts, with each part containing different types of commands and flags. Whilst it is recommended that these parts be kept separate and in the order described below (especially given how complex water quality simulations can become), doing so is not mandatory and commands or command blocks may be entered in any order. These parts are as follows, with the first two mirroring the architecture described in Section 2: Simulation controls (i.e. simulation class Constituent model settings (i.e. constituent model class) Material specifications Notwithstanding this, a WQM control file need not contain any commands, and can be completely blank. This is by design, and intended to allow users to rapidly set up and execute a TUFLOW water quality simulation. If the water quality control file is left blank, then the WQM will: Construct a simulation using the dissolved oxygen simulation class (which is the simplest class) Set the simulation units to mg/L Set library defaults for all parameters Set the water quality model timestep to the default Assign zero dissolved oxygen concentration to all boundary conditions. This is by design, and will assist in ensuring that the subsequent user-defined updating of boundary conditions is thorough and complete (zero dissolved oxygen boundary conditions are rare and therefore easily identifiable). Initial conditions will also need to be specified in the TUFLOW FV control file as per Section 4.4.2. Specification of boundary conditions can be deferred. The water quality control file sections are described below. Details specific to each simulation class and constituent model are provided in subsequent sections 4.5.1 Part 1: Simulation controls Simulation controls set the high level operation of the WQM and are not specific to a simulation class. All are optional. Available commands set the: Simulation class via simulation class == Timestep dt (in seconds) at which TUFLOW calls the WQM via wq dt == Units of simulation via wq units == A typical simulation control section might therefore look like the following: simulation class == DO wq dt == 600.0 wq units == mgl 4.5.2 Part 2: Constituent model settings Constituent model settings are those that: Specify the constituent model to be used within each preset constituent model class. These are referred to as constituent model blocks Set the parameters for each of these constituent models, as commands within these blocks All are optional, however if a constituent model block is initiated then it requires an end XXXX model command to terminate the block, where XXXX is the name of the constituent model class, such as nitrogen. An example of a user selecting to use the adsorbed free reactive phosphorous constituent model (that is a model available within the phosphorus constituent model class), and setting some parameters within that model is as follows: phosphorus model == frpads atmospheric deposition == 12.6, 0.5 end phosphorus model Parameters not specified by the user are set to library defaults. All constituent models allow for constraining (and then reporting) the predictions of their respective computed variable concentrations via the setting of minimum and maximum limits, if desired. This is often useful in identifying unusual model behaviours or instabilities. Where exceedences of these limits are identified by the WQM: Time and model cell information is written to the WQM log file in real time. This allows for easy identification of potential model issues via periodic examination of the WQM log file, rather than waiting for simulation completion The WQM resets the computed concentration to the relevant specified minimum or maximum concentration The above resetting will result in mass conservation errors. It should not be relied on in any circumstances to artificially control the behaviour of an otherwise unstable or runaway water quality simulation. Rather, this functionality should be used as a convenient way to check model performance and flag potential issues, with a view to then implementing corrective action. These limits are optionally specified in each constituent model block. An example that sets these limits for ammonium is: ammonium min max == 0.0, 25.0 Although in the strictest sense, sediment (benthic) flux half saturation concentrations and temperature coefficients are benthic properties, the WQM does not yet support these parameters being applied on a spatially varying basis (i.e. per material). As such, these are considered to be constituent model global parameters and so are set in this part of the water quality control file, i.e. within respective constituent model blocks. An example that sets an oxygen half saturation and temperature coefficient for benthic flux is: oxygen benthic == 5.0, 1.08 4.5.3 Part 3: Material specifications The final part of the water quality control file (*.fvwq) provides for specification of benthic (sediment) fluxes, via material blocks. The commands required to commence and terminate a materials block are as follows: material == &lt;up to 10 comma separated material numbers, or default&gt; and end material This material block nomenclature mirrors that used in the TUFLOW FV and sediment transport control files. An example of specifying oxygen and nitrate benthic fluxes for materials 2, 7 and 12 is: material == 2, 7, 12 oxygen flux == -60.0 nitrate flux == 12.5 end material The WQM allows for specification of a default set of benthic fluxes that are applied across all materials, by using the key word default instead of specifying material numbers in a material block. These defaults can then be progressively overwritten on a material by material basis by specifying subsequent material blocks. For example, a model that has ten materials in total, eight of which have the same oxygen benthic flux (all materials except 4 and 7), can have its overall oxygen benthic flux specified as: material == default oxygen flux == -60.0 end material material == 4, 7 oxygen benthic flux == -20.0 end material 4.5.4 Summary In order to set up and execute a water quality simulation using TUFLOW WQM, the following steps are required: Modify the TUFLOW FV control file: Add at least the following commands to TUFLOW FV control file (*.fvc): water quality model == TUFLOW water quality control file == .fvwq Optionally add a folder path command to the TUFLOW FV control file (*.fvc) with a trailing backslash: water quality model dir == &lt;relative path to *.fvwq file&gt; Add appropriate initial conditions for all water quality constituents, observing ordering rules Initially optionally add boundary conditions for all water quality constituents, observing ordering rules in bc header == commands Create the water quality control file with the corresponding name and path Modify the water quality control file Optionally add to the water quality control file: Part 1: A simulation controls section Part 2: A constituent model setting section with one or more constituent model blocks with one or more parameter commands Part 3: A material block specifications section Once initially constructed, boundary conditions can be added (if not already in place), and progressive refinement and parameterisation of constituent models and benthic fluxes can be affected. Details of these commands and their options within each specific simulation class are provided in subsequent sections. Subsections are separated into the above water quality control file parts for ease and consistency of reference. All commands are optional. 4.6 Simulation Class: DO If no simulation class is specified then a simulation will be automatically constructed using this DO class, and populated with library defaults for all parameters. Computed variables will be: Dissolved oxygen 4.6.1 Prerequisites The DO simulation class requires simulation of the following in TUFLOW FV: Hydrodynamics, in either two or three dimensions (including any internal one dimensional structures if present) Salinity Temperature Heat module on (i.e. meteorological forcing is required) Simulation of suspended sediment (via TUFLOW FVs sediment transport module) is optional. 4.6.2 Part 1: Simulation specification The DO simulation class is set via simulation class == DO The other commands in this part are not specific to this simulation class. See section 4.5.1. 4.6.3 Part 2: Constituent model specification As per Tables 2.2 and 2.3, oxygen is the only constituent model class available within the DO simulation class, and there is only one oxygen constituent model within that class, with code O2. 4.6.3.1 Constituent model class: Oxygen 4.6.3.1.1 Constituent model: O2 This constituent model is specified as: oxygen model == O2 Minimum and maximum concentrations are specified as: \\(\\blockindent\\) oxygen min max == \\(\\left[DO\\right]_{min}^{O_2}\\), \\(\\left[DO\\right]_{max}^{O_2}\\) Global benthic parameters (used in Equation (E.3)) are specified as: \\(\\blockindent\\) oxygen benthic == \\(K_{sed-O_2}^{O_2}\\), \\(\\theta_{sed}^{O_2}\\) Although not strictly necessary, the use of oxygen to prefix these block commands is deliberate so as to maintain consistency of command style with other constituent model blocks that include more than one computed variable, such as nitrogen, phosphorus and organics. Nonetheless, if the oxygen prefix is omitted within this constituent model block, the WQM will still interpret the above commands correctly. This constituent model block must be terminated using the command: end oxygen model 4.6.4 Part 3: Material specification Oxygen benthic flux (used in Equation (E.3)) is specified within both default and numbered material blocks as: \\(\\blockindent\\) oxygen flux == \\(F_{sed}^{O_2}\\) 4.6.5 Constituent ordering Dissolved oxygen is the only constituent simulated by the WQM for this simulation class. In all columnar and list style initial conditions, oxygen concentration is specified as the first variable (shown in symbolic form below): initial wq concentration == \\(\\left[ DO \\right]\\) Similarly, in a bc header command within a bc block, oxygen is expected to be the first and only water quality variable after hydrodynamic boundary conditions. \\(\\blockindent\\)bc header == time, water_elev, sal, temp, clay, sand, DO_mgL DO_mgL is the header used to designate oxygen in the related boundary condition file, noting that the DO_mgL column in the boundary condition file can appear in any column in the boundary condition file, and that it does not need to be the seventh column. The header text DO_mgL is just an example, and it can be any header desired, as long as it matches the correct column header in the boundary condition file. 4.6.6 Example Following is an example of all the available WQM simulation class == DO commands. A single material applied as zeros everywhere as the default, other than for materials 1 and 4 where the default flux is overwritten. simulation class == DO wq dt == 3600 units == mgl oxygen model == O2 oxygen benthic == 4.0, 1.05 min max == 0.0, 25.0 end oxygen model material == default oxygen flux == 0 end material material == 1, 4 oxygen flux == -637.0 end material 4.7 Simulation Class: Inorganics If the inorganics simulation class is specified with no subsequent constituent model blocks, then a simulation will be automatically constructed using this inorganics class, and populated with library defaults for all parameters. Computed variables will be: Dissolved oxygen Silicate Ammonium Nitrate Free reactive phosphorus One phytoplankton group named dummy that uses the basic phytoplankton constituent model 4.7.1 Prerequisites The inorganics simulation class requires simulation of the following in TUFLOW FV: Hydrodynamics, in either two or three dimensions (including any internal one dimensional structures if present) Salinity Temperature Heat module on (i.e. meteorological forcing is required) Simulation of suspended sediment (via TUFLOW FVs sediment transport module) is required only if adsorbed phosphorus is to be simulated by the WQM. This is affected through specification of the adsorbed phosphorus constituent model within the phosphorus constituent model class. 4.7.2 Part 1: Simulation specification The inorganics simulation class is set via simulation class == inorganics The other commands in this part are not specific to this simulation class. See section 4.5.1. 4.7.3 Part 2: Constituent model specification As per Tables 2.2 and 2.3, there are several constituent model classes available within the inorganics simulation class. The commands for each are described following. 4.7.3.1 Constituent model class: Oxygen 4.7.3.1.1 Constituent model: O2 The commands for this constituent model are described in Section 4.6.3.1.1. 4.7.3.2 Constituent model class: Silicate 4.7.3.2.1 Constituent model: Si This constituent model is specified as: silicate model == Si Minimum and maximum concentrations are specified as: \\(\\blockindent\\) silicate min max == \\(\\left[Si\\right]_{min}^{Si}\\), \\(\\left[Si\\right]_{max}^{Si}\\) Global benthic flux parameters (used in Equation (F.1)) are specified as: \\(\\blockindent\\) silicate benthic == \\(K_{sed-O_2}^{Si}\\), \\(\\theta_{sed}^{Si}\\) Although not strictly necessary, the use of silicate to prefix the above block commands is deliberate so as to maintain consistency of command style with other constituent model blocks that include more than one computed variable, such as nitrogen, phosphorus and organics. Silicate sediment flux calculations are set to be dependent on dissolved oxygen concentrations by default. Although not recommended, the following will switch off this dependence by setting the term labelled Influence of oxygen in Equation (F.1) to a value of 1.0. \\(\\blockindent\\) oxygen == off This constituent model block must be terminated using the command: end silicate model 4.7.3.3 Constituent model class: Inorganic nitrogen 4.7.3.3.1 Constituent model: AmmoniumNitrate This constituent model is specified as: nitrogen model == AmmoniumNitrate Minimum and maximum concentrations for both ammonium and nitrate are specified as: \\(\\blockindent\\) ammonium min max == \\(\\left[NH_4\\right]_{min}^{NH_4}\\), \\(\\left[NH_4\\right]_{max}^{NH_4}\\) \\(\\blockindent\\) nitrate min max == \\(\\left[NO_3\\right]_{min}^{NO_3}\\), \\(\\left[NO_3\\right]_{max}^{NO_3}\\) Global benthic flux parameters (used in Equation (G.1)) for ammonium and nitrate are specified as: \\(\\blockindent\\) ammonium benthic == \\(K_{sed-O_2}^{NH_4}\\), \\(\\theta_{sed}^{NH_4}\\) \\(\\blockindent\\) nitrate benthic == \\(K_{sed-O_2}^{NO_3}\\), \\(\\theta_{sed}^{NO_3}\\) Nitrification parameters (used in (G.3) and therefore (G.4)) are set in a single command as: \\(\\blockindent\\) nitrification == \\(R_{nitrif}^{NH_4}\\), \\(K_{nitrif-O_2}^{NH_4}\\), \\(\\theta_{nitrif}^{NH_4}\\) Denitrification parameters (used in Equation (G.5) or Equation (G.6)) are also set in a single command as: \\(\\blockindent\\) denitrification == Michaelis Menten, \\(R_{denitrif}^{NO_3}\\), \\(K_{denitrif-O_2-MM}^{NO_3}\\), \\(\\theta_{denitrif}^{NO_3}\\) or \\(\\blockindent\\) denitrification == exponential, \\(R_{denitrif}^{NO_3}\\), \\(K_{denitrif-O_2-exp}^{NO_3}\\), \\(\\theta_{denitrif}^{NO_3}\\) The first argument either michaelis menten or exponential) activates a different denitrification model (Equation (G.5) or Equation (G.6), respectively). Ammonium and nitrate sediment flux, nitrification and denitrification calculations are all set to be dependent on dissolved oxygen concentrations by default. Although not recommended, the following will switch off this dependence for all these processes by setting the term labelled Influence of oxygen in Equations (G.1), (G.3) and (G.5) or (G.6) to a value of 1.0. \\(\\blockindent\\) oxygen == off Atmospheric deposition parameters (used in Equations (G.8), (G.9), (G.12) and (G.13)) are set via the command: \\(\\blockindent\\) atmospheric deposition == \\(\\left[TN\\right]_{rain}\\), \\(R_{atm-dry}^{TN}\\), \\(f_{TN}^{NO_3}\\) The same split of TN into ammonium and nitrate is applied to both \\(\\left[TN\\right]_{rain}\\) and \\(R_{atm-dry}^{TN}\\). This constituent model block must be terminated using the command: end nitrogen model 4.7.3.4 Constituent model class: Inorganic phosphorus 4.7.3.4.1 Constituent model: FRPhs This constituent model is specified as: phosphorus model == FRPhs Minimum and maximum concentrations for FRP are specified as: \\(\\blockindent\\) FRP min max == \\(\\left[FRP\\right]_{min}^{FRP}\\), \\(\\left[FRP\\right]_{max}^{FRP}\\) Global benthic flux parameters (used in Equation (H.1)) are specified as: \\(\\blockindent\\) FRP benthic == \\(K_{sed-O_2}^{FRP}\\), \\(\\theta_{sed}^{FRP}\\) FRP sediment flux calculations are set to be dependent on dissolved oxygen concentrations by default. Although not recommended, the following will switch off this dependence by setting the term labelled Influence of oxygen in Equation (H.1) to a value of 1.0. \\(\\blockindent\\) oxygen == off Wet atmospheric deposition parameters (used in Equation (H.2)) are set via the command: \\(\\blockindent\\) atmospheric deposition == \\(\\left[FRP\\right]_{rain}\\), \\(R_{atm-dry}^{FRP}\\) \\(R_{atm-dry}^{FRP}\\) (dry deposition) is ignored if adsorbed phosphorus is not included as a computed variable. Adsorbed phosphorus can be included via use of constituent model FRPhsads, which is described below. This constituent model block must be terminated using the command: end phosphorus model 4.7.3.4.2 Constituent model: FRPhsads This constituent model is specified as: phosphorus model == FRPhsads The TUFLOW FV sediment module (STM) must be used to simulate at least one sediment fraction in order to use this WQM constituent model. In addition to the commands described in Section 4.7.3.4.1, the following commands are available in this constituent model. Minimum and maximum concentrations for adsorbed FRP are specified as: \\(\\blockindent\\) ads FRP min max == \\(\\left[adsFRP\\right]_{min}^{adsFRP}\\), \\(\\left[adsFRP\\right]_{max}^{adsFRP}\\) Two FRP adsorption models are available, as per Equations (H.5) and (H.6). These require specification of two (linear) or three (quadratic) parameters, respectively after specification of the model to be used: \\(\\blockindent\\) adsorption == linear, \\(K_{ads-L}^{FRP}\\), \\(D50_{ads-max}^{FRP}\\) or \\(\\blockindent\\) adsorption == quadratic, \\(K_{ads-Q}^{FRP}\\), \\(Q_{max}^{FRP}\\), \\(D50_{ads-max}^{FRP}\\) Dry atmospheric deposition of FRP is activated in this simulation model (used in Equation (H.3)) and is specified via the same command as wet deposition: \\(\\blockindent\\) atmospheric deposition == \\(\\left[FRP\\right]_{rain}\\), \\(R_{atm-dry}^{FRP}\\) This constituent model block must be terminated using the command: end phosphorus model 4.7.3.5 Constituent model class: Phytoplankton Given the large number of potential commands and options for phytoplankton simulation, horizontal rules have been used to separate subsections below for clarity. 4.7.3.5.1 Constituent model: Basic This constituent model is specified as: phyto model == basic, is any user specified phytoplankton group name that uses only alphanumeric characters with no spaces. Minimum and maximum concentrations for a phytoplankton group are specified as follows. No prefix keyword (as was the case for constituents such as ammonium) is required: \\(\\blockindent\\) min max == \\(\\left[PHY\\right]_{min}^{PHY}\\), \\(\\left[PHY\\right]_{max}^{PHY}\\) 4.7.3.5.1.1 Temperature limitation Temperature limitation can be specified by one of the following models: None (no temperature limitation applied) \\(\\blockindent\\) temperature limitation == none or Standard (used in Equations (K.1) through to (K.8)) \\(\\blockindent\\) temperature limitation == standard, \\(T_{std}^{phy}\\), \\(T_{opt}^{phy}\\), \\(T_{max}^{phy}\\) 4.7.3.5.1.2 Salinity limitation Salinity limitation can be specified by one of the following models: None (no salinity limitation applied) \\(\\blockindent\\) salinity limitation == none or Fresh (used in Equation (K.27)) \\(\\blockindent\\) salinity limitation == fresh, \\(S_{opt-fresh}^{phy}\\), \\(S_{max-fresh}^{phy}\\), \\(L_{max-fresh}^{phy}\\) or Marine (used in Equation (K.28)) \\(\\blockindent\\) salinity limitation == marine, \\(S_{opt-marine}^{phy}\\), \\(L_{zero}^{phy}\\) or Mixed (used in Equation (K.29)) \\(\\blockindent\\) salinity limitation == mixed, \\(S_{opt-mix}^{phy}\\), \\(S_{max-mix}^{phy}\\), \\(L_{zero}^{phy}\\) or Estuarine (used in Equation (K.30)) \\(\\blockindent\\) salinity limitation == estuarine, \\(S_{opt-est}^{phy}\\), \\(S_{max-est}^{phy}\\), \\(P_{est}^{phy}\\) 4.7.3.5.1.3 Light limitation Light limitation can be specified by one of the following models: Basic (used in Equation (K.19)) \\(\\blockindent\\) light limitation == basic, \\(I_{K-bas}\\) or Monod (used in Equation (K.20)) \\(\\blockindent\\) light limitation == monod, \\(I_{K-mon}\\) or Steele (used in Equation (K.21)) \\(\\blockindent\\) light limitation == steele, \\(I_{S-ste}\\) or Webb (used in Equation (K.22)) \\(\\blockindent\\) light limitation == webb, \\(I_{K-web}\\) or Jassby (used in Equation (K.23)) \\(\\blockindent\\) light limitation == jassby, \\(I_{K-jas}\\) or Chalker (used in Equation (K.24)) \\(\\blockindent\\) light limitation == chalker, \\(I_{K-cha}\\) or Klepper (used in Equation (K.25)) \\(\\blockindent\\) light limitation == klepper, \\(I_{S-kle}\\) or Integrated (used in Equation (K.26)) \\(\\blockindent\\) light limitation == integrated, \\(I_{S-int}\\) 4.7.3.5.1.4 Nitrogen limitation Nitrogen limitation parameters (used in Equation (K.9), Section K.3.1) are set via the command: \\(\\blockindent\\) nitrogen limitation == \\(\\left[N\\right]_{min}^{phy}\\), \\(K_{lim-N}^{phy}\\) These, together with additional parameters, are the same as those used in specifying the nitrogen limitation behaviour of the advanced phytoplankton model (Section 4.7.3.5.2.1. 4.7.3.5.1.5 Phosphorus limitation Phosphorus limitation parameters (used in Equation (K.13), Section K.4.1) are set via the command: \\(\\blockindent\\) phosphorus limitation == \\(\\left[P\\right]_{min}^{phy}\\), \\(K_{lim-P}^{phy}\\) These, together with additional parameters, are the same as those used in specifying the phosphorus limitation behaviour of the advanced phytoplankton model (Section 4.7.3.5.2.2). 4.7.3.5.1.6 Silicate limitation Silicate limitation parameters (used in Equation (K.17), Section K.5) are set via the command: \\(\\blockindent\\) silicate limitation == \\(\\left[Si\\right]_{min}^{phy}\\), \\(K_{lim-Si}^{phy}\\) Specification of this limitation triggers the uptake of silicate to be on in the phytoplankton groups block in which the command appears. Omit this command to set silicate uptake to off for a given phytoplankton group. 4.7.3.5.1.7 Uptake Nutrient uptake parameters for nitrogen, phosphorus and silicate (if relevant) (used in Equations (L.2), (L.7) and (L.9) respectively) are set via the command: \\(\\blockindent\\) uptake == \\(X_{N-C-con}^{phy}\\), \\(X_{P-C-con}^{phy}\\), \\(X_{Si-C-con}^{phy}\\) If specified, the value of \\(X_{Si-C-con}^{phy}\\) is ignored if silicate uptake has not been triggered via specification of silicate limitation parameters via silicate limitation ==. 4.7.3.5.1.8 Primary productivity Primary productivity (growth) parameters (used in Equation (J.2)) are set via the command: \\(\\blockindent\\) growth == \\(R_{prod}^{phy}\\), \\(\\theta_{prod}^{phy}\\) 4.7.3.5.1.9 Respiration Respiration parameters are set via the following command. The first two parameters are used directly to compute the respiration rate \\(R_{resp\\langle computed\\rangle}^{phy}\\) via Equation (J.6). The third and fourth parameters are used to compute excretive and mortality fluxes in Equations (M.1) and (M.2), respectively. Both these equations use the respiration rate computed from the first two parameters \\(R_{resp}^{phy}\\) and \\(\\theta_{resp}^{phy}\\). Although not strictly related to respiration, the final parameter does represent a reduction of biomass and is used to compute exudation loss using Equation (J.8). \\(\\blockindent\\) respiration == \\(R_{resp}^{phy}\\), \\(\\theta_{resp}^{phy}\\), \\(f_{true-resp}^{phy}\\), \\(f_{DOM-loss}^{phy}\\), \\(f_{exud}^{phy}\\) 4.7.3.5.1.10 Carbon to Chlorophyll a ratio The carbon to chlorophyll a ratio (used in converting between simulation units, and reporting total chlorophyll a as a diagnostic variable if the mmmol units system is used) is specified via the command: \\(\\blockindent\\) carbon chla ratio == \\(X_{cc}^{phy}\\) 4.7.3.5.1.11 Nitrogen fixing Nitrogen fixing parameters are specified as follows. The first parameter is used in Equation (L.2) to compute the nitrogen fixation flux, and the second parameter modifies computed primary productivity via Equation (J.3). \\(\\blockindent\\) nitrogen fixing == \\(R_{nfix}^{N_2}\\), \\(f_{nfix}^{phy}\\) Setting this command triggers nitrogen fixing to be on, otherwise it is off by default. 4.7.3.5.1.12 Settling Settling can be specified by one of the following models: None \\(\\blockindent\\) settling == none or Constant \\(\\blockindent\\) settling == constant, \\(V_{sett}^{phy}\\) or Constant with density correction (as per Equation (J.9)) \\(\\blockindent\\) settling == thermal, \\(V_{sett}^{phy}\\) or Stokes (used in Equation (J.10)), where density is required to be simulated as a computed variable, and thus requires the specification of \\(I_K\\). \\(\\blockindent\\) settling == stokes, \\(I_{K-sto}\\) If \\(I_K\\) is specified in any light limitation model applied to a phytoplankton group with stokes settling, then a value of \\(I_{K-sto}\\) specified in the stokes model will be ignored. Cell density limits are applied as the defaults and are not user specifiable. 4.7.3.5.1.13 Termination This constituent model block must be terminated using the command: end phyto model 4.7.3.5.2 Constituent model: Advanced This constituent model is specified as: phyto model == advanced, is any user specified phytoplankton group name that uses only alphanumeric characters with no spaces. The following commands are the same as those described for the basic phytoplankton model in Section 4.7.3.5.1: \\(\\blockindent\\) min max == \\(\\blockindent\\) temperature limitation == \\(\\blockindent\\) light limitation == \\(\\blockindent\\) silicate limitation == \\(\\blockindent\\) growth == \\(\\blockindent\\) respiration == \\(\\blockindent\\) carbon chla ratio == \\(\\blockindent\\) nitrogen fixing == \\(\\blockindent\\) settling == end phyto model The following commands differ for the advanced phytoplankton model compared to the basic model. 4.7.3.5.2.1 Nitrogen limitation Nitrogen limitation parameters (used in Equation (K.11), Section K.3.2) are set via the command: \\(\\blockindent\\) nitrogen limitation == \\(\\left[N\\right]_{min}^{phy}\\), \\(K_{N}^{phy}\\), \\(X_{N-C-min}^{phy}\\), \\(X_{N-C-max}^{phy}\\) The first two parameters are the same as those that would be specified using the same command in the basic phytoplankton model (Section 4.7.3.5.1.4). 4.7.3.5.2.2 Phosphorus limitation Phosphorus limitation parameters (used in Equation (K.15), Section K.4.2) are set via the command: \\(\\blockindent\\) phosphorus limitation == \\(\\left[P\\right]_{min}^{phy}\\), \\(K_{P}^{phy}\\), \\(X_{P-C-min}^{phy}\\), \\(X_{P-C-max}^{phy}\\) The first two parameters are the same as those that would be specified using the same command in the basic phytoplankton model (Section 4.7.3.5.1.5). 4.7.3.5.2.3 Uptake Nutrient uptake parameters for nitrogen, phosphorus and silicate (if relevant) (used in Equations (L.4), (L.8) and (L.9) respectively) are set via the command: \\(\\blockindent\\) uptake == \\(R_{upt-N}^{phy}\\), \\(R_{upt-P}^{phy}\\), \\(X_{Si-C-con}^{phy}\\) The value of \\(X_{Si-C-con}^{phy}\\) is ignored if silicate uptake has not been triggered through specification of a silicate limitation function. 4.7.3.5.2.4 Settling An additional settling model can be specified in the advanced phytoplankton constituent model as: Motile (Section J.4.5), where internal nutrient simulation is required to simulate motility \\(\\blockindent\\) settling == motile, \\(V_{mot}^{phy}\\), \\(I_{K-mot}\\) If \\(I_K\\) is specified in any light limitation model applied to an advanced constituent model phytoplankton group with motile settling, then a value of \\(I_{K-mot}\\) specified in the motile model will be ignored. Cell density limits are applied as the defaults and are not user specifiable. 4.7.4 Part 3: Material specification Oxygen, silicate, ammonium, nitrate and FRP benthic fluxes are specified within both default and numbered material blocks as: \\(\\blockindent\\) oxygen flux == \\(F_{sed}^{O_2}\\) \\(\\blockindent\\) silicate flux == \\(F_{sed}^{sil}\\) \\(\\blockindent\\) ammonium flux == \\(F_{sed}^{NH_4}\\) \\(\\blockindent\\) nitrate flux == \\(F_{sed}^{NO_3}\\) \\(\\blockindent\\) FRP flux == \\(F_{sed}^{FRP}\\) No adsorbed FRP or phytoplankton sediment fluxes are required. 4.7.5 Constituent ordering Different constituent model selections result in different ordering requirements for specifying computed variable initial conditions and bc header == commands. For clarity, these are initially presented below using only phytoplankton placeholders in lists. This is possible because phytoplankton specifications are always appended at the end of initial condition or bc header == lists. Phytoplankton specifications are then presented as additive to these lists in subsequent sections. This is not meant to imply that phytoplankton simulation is optional in the inorganics simulation class - it is mandatory and has only been described separately here for presentation purposes. 4.7.5.1 Excluding phytoplankton The only constituent model choice that influences ordering (other than phytoplankton) is the phosphorus model. These two possibilities are described below. 4.7.5.1.1 Phosphorus model FRPhs If adsorbed FRP is not simulated (i.e. phosphorus model == FRPhs), then in all columnar and list style initial conditions, computed variables are expected in the following order: initial wq concentration == \\(\\left[ DO \\right]\\), \\(\\left[ Si \\right]\\), \\(\\left[ NH_4 \\right]\\), \\(\\left[ NO_3 \\right]\\), \\(\\left[ FRP \\right]\\), \\(\\ldots\\) {phytoplankton placeholder/s} Similarly, in a bc header command within a bc block, the following order of computed variables is expected after hydrodynamic (HD BCs) boundary conditions: \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL, \\(\\ldots\\) {phytoplankton placeholder/s} With regard to the abovebc header == command: DO_mgL, Si_mgL, Amm_mgL, Nit_mgL and FRP_mgL are the headers used to designate oxygen, silicate, ammonium, nitrate and FRP in the related boundary condition file, respectively Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file The header texts DO_mgL, Si_mgL, Amm_mgL, Nit_mgL and FRP_mgL are not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers 4.7.5.1.2 Phosphorus model FRPhsads If adsorbed FRP is simulated (i.e. phosphorus model == FRPhsads), then in all columnar and list style initial conditions, computed variables are expected in the following order: initial wq concentration == \\(\\left[ DO \\right]\\), \\(\\left[ Si \\right]\\), \\(\\left[ NH_4 \\right]\\), \\(\\left[ NO_3 \\right]\\), \\(\\left[ FRP \\right]\\), \\(\\left[ FRPads \\right]\\), \\(\\ldots\\) {phytoplankton placeholder/s} Similarly, in a bc header command within a bc block, the following order of computed variables is expected after hydrodynamic boundary conditions: \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL, FRP_ads_mgL, \\(\\ldots\\) {phytoplankton placeholder/s} With regard to the abovebc header == command: DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL and FRP_ads_mgL are the headers used to designate oxygen, silicate, ammonium, nitrate, FRP and adsorbed FRP in the related boundary condition file, respectively Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file The header texts DO_mgL, Si_mgL, Amm_mgL, Nit_mgL, FRP_mgL and FRP_ads_mgLare not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers 4.7.5.2 Including phytoplankton Phytoplankton initial conditions and bc header == are appended directly to the above computed variable specifications, as denoted by the {phytoplankton placeholder/s} flag above. Each phytoplankton group is specified using a cluster of values (initial conditions) or headers (bc block) and these clusters must appear in the same order as phytoplankton groups are specified in the water quality control file. The content of each phytoplankton cluster is determined both by the phytoplankton constituent model used and the settling model selected. These are described below, using a placeholder for preceding computed variables for clarity. These are described above and can be interpreted as either of the orderings specified in sections 4.7.5.1.1 or 4.7.5.1.2. Two phytoplankton groups are used in all examples. 4.7.5.2.1 Phytoplankton model basic If the basic phytoplankton constituent model is used, then in all columnar and list style initial conditions, computed variables are expected in the following order: initial wq concentration == {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{[PHY_1]}_{\\text{Cluster 1}}\\), \\(\\underbrace{[PHY_2]}_{\\text{Cluster 2}}\\) In order to match water quality control file groups with initial conditions, it is assumed that the groups clusters of initial conditions are specified above in the same order that phyto model == blocks are presented in the water quality control file. Similarly, in a bc header command within a bc block, the following order of computed variables is expected after hydrodynamic and non-phytoplankton boundary conditions: \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{\\text{phyto_green}}_{\\text{Cluster 1}}\\), \\(\\underbrace{\\text{phyto_bluegreen}}_{\\text{Cluster 2}}\\) With regard to the abovebc header == command: phyto_green and phyto_bluegreen are the headers used to designate the boundary concentrations of the two phytoplankton groups listed in the water quality control file In order to match water quality control file groups with these boundary condition clusters, it is assumed that the groups boundary condition header clusters are specified above in the same order that phyto model == blocks appear in the water quality control file The names listed in the bc header == command above do not need to match the names listed in the water quality control file phytoplankton blocks Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file The header texts phyto_green and phyto_bluegreen are not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers If the command settling == stokes is used for a phytoplankton group, then phytoplankton cell density must be simulated as a computed variable that requires initial and boundary conditions. This therefore affects the clustering of phytoplankton initial and boundary conditions. For example, if the first phytoplankton group above used the stokes settling model, then the following initial condition command would be required: \\(\\blockindent\\)initial wq concentration == {HD} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{[PHY_1],\\rho_{phy1}}_{\\text{Cluster 1}}\\), \\(\\underbrace{[PHY_2]}_{\\text{Cluster 2}}\\) \\(\\rho_{phy1}\\) is the initial density of the first phytoplankton groups cells. Similarly, in a bc header command within a bc block, the following order of computed variables is expected after hydrodynamic and non-phytoplankton boundary conditions: \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{\\text{phyto_green, phyto_green_density}}_{\\text{Cluster 1}}\\), \\(\\underbrace{\\text{phyto_bluegreen}}_{\\text{Cluster 2}}\\) If both phytoplankton groups simulated density then the corresponding initial condition and boundary condition commands would be as follows: \\(\\blockindent\\)initial wq concentration == {HD} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{[PHY_1],\\rho_{phy1}}_{\\text{Cluster 1}}\\), \\(\\underbrace{[PHY_2],\\rho_{phy2} }_{\\text{Cluster 2}}\\) \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{\\text{phyto_green, phyto_green_density}}_{\\text{Cluster 1}}\\), \\(\\underbrace{\\text{phyto_bluegreen, phyto_bluegreen_density}}_{\\text{Cluster 2}}\\) \\(\\rho_{phy1}\\) and \\(\\rho_{phy1}\\) are the initial densities of the first and second phytoplankton groups cells. The same notes provided above apply to these commands. 4.7.5.2.2 Phytoplankton model advanced If the advanced phytoplankton constituent model is used, then in all columnar and list style initial conditions, computed variables are expected in the following order: initial wq concentration == {non-phytoplankton placeholderss} \\(\\ldots\\) \\(\\underbrace{[PHY_1],[N_1]_{in},[P_1]_{in}}_{\\text{Cluster 1}}\\), \\(\\underbrace{[PHY_2],[N_2]_{in},[P_2]_{in}}_{\\text{Cluster 2}}\\) In order to match water quality control file groups with initial conditions, it is assumed that the groups initial conditions are specified above in the same order that phyto model == blocks are presented in the water quality control file. Similarly, in a bc header command within a bc block, the following order of computed variables is expected after hydrodynamic and non-phytoplankton boundary conditions: \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{\\text{phyto_gr, gr_intN, gr_intP}}_{\\text{Cluster 1}}\\), \\(\\underbrace{\\text{phyto_blgr, blgr_intN, blgr_intP}}_{\\text{Cluster 2}}\\) With regard to the abovebc header == command: phyto_gr and phyto_blgr are the headers used to designate the boundary concentrations of the two phytoplankton groups listed in the water quality control file gr_intN and gr_intP are the headers used to designate the boundary concentrations of internal nitrogen and internal phosphorus for the green phytoplankton group, respectively blgr_intN and blgr_intP are the headers used to designate the boundary concentrations of internal nitrogen and internal phosphorus for the bluegreen group, respectively In order to match water quality control file groups with these boundary conditions, it is assumed that the groups boundary condition header clusters are specified above in the same order that phyto model == blocks appear in the water quality control file The names listed in the bc header == command above do not need to match the names listed in the water quality control file phytoplankton blocks Whilst this ordering in the command is fixed, the corresponding columnar data can appear in any order in the associated boundary condition file The header texts phyto_gr and phyto_blgr are not special keywords. They can be any headers desired, as long as they match the correct respective boundary condition file column headers If the command settling == stokes is used for a phytoplankton group, then phytoplankton cell density must be simulated as a computed variable that requires initial and boundary conditions. This therefore affects the clustering of phytoplankton initial and boundary conditions. If the first phytoplankton group above used the advanced phytoplankton model with the stokes settling model, and the second group used the basic phytoplankton model without stokes settling, then the following commands would be required: initial wq concentration == {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{[PHY_1],\\rho_{phy_1},[N_1]_{in},[P_1]_{in}}_{\\text{Cluster 1}}\\), \\(\\underbrace{[PHY_2]}_{\\text{Cluster 2}}\\) Similarly, in a bc header command within a bc block, the following order of computed variables is expected after hydrodynamic and non-phytoplankton boundary conditions: \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{\\text{phyto_gr, gr_dens, gr_intN, gr_intP}}_{\\text{Cluster 1}}\\), \\(\\underbrace{\\text{phyto_blgr}}_{\\text{Cluster 2}}\\) If both phytoplankton groups simulated density, again with the first and second groups using the advanced and basic models respectively, then the corresponding commands would be as follows: initial wq concentration == {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{[PHY_1],\\rho_{phy_1},[N_1]_{in},[P_1]_{in}}_{\\text{Cluster 1}}\\), \\(\\underbrace{[PHY_2],\\rho_{phy_2}}_{\\text{Cluster 2}}\\) \\(\\blockindent\\)bc header == {HD BCs} \\(\\ldots\\) {non-phytoplankton placeholders} \\(\\ldots\\) \\(\\underbrace{\\text{phyto_gr, gr_dens, gr_intN, gr_intP}}_{\\text{Cluster 1}}\\), \\(\\underbrace{\\text{phyto_blgr, blgr_dens}}_{\\text{Cluster 2}}\\) The same notes provided above apply to these commands. 4.7.6 Example Following is an example of all the available WQM simulation class == inorganics commands, with a single material applied as zeros everywhere as the default, and then modified by a further specificatin for materials 3 and 7. Two phytoplankton groups (one each of the basic and advanced models) are set. simulation class == inorganics wq dt == 3600 units == mgl oxygen model == O2 benthic == 4.0, 1.05 min max == 0.0, 25.0 end oxygen model silicate model == si benthic == 4.0, 1.05 min max == 0.0, 2500.0 oxygen == on end silicate model nitrogen model == AmmoniumNitrate ammonium benthic == 4.0, 1.05 nitrate benthic == 4.0, 1.05 ammonium min max == 0.0, 150.0 nitrate min max == 0.0, 250.0 nitrification == 0.1, 4.0, 1.05 denitrification == exponential, 0.5, 8.0, 1.05 atmospheric deposition == 10.0, 2.4, 0.15 oxygen == on end nitrogen model phosphorus model == frphsads frp benthic == 4.0, 1.05 frp min max == 0.0, 150.0 frpads min max == 0.0, 150.0 atmospheric deposition == 5.0, 1.4 adsorption == quadratic, 1.5, 0.5, 0.00005 oxygen == on end phosphorus model phyto model == basic, green min max == 0.01, 40.0 temperature limitation == standard, 11.0, 14.0, 30.0 salinity limitation == none light limitation == monod, 0.3, 70.0 settling == constant, 0.01 nitrogen limitation == 0.01, 1.5 phosphorus limitation == 0.001, 0.03 silicate limitation == 0.5, 7.0 uptake == 4.7, 0.6, 8.9 carbon chla ratio == 32.0 growth == 2.0, 1.06 respiration == 0.02, 1.04, 0.1, 0.05, 0.6 end phyto model phyto model == advanced, bluegreen min max == 0.5, 50.0 temperature limitation == standard, 10.0, 15.0, 25.0 salinity limitation == estuarine, 22.0, 35.0, 0.0 light limitation == monod, 0.5, 51.0 settling == motile, 0.5 nitrogen limitation == 0.05, 2.5, 4.0, 5.0 phosphorus limitation == 0.01, 0.05, 0.64, 0.67 silicate limitation == 1.0, 5.0 uptake == 0.05, 0.05, 8.9 carbon chla ratio == 27.0 nitrogen fixing == 0.100, 0.100 growth == 1.0, 1.08 respiration == 0.01, 1.01, 0.2, 0.0, 0.4 end phyto model material == default oxygen flux == 0.0 silicate flux == 0.0 ammonium flux == 0.0 nitrate flux == 0.0 frp flux == 0.0 end material material == 3, 7 oxygen flux == -4800.0 silicate flux == 122.0 ammonium flux == 37.0 nitrate flux == 3.7 frp flux == 1.4 end material 4.8 Simulation Class: Organics If the organics simulation class is specified with no subsequent constituent model blocks, then a simulation will be automatically constructed using this organics class, and populated with library defaults for all parameters. Computed variables will be: Dissolved oxygen Silicate Ammonium Nitrate Free reactive phosphorus Dissolved organic carbon Dissolved organic nitrogen Dissolved organic phosphorus Particulate organic carbon Particulate organic nitrogen Particulate organic phosphorus One phytoplankton group named dummy that uses the basic phytoplankton constituent model 4.8.1 Prerequisites The organics simulation class requires simulation of the following in TUFLOW FV: Hydrodynamics, in either two or three dimensions (including any internal one dimensional structures if present) Salinity Temperature Heat module on (i.e. meteorological forcing is required) Simulation of suspended sediment (via TUFLOW FVs sediment transport module) is required only if adsorbed phosphorus is to be simulated by the WQM. 4.8.2 Part 1: Simulation specification The organics simulation class is set via simulation class == organics The other commands in this part are not specific to this simulation class. See section 4.5.1. 4.8.3 Part 2: Constituent model specification As per Tables 2.2 and 2.3, there are several constituent model classes available within the organics simulation class. The commands for each are described following. To avoid repetition, cross references to explanations are provided for commands that are included in previous simulation classes and remain the same for this class. 4.8.3.1 Constituent model class: Oxygen 4.8.3.1.1 Constituent model: O2 The commands for this constituent model are described in Section 4.7.3.1.1. 4.8.3.2 Constituent model class: Silicate 4.8.3.2.1 Constituent model: Si The commands for this constituent model are described in Section 4.7.3.2.1. 4.8.3.3 Constituent model class: Nitrogen 4.8.3.3.1 Constituent model: AmmoniumNitrate The commands for this constituent model are described in Section 4.7.3.3.1. 4.8.3.4 Constituent model class: Phosphorus 4.8.3.4.1 Constituent model: FRPhs The commands for this constituent model are described in Section 4.7.3.4.1. 4.8.3.4.2 Constituent model: FRPhsads The commands for this constituent model are described in Section 4.7.3.4.2. 4.8.3.5 Constituent model class: Phytoplankton 4.8.3.5.1 Constituent model: Basic The commands for this constituent model are described in Section 4.7.3.5.1. 4.8.3.5.2 Constituent model: Advanced The commands for this constituent model are described in Section 4.7.3.5.2. 4.8.3.6 Constituent model class: Organics 4.8.3.6.1 Constituent model: Labile 4.8.3.6.2 Constituent model: Refractory 4.8.4 Part 3: Material specification Oxygen, silicate, ammonium, nitrate FRP, dissolved organic carbon, dissolved organic nitrogen and dissolved organic phosphorus benthic fluxes are specified within both default and numbered material blocks as: \\(\\blockindent\\) oxygen flux == \\(F_{sed}^{O_2}\\) \\(\\blockindent\\) silicate flux == \\(F_{sed}^{sil}\\) \\(\\blockindent\\) ammonium flux == \\(F_{sed}^{NH_4}\\) \\(\\blockindent\\) nitrate flux == \\(F_{sed}^{NO_3}\\) \\(\\blockindent\\) FRP flux == \\(F_{sed}^{FRP}\\) \\(\\blockindent\\) org c flux == \\(F_{sed}^{OrgC}\\) \\(\\blockindent\\) org n flux == \\(F_{sed}^{OrgN}\\) \\(\\blockindent\\) org p flux == \\(F_{sed}^{OrgP}\\) No adsorbed FRP or phytoplankton fluxes are required. 4.8.5 Constituent ordering "],["AppSyntax.html", "Appendix A Syntax of command descriptions A.1 Commands A.2 Arguments A.3 Defaults", " Appendix A Syntax of command descriptions The manuals introduction should be reviewed for instructions regarding the use of interactive components deployed in this section. All WQM commands and descriptions are provided in Table B.1. This Appendix describes the syntax of that table. A.1 Commands WQM commands are coloured, for example frp adsorption parameters ==. These can be copied and pasted directly into a *.fvwq (or *.fvc where appropriate) control file, and arguments added. A.2 Arguments Descriptions of the arguments expected by WQM commands (i.e. information provided after the ==) are contrastingly coloured and always included in angle parentheses, as \\(\\langle\\)argument\\(\\rangle\\) . This argument content takes one of the following forms: A description. For example, for the material == WQM command, the argument is described as \\(\\langle\\)Up to 10 comma separated material numbers\\(\\rangle\\). An example of implementing this description would therefore be material == 1, 6, 3 Single keyword options. Options are separated by semicolons. Options need to be used exactly as written because they are keywords. For example, \\(\\langle\\)DO;inorganics;organics\\(\\rangle\\) describes the three available simulation options for the command wq simulation ==. An example of implementing this description would therefore be wq simulation == organics Single numeric values. Values are presented using their associated symbol, using the notation described in the manuals introductory sections. For example, \\(F_{sed}^{NO_3}\\) describes the single numeric value for the command nitrate flux ==. An example of implementing this description would therefore be nitrate flux == 5.7 Multiple numeric values. Values are presented using their associated symbol, using the notation described in the manuals introductory sections, and are separated by commas. The number of comma separated symbols indicates the number of expected numeric values. For example, \\(\\langle K_{sed-O_2}^{O_2},\\theta_{sed}^{O_2} \\rangle\\) describes the two numeric values expected for the command oxygen benthic ==. An example of implementing this description would therefore be oxygen benthic == 2.2, 1.08 Combined keyword and numeric value/s options. Arguments are separated by commas. Numeric arguments are represented by their associated symbol, using the notation described in the manuals introductory sections. Options need to be used exactly as written because they are keywords. Where different keyword options (for the same command) require different numbers or types of corresponding numerical arguments, these are listed as separate table entries for clarity. These different implementations of the same command are however easily navigated between by using the hyperlinked descriptive words in the right hand most table column. A.3 Defaults All WQM commands are optional (see Section 4.5), and where not specified by the user, the WQM will use library default arguments. These defaults are listed in a separate column of Table B.1. Where defaults are not appropriate, then N/A is listed in this column. Initial conditions must be specified via the *.fvc control file and do not have defaults. "],["AppCommands.html", "Appendix B Commands", " Appendix B Commands .book .book-body .page-wrapper .page-inner { max-width: 90%; } All WQM commands and descriptions follow. This page has deliberately been set to be wider than the main document so as to accommodate the detail contained within the table. Tips for use: Use the search box to dynamically filter the table Sort the filtered (or unfiltered) table by clicking the arrows at the top of each column Use s on your keyboard to toggle the contents pane on and off to provide more screen width if needed Commands are coloured and where arguments are required are suffixed with ==. These coloured commands can be copied and pasted directly into relevant control file/s, as appropriate. Although they show as underlined on mouse hover, these are not hyperlinked Corresponding arguments (presented as their symbols) are coloured and listed in the required order within angled parentheses following each command ==. In addition: Where multiple arguments are required, these are separated by commas Each argument is a hyperlink to its description in the relevant Appendix. This description then includes hyperlinks to the relevant science and command syntax (Section 4). This allows easy navigation between command, parameter and scientific information The final text of each description is Simulation construction section  and is a link to the relevant part of Section 4 where the command syntax is presented in context. More parameter details and descriptions are subsequently available via further hyperlinks included in the construction section Commands that have only one argument but multiple options for that argument are presented in single table entries, with options separated by semicolons Commands that have multiple possible combinations of more than one argument are presented as separate table entries. These related entries (that share the same command) are easily navigable by use of the links provided in the right hand table column, headed Links Table B.1: WQM Commands Command Description Links oxygen flux == \\(\\langle\\)\\(F_{sed}^{O_2}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of oxyegn. Simulation construction section 4.6.4. \\(\\text{ }\\) oxygen benthic == \\(\\langle\\)\\(K_{sed-O_2}^{O_2}\\),\\(\\theta_{sed}^{O_2}\\)\\(\\rangle\\) Used in an oxygen constituent model block to control the response of benthic oxygen flux to temperature and oxygen concentration. Simulation construction section 4.6.3.1.1. \\(\\text{ }\\) oxygen model == \\(\\langle\\)O2\\(\\rangle\\) Used to commence an oxygen constituent model block via specification of a constituent model from the oxygen constituent model class. Simulation construction section 4.6.3.1. \\(\\text{ }\\) oxygen min max == \\(\\langle\\)\\(\\left[DO\\right]_{min}^{O_2}\\),\\(\\left[DO\\right]_{max}^{O_2}\\)\\(\\rangle\\) Used in an oxygen constituent model block to set minimum and maximum dissolved oxygen concentrations. Simulation construction section 4.6.3.1.1. \\(\\text{ }\\) simulation class == \\(\\langle\\)DO;inorganics;organics\\(\\rangle\\) Used in Part 1: Simulation controls of WQM control file to specify water quality simulation class. If not specified, DO is assumed and all associated DO class default parameters are applied. Simulation construction section 4.5.1. \\(\\text{ }\\) end oxygen model Used to terminate an oxygen constituent model block. Must follow an oxygen model == command. Simulation construction section 4.6.3.1.1. \\(\\text{ }\\) wq units == \\(\\langle\\)mgl;mmm\\(\\rangle\\) Used in Part 1: Simulation controls of WQM control file to set the units used for water quality simulation. Milligrams per litre and millimoles per cubic metre are mgl and mmm, respectively. Simulation construction section 4.5.1. \\(\\text{ }\\) wq dt == \\(\\langle\\)timestep\\(\\rangle\\) Used in Part 1: Simulation controls of WQM control file to set the timestep at which TUFLOW calls the WQM to undertake noncenservative water quality calculations, in seconds. Simulation construction section 4.5.1. \\(\\text{ }\\) silicate flux == \\(\\langle\\)\\(F_{sed}^{Si}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of silicate. Simulation construction section 4.7.4. \\(\\text{ }\\) silicate benthic == \\(\\langle\\)\\(K_{sed-O_2}^{Si}\\),\\(\\theta_{sed}^{Si}\\)\\(\\rangle\\) Used in a silicate constituent model block to control the response of benthic silicate flux to temperature and oxygen concentration. Simulation construction section 4.7.3.2.1. \\(\\text{ }\\) silicate min max == \\(\\langle\\)\\(\\left[Si\\right]_{min}^{Si}\\),\\(\\left[Si\\right]_{max}^{Si}\\)\\(\\rangle\\) Used in a silicate constituent model block to set minimum and maximum silicate concentrations. Simulation construction section 4.7.3.2.1. \\(\\text{ }\\) silicate model == \\(\\langle\\)Si\\(\\rangle\\) Used to commence a silicate constituent model block via specification of a constituent model from the silicate constituent model class. Simulation construction section 4.7.3.2. \\(\\text{ }\\) oxygen == \\(\\langle\\)on;off\\(\\rangle\\) Used in a silicate constituent model block to switch the dependence of silicate processes on dissolved oxygen on or off. Simulation construction section 4.7.3.2.1. \\(\\text{ }\\) ammonium flux == \\(\\langle\\)\\(F_{sed}^{NH_4}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of ammonium. Simulation construction section 4.7.4. \\(\\text{ }\\) ammonium benthic == \\(\\langle\\)\\(K_{sed-O_2}^{NH_4}\\),\\(\\theta_{sed}^{NH_4}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to control the response of benthic ammonium flux to temperature and oxygen concentration. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) ammonium min max == \\(\\langle\\)\\(\\left[NH_4\\right]_{min}^{NH_4}\\),\\(\\left[NH_4\\right]_{max}^{NH_4}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to set minimum and maximum ammonium concentrations. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) nitrogen model == \\(\\langle\\)AmmoniumNitrate\\(\\rangle\\) Used to commence an inorganic nitrogen constituent model block via specification of a constituent model from the inorganic nitrogen constituent model class. Simulation construction section 4.7.3.3. \\(\\text{ }\\) oxygen == \\(\\langle\\)on;off\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to switch the dependence of all nitrogen (ammonium and nitrate) processes on dissolved oxygen on or off. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) end silicate model Used to terminate a silicate constituent model block. Must follow a silicate model == command. Simulation construction section 4.7.3.2.1. \\(\\text{ }\\) end nitrogen model Used to terminate an inorganic nitrogen nitrogen constituent model block. Must follow an nitrogen model == command. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) nitrate flux == \\(\\langle\\)\\(F_{sed}^{NO_3}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of nitrate. Simulation construction section 4.7.4. \\(\\text{ }\\) nitrate benthic == \\(\\langle\\)\\(K_{sed-O_2}^{NO_3}\\),\\(\\theta_{sed}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to control the response of benthic nitrate flux to temperature and oxygen concentration. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) nitrate min max == \\(\\langle\\)\\(\\left[NO_3\\right]_{min}^{NO_3}\\),\\(\\left[NO_3\\right]_{max}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to set minimum and maximum nitrate concentrations. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) nitrification == \\(\\langle\\)\\(R_{nitrif}^{NH_4}\\),\\(K_{nitrif-O_2}^{NH_4}\\),\\(\\theta_{nitrif}^{NH_4}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to control nitrification and its response to oxygen concentration and temperature. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) denitrification == \\(\\langle\\)Michaelis Menten,\\(R_{denit}^{NO_3}\\),\\(K_{denit-O2-MM}^{NO_3}\\),\\(\\theta_{denit}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to activate the Michaelis Menten model and control denitrification and its response to ambient oxygen concentrations and temperature. Simulation construction section 4.7.3.3.1. exponential denitrification == \\(\\langle\\)exponential,\\(R_{denit}^{NO_3}\\),\\(K_{denit-O2-exp}^{NO_3}\\),\\(\\theta_{denit}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to activate the exponential model and control denitrification and its response to ambient oxygen concentrations and temperature. Simulation construction section 4.7.3.3.1. Michaelis Menten atmospheric deposition == \\(\\langle\\)\\(\\left[{TN}\\right]_{rain}\\),\\(R_{atm-dry}^{TN}\\),\\(f_{TN}^{NO_3}\\)\\(\\rangle\\) Used in an inorganic nitrogen constituent model block to control the wet and dry atmospheric deposition of inorganic nitrogen. Simulation construction section 4.7.3.3.1. \\(\\text{ }\\) phosphorus model == \\(\\langle\\)FRPhs;FRPhsads\\(\\rangle\\) Used to commence an inorganic phosphorus constituent model block via specification of a constituent model from the inorganic phosphorus constituent model class. Simulation construction section 4.7.3.4. \\(\\text{ }\\) end phosphorus model Used to terminate an inorganic phosphorus phosphorus constituent model block. Must follow a phosphorus model == command. Simulation construction section 4.7.3.4.1. \\(\\text{ }\\) FRP min max == \\(\\langle\\)\\(\\left[FRP\\right]_{min}^{FRP}\\),\\(\\left[FRP\\right]_{max}^{FRP}\\)\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to set minimum and maximum FRP concentrations. Simulation construction section 4.7.3.4.1. \\(\\text{ }\\) FRP flux == \\(\\langle\\)\\(F_{sed}^{FRP}\\)\\(\\rangle\\) Used in a materials block to control the sediment flux rate of FRP. Simulation construction section 4.7.4. \\(\\text{ }\\) FRP benthic == \\(\\langle\\)\\(K_{sed-O_2}^{FRP}\\),\\(\\theta_{sed}^{FRP}\\)\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to control the response of benthic FRP flux to temperature and oxygen concentration. Simulation construction section 4.7.3.4.1. \\(\\text{ }\\) oxygen == \\(\\langle\\)on;off\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to switch the dependence of FRP processes on dissolved oxygen on or off. Simulation construction section 4.7.3.4.1. \\(\\text{ }\\) atmospheric deposition == \\(\\langle\\)\\(\\left[{FRP}\\right]_{rain}\\),\\(R_{atm-dry}^{adsFRP}\\)\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to control the wet (and dry) atmospheric deposition of FRP (adsorbed FRP). Simulation construction section 4.7.3.4.1. \\(\\text{ }\\) ads FRP min max == \\(\\langle\\)\\(\\left[adsFRP\\right]_{min}^{adsFRP}\\),\\(\\left[adsFRP\\right]_{max}^{adsFRP}\\)\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to set minimum and maximum adsorbed FRP concentrations. Simulation construction section 4.7.3.4.2. \\(\\text{ }\\) adsorption == \\(\\langle\\)linear,\\(K_{ads-L}^{FRP}\\),\\(D50_{ads-max}^{FRP}\\)\\(\\rangle\\) Used in an inorganic phosphorus constituent model block to set the paramters for the linear FRP adsorption model. Simulation construction section 4.7.3.4.2. quadratic adsorption == \\(\\langle\\)quadratic,\\(K_{ads-Q}^{FRP}\\),\\(Q^{FRP}_{max}\\),\\(D50_{ads-max}^{FRP}\\)\\(\\rangle\\) Used in a constituent model block to set the paramters for the quadratic FRP adsorption model. Simulation construction section 4.7.3.4.2. linear phyto model == \\(\\langle\\)basic;advanced,group_name\\(\\rangle\\) Used to commence a phytoplankton constituent model block via specification of a model from the phytoplankton constituent model class, and a phytoplankton group name. The group name can be any name required. If the advanced phytoplankton model is used then internal nitrogen and phosphorus concentrations will be simulated as computed variables and therefore must have respective initial conditions and boundary conditions specified, paying attention to ordering rules as required. Simulation construction section 4.7.3.5. \\(\\text{ }\\) min max == \\(\\langle\\)\\(\\left[PHY\\right]_{min}^{PHY}\\),\\(\\left[PHY\\right]_{max}^{PHY}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set minimum and maximum phytoplankton group concentrations. Simulation construction section 4.7.3.5.1. \\(\\text{ }\\) temperature limitation == \\(\\langle\\)none\\(\\rangle\\) Used in a phytoplankton constituent model block to turn off phytoplankton group temperature limitation. Simulation construction section 4.7.3.5.1.1. standard temperature limitation == \\(\\langle\\)standard,\\(T_{std}^{phy}\\),\\(T_{opt}^{phy}\\),\\(T_{max}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set the standard phytoplankton group temperature limitation function. Simulation construction section 4.7.3.5.1.1. none salinity limitation == \\(\\langle\\)none\\(\\rangle\\) Used in a phytoplankton constituent model block to turn off phytoplankton group salinity limitation. Simulation construction section 4.7.3.5.1.2. fresh,marine,mixed,estuarine salinity limitation == \\(\\langle\\)fresh,\\(S_{opt-fresh}^{phy}\\),\\(S_{max-fresh}^{phy}\\),\\(L_{max-fresh}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to select the freshwater phytoplankton group salinity limitation. Simulation construction section 4.7.3.5.1.2. none,marine,mixed,estuarine salinity limitation == \\(\\langle\\)marine,\\(S_{opt-marine}^{phy}\\),\\(L_{max-fresh}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to select the marine phytoplankton group salinity limitation. Simulation construction section 4.7.3.5.1.2. none,fresh,mixed,estuarine salinity limitation == \\(\\langle\\)mixed,\\(S_{opt-mix}^{phy}\\),\\(S_{max-mix}^{phy}\\),\\(L_{zero-mix}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to select the mixed phytoplankton group salinity limitation. Simulation construction section 4.7.3.5.1.2. none,marine,mixed,estuarine salinity limitation == \\(\\langle\\)estuarine,\\(S_{opt-est}^{phy}\\),\\(S_{max-est}^{phy}\\),\\(P_{est}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to select the estuarine phytoplankton group salinity limitation. Simulation construction section 4.7.3.5.1.2. none,fresh,marine,mixed nitrogen limitation == \\(\\langle\\)\\(\\left[N\\right]_{min}^{phy}\\),\\(K_{lim-N}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set nitrogen limitation parameters for the basic phytoplankton model. Simulation construction section 4.7.3.5.1.4. advanced nitrogen limitation == \\(\\langle\\)\\(\\left[N\\right]_{min}^{phy}\\),\\(K_{lim-N}^{phy}\\),\\(X_{N-C-min}^{phy}\\),\\(X_{N-C-max}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set nitrogen limitation parameters for the advanced phytoplankton model. Simulation construction section 4.7.3.5.2.1. basic phosphorus limitation == \\(\\langle\\)\\(\\left[P\\right]_{min}^{phy}\\),\\(K_{lim-P}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set phosphorus limitation parameters for the basic phytoplankton model. Simulation construction section 4.7.3.5.1.5. advanced phosphorus limitation == \\(\\langle\\)\\(\\left[P\\right]_{min}^{phy}\\),\\(K_{lim-P}^{phy}\\),\\(X_{P-C-min}^{phy}\\),\\(X_{P-C-max}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set phosphorus limitation parameters for the advanced phytoplankton model. Simulation construction section 4.7.3.5.2.2. basic silicate limitation == \\(\\langle\\)\\(\\left[Si\\right]_{min}^{phy}\\),\\(K_{lim-Si}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set silicate limitation parameters for the basic phytoplankton model. Specifying this command triggers silicate uptake. Simulation construction section 4.7.3.5.1.6. \\(\\text{ }\\) light limitation == \\(\\langle\\)basic,\\(Ke^{phy}\\),\\(I_{K-bas}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set basic light limitation parameters for the basic and advanced phytoplankton constituent models. If stokes settling is used then the vlaue of \\(I_K\\) specified in this command overrides any value specified using the settling == stokes , \\(I_K\\) command. Simulation construction section 4.7.3.5.1.3. monod,steele,webb,jassby,chalker,klepper,integrated, light limitation == \\(\\langle\\)monod,\\(Ke^{phy}\\),\\(I_{K-mon}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set monod light limitation parameters for the basic and advanced phytoplankton constituent models. If stokes settling is used then the vlaue of \\(I_K\\) specified in this command overrides any value specified using the settling == stokes , \\(I_K\\) command. Simulation construction section 4.7.3.5.1.3. basic,steele,webb,jassby,chalker,klepper,integrated, light limitation == \\(\\langle\\)steele,\\(Ke^{phy}\\),\\(I_{S-ste}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set steele light limitation parameters for the basic and advanced phytoplankton constituent models. Simulation construction section 4.7.3.5.1.3. basic,monod,webb,jassby,chalker,klepper,integrated, light limitation == \\(\\langle\\)webb,\\(Ke^{phy}\\),\\(I_{K-web}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set webb light limitation parameters for the basic and advanced phytoplankton constituent models. If stokes settling is used then the vlaue of \\(I_K\\) specified in this command overrides any value specified using the settling == stokes , \\(I_K\\) command. Simulation construction section 4.7.3.5.1.3. basic,steele,monod,jassby,chalker,klepper,integrated, light limitation == \\(\\langle\\)jassby,\\(Ke^{phy}\\),\\(I_{K-jas}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set jassby light limitation parameters for the basic and advanced phytoplankton constituent models. If stokes settling is used then the vlaue of \\(I_K\\) specified in this command overrides any value specified using the settling == stokes , \\(I_K\\) command. Simulation construction section 4.7.3.5.1.3. basic,steele,webb,monod,chalker,klepper,integrated, light limitation == \\(\\langle\\)chalker,\\(Ke^{phy}\\),\\(I_{K-cha}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set chalker light limitation parameters for the basic and advanced phytoplankton constituent models. If stokes settling is used then the vlaue of \\(I_K\\) specified in this command overrides any value specified using the settling == stokes , \\(I_K\\) command. Simulation construction section 4.7.3.5.1.3. basic,steele,webb,jassby,monod,klepper,integrated, light limitation == \\(\\langle\\)klepper,\\(Ke^{phy}\\),\\(I_{S-kle}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set klepper light limitation parameters for the basic and advanced phytoplankton constituent models. Simulation construction section 4.7.3.5.1.3. basic,steele,webb,jassby,chalker,monod,integrated, light limitation == \\(\\langle\\)integrated,\\(Ke^{phy}\\),\\(I_{S-int}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set integrated light limitation parameters for the basic and advanced phytoplankton constituent models. Simulation construction section 4.7.3.5.1.3. basic,steele,webb,jassby,chalker,klepper,monod, uptake == \\(\\langle\\)\\(X_{N-C-con}^{phy}\\),\\(X_{P-C-con}^{phy}\\),\\(X_{Si-C-con}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set constant nitrogen, phosphorus and optionally silicate to biomass ratios for the basic phytoplankton constituent model only. Simulation construction section 4.7.3.5.1.7. advanced uptake == \\(\\langle\\)\\(R_{N-uptake}^{phy}\\),\\(R_{P-uptake}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set nitrogen and phosphorus uptake rates for the advanced phytoplankton constituent model only. Simulation construction section 4.7.3.5.2.3. basic settling == \\(\\langle\\)none\\(\\rangle\\) Used in a phytoplankton constituent model block to turn off settling in both basic and advanced phytoplankton constituent models. Simulation construction section 4.7.3.5.1.12. constant,thermal,stokes,motile settling == \\(\\langle\\)constant,\\(V_{sett-con}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set a constant settling velocity in both basic and advanced phytoplankton constituent models. A negative value specified in this command is a downwards velocity. Setting the settling velocity to zero in this model is the same as using settling == none. Simulation construction section 4.7.3.5.1.12. none,thermal,stokes,motile settling == \\(\\langle\\)thermal,\\(V_{sett-thr}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set a constant settling velocity in both basic and advanced phytoplankton constituent models, allowing for temperature effects to settling. A negative value specified in this command is a downwards velocity. Simulation construction section 4.7.3.5.1.12. none,constant,stokes,motile settling == \\(\\langle\\)stokes,\\(I_{K-sto}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to compute settling velocity via stokes settling laws in both basic and advanced phytoplankton constituent models. Density must be simulated as a computed variable for each phytoplankton group that uses this model, so must have cell density initial conditions and boundary conditions specified as per ordering rules. The specification of \\(I_K\\) is not mandatory in this command. If it is not specified then the \\(I_K\\) specified in the phytoplankton constituent models light limitation model will be used. If a light limitaton model is not specified, or uses \\(I_S\\) instead of \\(I_K\\), then the library default value of \\(I_K\\) is used. If \\(I_K\\) is specified both in this stokes settling command and a phytoplankton constituent model light limitation function, then the value specified in the light limitation == command is used, and the value specified in this command is ignored. Simulation construction section 4.7.3.5.1.12. none,constant,thermal,motile settling == \\(\\langle\\)motile,\\(V_{mot}^{phy}\\),\\(I_{K-mot}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to compute settling velocity via motility functions that depend on ambient conditions, in only the advanced phytoplankton constituent model. The specification of \\(I_K\\) is not mandatory in this command. If it is not specified then the \\(I_K\\) specified in the phytoplankton constituent models light limitation model will be used. If a light limitaton model is not specified, or uses \\(I_S\\) instead of \\(I_K\\), then the library default value of \\(I_K\\) is used. If \\(I_K\\) is specified both in this motile settling command and a phytoplankton constituent model light limitation function, then the value specified in the light limitation == command is used, and the value specified in this command is ignored. Simulation construction section 4.7.3.5.2.4. none,constant,thermal,stokes carbon chla ratio == \\(\\langle\\)\\(X_{cc}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set the ratio of phytoplankton cell carbon biomass to chlorophyll a . Simulation construction section 4.7.3.5.1.10. \\(\\text{ }\\) end phyto model Used to terminate a phytoplankton constituent model block. Must follow an phyto model == ](#WQPhyMod) command. Simulation construction section 4.7.3.5.1.13. \\(\\text{ }\\) nitrogen fixing == \\(\\langle\\)\\(R_{nfix}^{N_2}\\),\\(f_{nfix}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set the nitrogen fixing parameters of a phytoplankton constituent model. The first parameter sets the rate of nitrogen fixing and the second dictates the influence of nitrogen fixing on primary productivity. Simulation construction section 4.7.3.5.1.11. \\(\\text{ }\\) growth == \\(\\langle\\)\\(R_{prod}^{phy}\\),\\(\\theta_{prod}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set primary productivity parameters of a phytoplankton constituent model. Simulation construction section 4.7.3.5.1.8. \\(\\text{ }\\) respiration == \\(\\langle\\)\\(R_{resp}^{phy}\\),\\(\\theta_{resp}^{phy}\\),\\(f_{true-resp}^{phy}\\),\\(f_{DOM-loss}^{phy}\\),\\(f_{exud}^{phy}\\)\\(\\rangle\\) Used in a phytoplankton constituent model block to set respiration and exudation parameters of a phytoplankton constituent model. Simulation construction section 4.7.3.5.1.9. \\(\\text{ }\\) water quality model == \\(\\langle\\)tuflow\\(\\rangle\\) Instruct TUFLOW FV to activate TUFLOW WQM. Simulation construction section 4.4.1. \\(\\text{ }\\) water quality control file == \\(\\langle\\)water quality control file name\\(\\rangle\\) Name of WQM control file, with no path. If this file is not in the FV control file directory, then additionally use command water quality mode directory ==. Simulation construction section 4.4.1. \\(\\text{ }\\) water quality model directory == \\(\\langle\\)water quality control file directory\\(\\rangle\\) Relative path from location of FV control file to the WQM control file directory, including last backslash, e.g. ..\". Simulation construction section 4.4.1. \\(\\text{ }\\) restart == \\(\\langle\\)restart file path and name\\(\\rangle\\) Specification of full path and name of previously saved restart file. Simulation construction section 4.4.2.1. \\(\\text{ }\\) initial wq concentration == \\(\\langle\\)initial conditon file name and path\\(\\rangle\\) Ordered individual computed variable initial conditions. Simulation construction section 4.4.2.1. \\(\\text{ }\\) initial scalar profile == \\(\\langle\\)initial conditon file name and path\\(\\rangle\\) Ordered individual computed variable initial conditions. Simulation construction section 4.4.2.1. \\(\\text{ }\\) initial condition 2d == \\(\\langle\\)initial conditon file name and path\\(\\rangle\\) Ordered individual computed variable initial conditions. Simulation construction section 4.4.2.1. \\(\\text{ }\\) initial condition 3d == \\(\\langle\\)initial conditon file name and path\\(\\rangle\\) Ordered individual computed variable initial conditions. Simulation construction section 4.4.2.1. \\(\\text{ }\\) material == \\(\\langle\\)Up to 10 comma separated material integers\\(\\rangle\\) Command to initiate a materials block. Commands within this block apply to the material numbers listed in this command. Simulation construction section 4.5.3. \\(\\text{ }\\) end material Command to terminate a materials block. This command must be paired with a corresponding material command to initiate the block. Simulation construction section 4.5.3. \\(\\text{ }\\) include sediment == \\(\\langle\\)include sediment transport calculations,include sediment in density calculation\\(\\rangle\\) TUFLOW FV command to include sediment simulation. Sediment must be simulated if adsorbed phosphorus is included in a WQM simulation. Simulation construction section @ref(). \\(\\text{ }\\) "],["AppConstits.html", "Appendix C Constituents", " Appendix C Constituents The following constituents are simulated by the WQM. Table C.1: WQM computed variables Name Relevant element Atomic number (Z) Atomic weight (M) Dissolved oxygen \\(O_2\\) 16 32 Silicate \\(Si\\) 16 32 Ammonium \\(N\\) 7 14 Nitrate \\(N\\) 7 14 Free reactive phosphorus \\(P\\) 15 31 Adsorbed free reactive phosphorus \\(P\\) 15 31 Organic carbon \\(C\\) 6 12 Organic nitrogen \\(N\\) 7 14 Organic phosphorus \\(P\\) 15 31 Phytoplankton \\(C\\), \\(N\\), \\(P\\) 6, 7, 15 12, 14, 31 Internal nitrogen \\(N\\) 7 14 Internal phosphorus \\(P\\) 15 31 "],["AppDemoModel.html", "Appendix D Demonstration model", " Appendix D Demonstration model Explanations of the processes captured by the WQM are described in the Appendices that follow. A demonstration model has been constructed to generate data to support these explanations via different interactive means. This model is referred to as the demonstration model. It has the following features, unless specified otherwise: General 1 week (168 hours) duration Includes salinity, temperature (and heat calculations), sediment and varying numbers of water quality computed variables Hourly output Geometry Single two-dimensional flat bottomed cell Lateral cell dimensions of 1 metre \\(\\times\\) 1 metre Depth of 0.5 metres Boundary conditions No inflows, outflows or other flow boundaries Meteorological boundaries applied Hourly timestep Corresponding twenty four row record repeated for each day Wind turned off, unless noted otherwise Constant air temperature, varied to match simulation needs Typical shortwave, longwave radiation and relative humidity Initial conditions Varied to match simulation needs Water quality parameterisation Varied to match simulation needs Additional model details are described in each Appendix where required. "],["AppO.html", "Appendix E Processes: oxygen E.1 Atmospheric aeration E.2 Sediment oxygen flux", " Appendix E Processes: oxygen E.1 Atmospheric aeration Atmospheric aeration (in the absence of higher order computed variables) is a key source of water column dissolved oxygen. Oxygenation is implemented in the upper model layer by the WQM, and then this oxygenated wateris mixed downwards by TUFLOW in subsequent timesteps. Initially, a Schmidt number and piston velocity (where the latter is also known as gas transfer velocity) are computed via Equation (E.1). \\[\\begin{equation} \\left.\\begin{aligned} Sc_{atm}^{O_2} &amp;= \\left(0.9 + \\frac{S}{350.0}\\right)\\times\\left(2073.1-125.62T+3.6276T^2-0.043219T^3\\right) \\\\ V_{pist}^{O_2} &amp;= 0.31 \\left( V_{wind}^{O_2} \\right) ^2 \\times \\left(\\frac{660.0}{Sc_{atm}^{O_2}}\\right)^x \\end{aligned}\\right\\} \\tag{E.1} \\end{equation}\\] \\(Sc_{atm}^{O_2}\\) and \\(V_{pist}^{O_2}\\) are the Schmidt number and piston velocity, respectively, \\(T\\) and \\(S\\) are ambient water temperature and salinity respectively and \\(V_{wind}^{O_2}\\) is wind speed. For wind speed \\(V_{wind}^{O_2}\\)&lt;3.0 m/s, \\(x\\) is 0.66, otherwise \\(x\\) is 0.5. Wind speed is assumed to be provided from TUFLOW at 10 metres from the water surface. There are a large number of different models available for computing both \\(Sc_{atm}^{O_2}\\) and \\(V_{pist}^{O_2}\\) within the WQM, however for oxygen transfer the models used in Equation (E.1) are set. Contact support@tuflow.com if other models are required. Once \\(Sc_{atm}^{O_2}\\) and \\(V_{pist}^{O_2}\\) are known, oxygenation to the surface layer is computed as per Equation (E.2) \\[\\begin{equation} F_{atm}^{O_2} = V_{pist}^{O_2} \\left(\\left[DO\\right]_{air} - \\left[DO\\right]\\right) \\tag{E.2} \\end{equation}\\] \\(F_{atm}^{O_2}\\) is the flux of atmospheric oxygen to the surface layer, and \\(\\left[DO\\right]_{air}\\) and \\(\\left[DO\\right]\\) are the oxygen concentrations in air and water (as a computed variable in a computational cell) at the air-water interface, respectively. \\(\\left[DO\\right]_{air}\\) is assumed to be the saturation concentration of dissolved oxygen in water which is at the ambient surface waters temperature and salinity conditions. E.2 Sediment oxygen flux Oxygen is exchanged between the water column and sediments via specification of a sediment flux representing the net effect of biological activity. In the case of oxygen, this flux is most commonly into the sediments, i.e. a negative sediment flux. Although it is rare that sediments act as sources of oxygen, TUFLOW WQM can be parameterised to allow for this if required. The user specified sediment oxygen flux (which can be spatially varying) is modified by overlying ambient dissolved oxygen concentration (together with a user specified half saturation oxygen concentration) and water temperature. These modifications are simulated via Michaelis-Menten and Arrhenius models, respectively, as per Equation (E.3). \\[\\begin{equation} F_{sed\\langle computed\\rangle}^{O_2} = F_{sed}^{O_2} \\times \\underbrace{\\frac{\\left[DO\\right]}{K_{sed-O_2}^{O_2} + \\left[DO\\right]}}_{\\text{Influence of oxygen}} \\times \\underbrace{ \\vphantom{ \\frac{\\left[DO\\right]}{K_{sed-O_2}^{O_2} + \\left[DO\\right]} } \\left[\\theta_{sed}^{O_2}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\tag{E.3} \\end{equation}\\] \\(F_{sed}^{O_2}\\) is the user specified oxygen sediment flux at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the overlying dissolved oxygen concentration computed by the WQM, \\(K_{sed-O_2}^{O_2}\\) and \\(\\theta_{sed}^{O_2}\\) are the half saturation concentrations and temperature coefficients for dissolved oxygen sediment flux respectively (both are user specified), and \\(T\\) is ambient water temperature. The form of the above relationship between dissolved oxygen concentration and the computed oxygen sediment flux, for a range of \\(K_{sed-O_2}^{O_2}\\) values is provided in Figure E.1. Water temperature is held constant at 20\\(^o\\)C and \\(\\theta_{sed}^{O_2}=1\\) (i.e. the Arrhenius temperature function is switched off). The user specified benthic oxygen sediment flux is -4,800 mg/m\\(^2\\)/day. Use the play button or drag the slider to see how different half saturation concentrations change the oxygen sediment flux (ordinate), as a function of ambient dissolved oxygen concentration (abscissa). Figure E.1: Move the slider to see the effect of changing the \\(K_{sed-O_2}^{O_2}\\) value on the computed oxygen sediment flux The figure demonstrates that in this example, the smaller the value of \\(K_{sed-O_2}^{O_2}\\), the faster the magnitude of the computed oxygen sediment flux increases with ambient dissolved oxygen concentration. This is consistent with one interpretation of \\(K_{sed-O_2}^{O_2}\\), that it is the ambient dissolved oxygen concentration at which the computed oxygen sediment flux is half that of the user specified \\(F_{sed}^{O_2}\\), when temperature effects are turned off. In light of the above, the demonstration model has been used to illustrate the influence that the half saturation concentration has on the rate of drawdown of water column dissolved oxygen. The model was repeatedly executed using a different \\(K_{sed-O_2}^{O_2}\\) for each simulation, but at the same water temperature of (approximately) 20\\(^o\\)C, and with temperature effects turned off. The predicted temporal evolution of water column dissolved oxygen concentration is provided in Figure E.2. Use the play button or drag the slider to see how different half saturation concentrations change the rate of dissolved oxygen (ordinate) drawdown with time (abscissa). Figure E.2: Move the slider to see the effect of changing the \\(K_{sed-O_2}^{O_2}\\) value on the rate of consumption of dissolved oxygen in water immediately above the sediments Consistent with the behaviour demonstrated in Figure E.1, Figure E.2 has a less rapid drawdown of ambient dissolved oxygen concentrations with increasing \\(K_{sed-O_2}^{O_2}\\). The rate of dissolved oxygen drawdown is also related to ambient water temperature, via the Arrhenius model in Equation (E.3). To illustrate this, the demonstration model was executed at a range of ambient temperatures, a constant half saturation concentration for oxygen of 4 mg/L and a temperature factor \\(\\theta_{sed}^{O_2}\\) of 1.05. The results are provided in Figure E.3. Use the play button or drag the slider to see how different ambient temperatures change the rate of dissolved oxygen (ordinate) drawdown under these conditions, with time (abscissa). Figure E.3: Move the slider to see the effect of changing the ambient water temperature on dissolved oxygen concentrations The figure confirms the expected result that the rate of dissolved oxygen drawdown increases with increasing ambient water temperature. This increased rate reflects the expected increase in benthic biological activity with temperature. "],["AppSil.html", "Appendix F Processes: silicate F.1 Sediment silicate flux", " Appendix F Processes: silicate F.1 Sediment silicate flux Silicate is exchanged between the water column and sediments via specification of a sediment flux. In the case of silicate, this flux is most commonly out of the sediments, i.e. a positive specification of sediment flux. Although it is rare that sediments act as sinks of silicate, TUFLOW WQM can be parameterised to allow for this if required. The user specified rate of sediment silicate flux (which can be spatially varying) is modified by overlying ambient dissolved oxygen concentration, a user specified half saturation oxygen concentration and water temperature. These modifications are simulated via Michaelis-Menten and Arrhenius models, respectively, as per Equation (F.1). \\[\\begin{equation} F_{sed\\langle computed\\rangle}^{Si} = F_{sed}^{Si} \\times \\underbrace{\\frac{K_{sed-O_2}^{Si}}{K_{sed-O_2}^{Si} + \\left[DO\\right]}}_{\\text{Influence of oxygen}} \\times \\underbrace{\\vphantom{\\frac{K_{sed-O_2}^{Si}}{K_{sed-O_2}^{Si} + \\left[DO\\right]}} \\left[\\theta_{sed}^{Si}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\tag{F.1} \\end{equation}\\] \\(F_{sed}^{Si}\\) is the user specified silicate sediment flux at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the overlying dissolved oxygen concentration, \\(K_{sed-O_2}^{Si}\\) and \\(\\theta_{sed}^{Si}\\) are the half saturation concentration of dissolved oxygen and temperature coefficient for silicate sediment production respectively (both are user specified), and \\(T\\) is ambient water temperature. The form of the above relationship between dissolved oxygen concentration and the computed silicate sediment flux, for a range of \\(K_{sed-O_2}^{Si}\\) values is provided in F.1. Water temperature is held constant at 20\\(^o\\)C and \\(\\theta_{sed}^{Si}\\)=1 (i.e. the Arrhenius temperature function is switched off). The user specified benthic silicate sediment flux is 1,120 mg/m\\(^2\\)/day. Use the play button or drag the slider to see how different half saturation oxygen concentrations change the silicate sediment flux (ordinate) with dissolved oxygen concentration (abscissa). Figure F.1: Move the slider to see the effect of changing the \\(K_{sed-O_2}^{Si}\\) value on the computed silicate sediment flux The figure demonstrates that in this example, the smaller the value of \\(K_{sed-O_2}^{Si}\\), the faster the magnitude of the computed silicate sediment flux increases with ambient dissolved oxygen concentration. This is consistent with one interpretation of \\(K_{sed-O_2}^{Si}\\), that it is the ambient dissolved oxygen concentration at which the computed silicate sediment flux is half that of the user specified \\(F_{sed}^{Si}\\), when temperature effects are turned off. More generally, for constant dissolved oxygen concentration and \\(K_{sed-O_2}^{Si}\\) and without temperature effects, Equation (F.1) has that the computed silicate sediment flux is constant. This means that silicate drawdown also occurs at a constant rate in the demonstration model, so the figure analogous to Figure E.2 is not presented here. A more realistic environmental setting has sediment silicate fluxes occurring against a background of oxygen concentration drawdown. The demonstration model has been used to illustrate this via execution of a suite of simulations that experience dissolved oxygen drawdown (in the dissolved oxygen constituent model, with \\(K_{sed-O_2}^{O_2}\\) = 4 mg/L) and each simulation using a different value of \\(K_{sed-O_2}^{Si}\\). The silicate sediment flux rate was specified as above and temperature effects were turned off. The predicted temporal evolution of water column silicate concentration is provided in Figure F.2. Use the play button or drag the slider to see how different half saturation concentrations change predicted silicate concentrations (ordinate) in time (abscissa). Figure F.2: Move the slider to see the effect of changing the \\(K_{sed-O_2}^{Si}\\) value on the rate of prodution of silicate in water immediately above the sediments Finally, the demonstration model was executed over a suite of simulations that had constant sediment flux rates (as above), half saturation coefficients (both \\(K_{sed-O_2}^{O_2}\\) and \\(K_{sed-O_2}^{Si}\\) = 4 mg/L) and temperature coefficients (both \\(\\theta_{sed}^{O_2}\\) and \\(\\theta_{sed}^{Si}\\) = 1.05), but varied ambient water temperature. The predicted temporal evolution of water column silicate concentration is provided in Figure F.3. Use the play button or drag the slider to see how different water temperatures change silicate concentrations (ordinate) in time (abscissa). Figure F.3: Move the slider to see the effect of changing the ambient water temperature on silicate concentration Although not recommended, the influence of oxygen in all the above processes can be removed by setting the command oxygen == off in the silicate model block. "],["AppIN.html", "Appendix G Processes: inorganic nitrogen G.1 Sediment ammonium and nitrate flux G.2 Nitrification G.3 Denitrification G.4 Wet deposition of inorganic nitrogen G.5 Dry deposition of inorganic nitrogen", " Appendix G Processes: inorganic nitrogen G.1 Sediment ammonium and nitrate flux Ammonium and nitrate are exchanged between the water column and sediments via specification of separate sediment fluxes. In both cases, this flux is most commonly out of the sediments, i.e. a positive specification of sediment flux. Although it is rare that sediments act as sinks of these nitrogenous species, TUFLOW WQM can be parameterised to allow for this if required. The user specified rates of ammonium and nitrate fluxes (which can be spatially varying) are modified by overlying ambient dissolved oxygen concentration (together with respective user specified half saturation oxygen concentrations) and water temperature. These modifications are simulated via Michaelis-Menten and Arrhenius models, respectively, as per Equation (G.1). \\[\\begin{equation} \\left.\\begin{aligned} F_{sed\\langle computed\\rangle}^{NH_4} =&amp; F_{sed}^{NH_4} \\times \\frac{K_{sed-O_2}^{NH_4}}{K_{sed-O_2}^{NH_4} + \\left[DO\\right]} \\times \\hphantom{\\text{ab}} \\left[\\theta_{sed}^{NH_4}\\right]^{\\left(T-20\\right)} \\\\ \\\\ F_{sed\\langle computed\\rangle}^{NO_3} =&amp; F_{sed}^{NO_3} \\times \\underbrace{\\frac{\\left[DO\\right]}{K_{sed-O_2}^{NO_3} + \\left[DO\\right]}}_{\\text{Influence of oxygen}} \\times \\underbrace{\\vphantom{\\frac{\\left[DO\\right]}{K_{sed-O_2}^{NO_3} + \\left[DO\\right]}} \\left[\\theta_{sed}^{NO_3}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\end{aligned}\\right\\} \\tag{G.1} \\end{equation}\\] \\(F_{sed}^{NH_4}\\) and \\(F_{sed}^{NO_3}\\) are the user specified ammonium and nitrate sediment fluxes at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the overlying dissolved oxygen concentration, \\(K_{sed-O_2}^{NH_4}\\) and \\(K_{sed-O_2}^{NO_3}\\) are the user specified half saturation concentrations of dissolved oxygen for ammonium and nitrate sediment flux, \\(\\theta_{sed}^{NH_4}\\) and \\(\\theta_{sed}^{NO_3}\\) are the corresponding temperature coefficients, and \\(T\\) is ambient water temperature. As per silicate sediment flux (see Section F.1), the above equations lead to linearly varying ambient ammonium and nitrate concentrations in the demonstration model when dissolved oxygen concentration, half saturation oxygen concentrations and ambient temperature are set to be constant. A more realistic environmental setting has sediment ammonium and nitrate fluxes occurring against a background of oxygen concentration drawdown. The demonstration model has been used to illustrate this via execution of a suite of simulations that experience dissolved oxygen drawdown (in the dissolved oxygen constituent model, with \\(K_{sed-O_2}^{O_2}\\) = 4 mg/L) and each simulation using a the same value for both \\(K_{sed-O_2}^{NH_4}\\) and \\(K_{sed-O_2}^{NO_3}\\). The ammonium and nitrate sediment flux rates were both specified as 140 mg/m\\(^2\\)/d, and temperature effects were turned off. The predicted temporal evolution of water column ammonium and nitrate concentrations is provided in Figure G.1. Use the play button or drag the slider to see how different half saturation concentrations change ambient concentrations (ordinate) in time (abscissa). Figure G.1: Move the slider to see the effect of changing the \\(K_{sed-O_2}^{NH_4}\\) (and \\(K_{sed-O_2}^{NO_3}\\) - they are set to be equal to each other in this example) values on ambient ammonium and nitrate concentrations. Ambient dissolved oxygen is drawn down in time Figure G.1 illustrates the different oxygen responses of ammonium and nitrate sediment fluxes, as reflected in the different formulations within Equation (G.1). Importantly, the figure demonstrates that as ambient oxygen concentrations reach zero near 60 hours (see Figure E.2 with the slider bar set to \\(K_{sed-O_2}^{O_2}\\) = 4 mg/L), nitrate sediment flux ceases and the resultant ambient concentrations plateau. The converse is true to ammonium. One implication of this behaviour is that in environmental systems being simulated using the WQM, the rate of delivery of ammonium mass to the water column will generally increase under low dissolved oxygen conditions (e.g. waters isolated underneath a strong lacustrine a thermocline), whilst the corresponding nitrate mass fluxes will reduce under the same conditions. This is the expected and observed behaviour of environmental systems. The rate of ammonium and nitrate flux is also related to ambient water temperature, via the Arrhenius model in Equation (G.1). To demonstrate this, the same model above (with time varying dissolved oxygen concentration) was executed at a range of ambient temperatures, but constant half saturation concentrations for oxygen for both ammonium and nitrate set to 4 mg/L. All temperature coefficients were set to 1.05. The results are provided in Figure G.2. Use the play button or drag the slider to see how different ambient temperatures change the ambient ammonium and nitrate concentrations (ordinate) in time (abscissa). Figure G.2: Move the slider to see the effect of changing the ambient water temperature on ammonium and nitrate concentrations, with ambient dissolved oxygen drawdown The figure shows that as ambient water temperature increases, the rate of increases of both ammonium and nitrate concentrations follow suit. Again, nitrate concentrations plateau once background dissolved oxygen concentrations reach zero, however ammonium concentrations continue to rise throughout the simulation. This is expected behaviour. G.2 Nitrification Nitrification is the pelagic biological oxidation of ammonium to nitrate. The equations representing this process (including intermediates) are as follows. \\[\\begin{equation} \\left.\\begin{aligned} 2NH_4^{+} + 3O_2 \\rightarrow &amp; 2NO_2^{-} + 4H^+ + 2H_2O \\\\ \\\\ 2NO_2^{-} + O_2 \\rightarrow &amp; 2NO_3^- \\end{aligned}\\right\\} \\tag{G.2} \\end{equation}\\] Dissolved oxygen is consumed by nitrification of ammonium, in a molar ratio of 1:2 N:O\\(_2\\) (i.e. 2 moles of ammonium consume 4 moles of diatomic oxygen). Nitrite is an intermediate product of nitrification, and simulation of this quantity is possible within the WQM although not currently activated. Contact support@tuflow.com if this capability is required. The pelagic nitrification rate is computed within the WQM via Equation (G.3). \\[\\begin{equation} R_{nitrif\\langle computed\\rangle}^{NH_4} = R_{nitrif}^{NH_4} \\times \\underbrace{\\frac{\\left[ DO \\right]}{K_{nitrif-O_2}^{NH_4} + \\left[DO\\right]}}_{\\text{Influence of oxygen}} \\times \\underbrace{ \\vphantom{\\frac{\\left[ DO \\right]}{K_{nitrif-O_2}^{NH_4} + \\left[DO\\right]}} \\left[\\theta_{nitrif}^{NH_4}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\tag{G.3} \\end{equation}\\] \\(R_{nitrif}^{NH_4}\\) is the user specified ammonium nitrifcation rate at at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the ambient dissolved oxygen concentration, \\(K_{nitrif-O_2}^{NH_4}\\) and \\(\\theta_{nitrif}^{NH_4}\\) are the half saturation concentration of dissolved oxygen and temperature coefficient for nitrification of ammonium respectively (both are user specified), and \\(T\\) is ambient water temperature. The nitrification rate from Equation (G.3) is multiplied by ambient ammonium concentration to compute the flux of ammonium to nitrate at each model timestep in each model cell via Equation (G.4). \\[\\begin{equation} F_{nitrif\\langle computed\\rangle}^{NH_4} = R_{nitrif\\langle computed\\rangle}^{NH_4} \\times \\left[ NH_4 \\right] \\tag{G.4} \\end{equation}\\] Equation (G.3) reveals a linear relationship between \\(R_{nitrif\\langle computed\\rangle}^{NH_4}\\) and both (constant) dissolved oxygen concentration and half saturation oxygen concentration. In dissolved oxygen conditions away from oxygen sinks other than nitrification itself (such as sediments), this leaves ambient temperature as the key external determinant of the computed nitrification rates. A suite of demonstration model simulations were executed to illustrate this, with each simulation having its own temperature, and a constant nitrification rate \\(R_{nitrif}^{NH_4}\\) of 0.1/day. Ammonium and nitrate initial conditions were always set to 4 and 0 mg/L respectively, \\(K_{nitrif-O_2}^{NH_4}\\) to 4 mg/L and \\(\\theta_{nitrif}^{NH_4}\\) was set to 1.05. In order to illustrate only the workings of nitrification, all sediment fluxes were set to zero. The predicted temporal evolution of water column ammonium and nitrate concentrations in these simulations are provided in Figure G.3. Corresponding dissolved oxygen concentrations are also included to demonstrate the impact of nitrification on water column oxygen. Use the play button or drag the slider to see how different ambient temperatures change the ambient ammonium, nitrate and dissolved oxygen concentrations (ordinate) in time (abscissa). Figure G.3: Move the slider to see the effect of changing ambient water temperature on the concentrations of ammonia, nitrate and oxygen The figure demonstrates the expected behaviour, where ammonium is consumed and nitrate produced. The drawdown in oxygen presented in the figure is due only to nitrification. The figure also reveals the mass conserving behaviour of the WQM: the decrease in ammonium (N) concentration is the same as the corresponding increase in nitrate (N) concentration for each of the different temperature simulations. This confirms the 1:1 ratio of nitrogen conversion from ammonium to nitrate in moles (Equation (G.2)), and hence concentration in an otherwise closed system. The drawdown in oxygen also demonstrates the WQM mass balance. In the 12\\(^o\\)C case for example: The change in dissolved oxygen concentration is 4.37 mg/L Converting this to moles of O\\(_2\\) gives 0.1366 moles O\\(_2\\) (= 4.37/32) The change in ammonium (or nitrate) concentration is 0.955 mg/L Converting this to moles of N gives 0.0682 moles of N (= 0.955/14) The number of moles of dissolved oxygen consumed (0.137) is twice that the number of moles of N transformed from ammonium to nitrate (0.0682), to two decimal places. This is consistent with Equation (G.2). A full WQM mass balance is presented in Appendix Q. G.3 Denitrification Denitrification is the pelagic biological reduction of nitrate to free nitrogen gas, \\(N_2\\). This typically occurs as a result of microbial oxygen stripping from nitrate in low dissolved oxygen environments. It occurs through a series of intermediate stages, but is typically represented as a single-step process with a governing denitrification rate. This rate is computed within the WQM via either Equation (G.5) or (G.6). These are identical other than their treatment of the influence of dissolved oxygen on denitrification, which is either Michaelis-Menten or exponential, respectively. Unlike nitrification, denitrification includes the influence of nitrate concentration in both rate calculations, again in a Michaelis-Menten form. \\[\\begin{equation} R_{denit\\langle computed\\rangle}^{NO_3} = R_{denit}^{NO_3} \\hphantom{\\text{abc}} \\times \\hphantom{\\text{abc}} \\frac{K_{denit-O_2-MM}^{NO_3}}{K_{denit-O_2-MM}^{NO_3} + \\left[DO\\right]} \\times \\left[\\theta_{denit}^{NO_3}\\right]^{\\left(T-20\\right)} \\times \\frac{\\left[NO_3\\right]}{K_{denit-NO_3}^{NO_3} + \\left[NO_3\\right]} \\tag{G.5} \\end{equation}\\] \\[\\begin{equation} R_{denit\\langle computed\\rangle}^{NO_3} = R_{denit}^{NO_3} \\hphantom{\\text{abc}} \\times \\hphantom{\\text{abc}} \\underbrace{\\vphantom{\\frac{\\left[NO_3\\right]}{K_{denit-NO_3}^{NO_3} + \\left[NO_3\\right]}}{\\rm e}^{\\left[\\frac{-\\left[DO\\right]}{K_{denit-O_2-exp}^{NO_3}}\\right]}}_{\\text{Influence of oxygen}} \\times \\hphantom{\\text{abcd}} \\underbrace{\\vphantom{\\frac{\\left[NO_3\\right]}{K_{denit-NO_3}^{NO_3} + \\left[NO_3\\right]}}\\left[\\theta_{denit}^{NO_3}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\times \\underbrace{\\frac{\\left[NO_3\\right]}{K_{denit-NO_3}^{NO_3} + \\left[NO_3\\right]}}_{\\text{Influence of nitrate}} \\tag{G.6} \\end{equation}\\] \\(R_{denit}^{NO_3}\\) is the user specified nitrate denitrification rate at 20\\(^o\\)C and without the influence of dissolved oxygen, and \\(\\left[DO\\right]\\) and \\(\\left[NO_3\\right]\\) are the ambient dissolved oxygen and nitrate concentrations respectively. If the Michaelis-Menten oxygen model is used then \\(K_{denit-O2-MM}^{NO_3}\\) is the half saturation concentration of oxygen for denitrification. If the exponential model is used then \\(K_{denit-O2-exp}^{NO_3}\\) is the dissolved oxygen concentration that normalises (i.e. non-dimensionalises) the ambient oxygen concentration used in Equation (G.6). Equation (G.5) is the default. Finally, \\(\\theta_{denit}^{NO_3}\\) is the temperature coefficient for denitrification of nitrate, \\(T\\) is ambient water temperature, and \\(K_{denit-NO_3}^{NO_3}\\) is the Michaelis-Menten half saturation nitrate concentration that influences denitrification in both Equations (G.5) and (G.6). \\(K_{denit-NO_3}^{NO_3}\\) is not user definable, but hardwired to a value of 0.07 mg/L of nitrate (5.0 mmol/m\\(^3\\)). The computed denitrification rate from Equation (G.5) or (G.6) is then multiplied by ambient nitrate concentration to compute the flux of nitrate to free nitrogen gas at each model timestep in each model cell via Equation (G.7). \\[\\begin{equation} F_{denit}^{NO_3} = R_{denit\\langle computed\\rangle}^{NO_3} \\times \\left[ NO_3 \\right] \\tag{G.7} \\end{equation}\\] Unlike nitrification, denitrification does not produce or consume dissolved oxygen. It does, however, consume nitrate and therefore presents a feedback loop in Equations (G.5) through (G.7). The demonstration model was executed over two suites of identical simulations that varied temperature from one simulation to the next, with the first suite using Equation (G.5) and the second suite using Equation (G.6). Only denitrification was turned on, and constant values for \\(R_{denit}^{NO_3}\\) (1.5/day - a deliberately very large value was chosen to demonstrate trends), \\(K_{denit-O_2}^{NO_3}\\) (4 mg/L) and \\(K_{denit-NO_3}^{NO_3}\\) (15.5 mg/L) were set. Temperature coefficients were set to 1.05. The predicted temporal evolution of water column nitrate concentrations in these simulation pairs are provided in Figure G.4. Figure G.4: Move the slider to see the effect of changing temperature on the concentrations of nitrate, where two different denitrification models are used The figure demonstrates the expected behaviour, where nitrate is consumed in a non-linear manner. The different models produce different drawdown rates, also as expected. In this example, these differences are substantial. The same two suites of demonstration models were also used to illustrate the influence of varying \\(K_{denit-O_2}^{NO_3}\\) (instead of temperature) on denitrification. All set ups from the models used above were retained, other than setting ambient water temperature to constant at 20 \\(^o\\)C, and allowing \\(K_{denit-O_2}^{NO_3}\\) to vary. The predicted temporal evolution of water column nitrate concentrations in these demonstration model simulation pairs are provided in Figure G.5. Figure G.5: Move the slider to see the effect of changing \\(K_{denit-O_2}^{NO_3}\\) on the concentrations of nitrate, where two different denitrification models are used Substantial differences in the prediction of nitrate concentrations is again observed, especially at lower half saturation concentrations. Although not recommended, the influence of oxygen in all the above processes can be removed by setting the command oxygen == off in the nitrogen model block. This switch applies to sediment flux, nitrification and denitrifcation equally. G.4 Wet deposition of inorganic nitrogen Wet deposition of inorganic nitrogen includes the pluvial delivery of both ammonium and nitrate to the water column. A global total inorganic nitrogen concentration in rainfall is specifiable, together with the proportion of that total that is nitrate. From this, the WQM computes ammonium and nitrate concentrations (Equations (G.8) and (G.9), respectively). \\[\\begin{equation} \\left[{NH_4}\\right]_{rain} = \\left[{TN}\\right]_{rain} \\times (1-f_{TN}^{NO_3}) \\tag{G.8} \\end{equation}\\] \\[\\begin{equation} \\left[{NO_3}\\right]_{rain} = \\left[{TN}\\right]_{rain} \\times f_{TN}^{NO_3} \\tag{G.9} \\end{equation}\\] \\(\\left[{TN}\\right]_{rain}\\) and \\(f_{TN}^{NO_3}\\) are the concentration of total nitrogen in rain and the fraction of that total that is nitrate, respectively. The WQM separately multiplies \\(\\left[{NH_4}\\right]_{rain}\\) and \\(\\left[{NO_3}\\right]_{rain}\\) by each timesteps rainfall depth and corresponding model surface area(s) to compute the wet mass flux of ammonium and nitrate (Equations (G.10) and (G.11), respectively). These masses are added to the uppermost model layer cells and corresponding changes to ambient concentrations computed. \\[\\begin{equation} F_{atm-wet}^{NH_4} = \\left[{NH_4}\\right]_{rain} \\times \\text{Timestep rainfall depth} \\times \\text{Model area(s)} \\tag{G.10} \\end{equation}\\] \\[\\begin{equation} F_{atm-wet}^{NO_3} = \\left[{NO_3}\\right]_{rain} \\times \\text{Timestep rainfall depth} \\times \\text{Model area(s)} \\tag{G.11} \\end{equation}\\] If rainfall depth is specified as being spatially variable (i.e. by application of multiple atmospheric boundary conditions within TUFLOW FV), then \\(F_{atm-wet}^{NH_4}\\) and \\(F_{atm-wet}^{NO_3}\\) will correspondingly vary spatially. G.5 Dry deposition of inorganic nitrogen Dry deposition of nitrogen includes the delivery of both ammonium and nitrate to the water column from atmospheric fallout. This fallout is typically thought of as being associated with dust. A single constant daily deposition rate of total nitrogen is specifiable, and the WQM splits this into separate ammonia and nitrate rates using the same fraction applied to the wet deposition total inorganic nitrogen concentration (Section G.4). \\[\\begin{equation} R^{NH_4}_{atm-dry} = R^{TN}_{atm-dry} \\times (1-f_{TN}^{NO_3}) \\tag{G.12} \\end{equation}\\] \\[\\begin{equation} R^{NO_3}_{atm-dry} = R^{TN}_{atm-dry} \\times f_{TN}^{NO_3} \\tag{G.13} \\end{equation}\\] \\(R^{TN}_{atm-dry}\\) and \\(f_{TN}^{NO_3}\\) are the user specified rate of dry total inorganic nitrogen deposition, and the fraction that is nitrate, respectively. These individual rates \\(R^{NH_4}_{atm-dry}\\) and \\(R^{NO_3}_{atm-dry}\\) are multiplied by model timestep and the global model surface area to compute the dry mass flux of ammonium and nitrate (Equations (G.14) and (G.15), respectively). These masses are added to the uppermost model layer cells and corresponding changes to ambient concentrations computed. \\[\\begin{equation} F_{atm-dry}^{NH_4} = R^{NH_4}_{atm-dry} \\times \\text{Timestep} \\times \\text{Global model area} \\tag{G.14} \\end{equation}\\] \\[\\begin{equation} F_{atm-dry}^{NO_3} = R^{NO_3}_{atm-dry} \\times \\text{Timestep} \\times \\text{Global model area} \\tag{G.15} \\end{equation}\\] This constant dry mass flux for each of ammonium and nitrate is applied globally. "],["AppIP.html", "Appendix H Processes: inorganic phosphorus H.1 Sediment FRP flux H.2 Wet deposition of inorganic phosphorus H.3 Dry deposition of inorganic phosphorus H.4 Adsorption and Desorption H.5 Settling", " Appendix H Processes: inorganic phosphorus H.1 Sediment FRP flux Free reactive phosphorus (FRP) is exchanged between the water column and sediments via specification of sediment fluxes. This flux is most commonly out of the sediments, i.e. a positive specification of sediment flux. Although it is rare that sediments act as sinks of FRP, TUFLOW WQM can be parameterised to allow for this if required. The user specified rate of FRP flux (which can be spatially varying) is modified by overlying ambient dissolved oxygen concentration (together with a user specified half saturation oxygen concentration) and water temperature. These modifications are simulated via Michaelis-Menten and Arrhenius models, respectively, as per Equation (H.1). \\[\\begin{equation} F_{sed\\langle computed\\rangle}^{FRP} = F_{sed}^{FRP} \\times \\underbrace{\\frac{K_{sed-O_2}^{FRP}}{K_{sed-O_2}^{FRP} + \\left[DO\\right]}}_{\\text{Influence of oxygen}} \\times \\underbrace{\\vphantom{\\frac{K_{sed-O_2}^{FRP}}{K_{sed-O_2}^{FRP} + \\left[DO\\right]}} \\left[\\theta_{sed}^{FRP}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\tag{H.1} \\end{equation}\\] \\(F_{sed}^{FRP}\\) is the user specified FRP sediment flux at 20\\(^o\\)C without the influence of dissolved oxygen, \\(\\left[DO\\right]\\) is the overlying dissolved oxygen concentration, \\(K_{sed-O_2}^{FRP}\\) is the user specified half saturation concentration of dissolved oxygen for FRP sediment flux, \\(\\theta_{sed}^{FRP}\\) is the corresponding temperature coefficient, and \\(T\\) is ambient water temperature. As per silicate sediment fluxes (see Section F.1), the above equation leads to linearly varying ambient FRP concentrations in the demonstration model when dissolved oxygen concentration, half saturation oxygen concentration and temperature are set to be constant. A more realistic environmental setting has sediment FRP flux occurring against a background of oxygen concentration drawdown. The demonstration model has been used to illustrate this via execution of a suite of simulations that experience dissolved oxygen drawdown, with \\(K_{sed-O_2}^{O_2}\\) = 4 mg/L and each simulation using a different \\(K_{sed-O_2}^{FRP}\\). The FRP sediment flux rate was specified as 400 mg/m\\(^2\\)/d and temperature effects were turned off. The predicted temporal evolution of water column FRP concentrations is provided in Figure H.1. Use the play button or drag the slider to see how different half saturation concentrations change ambient concentrations. Figure H.1: Move the slider to see the effect of changing the \\(K_{sed-O_2}^{FRP}\\) values on ambient FRP concentrations. Ambient dissolved oxygen is drawn down in time The rate of FRP flux is also related to ambient water temperature, via the Arrhenius model in Equations (H.1). To demonstrate this, the same model above (with time varying dissolved oxygen concentration) was executed at a range of ambient temperatures, but constant half saturation concentrations for oxygen set to 4 mg/L. All temperature coefficients were set to 1.05. The results are provided in Figure H.2. Use the play button or drag the slider to see how different ambient temperatures change ambient concentrations. Figure H.2: Move the slider to see the effect of changing the ambient water temperature on the rate of FRP fluxes to water immediately above the sediments, with ambient dissolved oxygen drawdown The figure shows that as ambient water temperature increases, the rate of increase of FRP concentrations follow suit. This is expected behaviour. H.2 Wet deposition of inorganic phosphorus Wet deposition of inorganic phosphorus includes the pluvial delivery of free reactive phosphorus to the water column. A global FRP concentration in rainfall is specifiable. The WQM multiplies this concentration by each timesteps rainfall depth and corresponding model surface area(s) to compute the wet mass flux of FRP over each timestep (Equation (H.2)). \\[\\begin{equation} F_{atm-wet}^{FRP} = \\left[{FRP}\\right]_{rain} \\times \\text{Timestep rainfall depth} \\times \\text{Model area} \\tag{H.2} \\end{equation}\\] \\(\\left[{FRP}\\right]_{rain}\\) is the specified rainfall concentration of FRP. This mass is added to the uppermost model layer cells and corresponding changes to ambient FRP concentrations computed. If rainfall depth is specified as being spatially variable (i.e. by application of multiple atmospheric boundary conditions within TUFLOW FV), then \\(F_{atm-wet}^{FRP}\\) will correspondingly vary spatially. H.3 Dry deposition of inorganic phosphorus Dry deposition of inorganic phosphorus includes the delivery of FRP to the water column from atmospheric dust fallout. A constant daily mass loading rate of FRP is specifiable, and the WQM multiples this rate by model timestep and the global model surface area to compute the mass flux of FRP (Equation (H.3)). This mass is added to the uppermost model layer cells and corresponding changes to ambient concentrations computed. \\[\\begin{equation} F_{atm-dry}^{FRP} = R^{FRP}_{atm-dry} \\times \\text{Timestep} \\times \\text{Global model area} \\tag{H.3} \\end{equation}\\] \\(R^{FRP}_{atm-dry}\\) is the user specified rate of FRP atmospheric fallout. One (constant) mass flux for each is applied globally. This dry deposition is only applied if FRP adsorption is simulated, and if this is the case, then this introduction of dry deposited FRP is assigned to the adsorbed FRP computed variable. If adsorbed FRP is not included in a simulation, then dry deposition of FRP will be ignored. H.4 Adsorption and Desorption At each timestep and within each active computational cell, the WQM distributes the total FRP mass between dissolved FRP and adsorbed FRP if the phosphorus adsorption constituent model is used. Total FRP is conserved via Equation (H.4). \\[\\begin{equation} \\left[FRP\\right]_{tot} = \\left[adsFRP\\right]^{adsFRP} + \\left[FRP\\right]^{FRP} \\tag{H.4} \\end{equation}\\] \\(\\left[FRP\\right]_{tot}\\) is the total FRP available for distribution between dissolved and adsorbed states, and \\(\\left[adsFRP\\right]^{adsFRP}\\) and \\(\\left[FRP\\right]^{FRP}\\) are the adsorbed and dissolved FRP concentrations, respectively. The distribution between adsorbed and dissolved FRP concentrations is computed within the WQM via either Equation (H.5) or (H.6), as selected by the user. Equation (H.5) is the default. \\[\\begin{equation} \\left.\\begin{aligned} \\left[adsFRP\\right]^{adsFRP} &amp;= \\left(\\frac{K_{ads-L}^{FRP} \\times \\left[TSS\\right]}{1 + K_{ads-L}^{FRP} \\times \\left[TSS\\right]}\\right) \\times \\left[FRP\\right]_{tot}\\\\ \\\\ \\left[FRP\\right]^{FRP} &amp;= \\left(\\frac{1}{1 + K_{ads-L}^{FRP} \\times \\left[TSS\\right]}\\right) \\times \\left[FRP\\right]_{tot} \\end{aligned}\\right\\} \\tag{H.5} \\end{equation}\\] \\(\\left[TSS\\right]\\) is the sum of suspended sediment concentrations of sediment fractions that have been designated as able to adsorb FRP and \\(K_{ads-L}^{FRP}\\) is the linear sorption partitioning coefficient. These adsorbing fractions are identified by setting a maximum \\(d50_{ads-max}^{FRP}\\) sediment diameter in the adsorption == command. \\[\\begin{equation} \\left.\\begin{aligned} \\left[adsFRP\\right]^{adsFRP} &amp;= \\frac{1}{2} \\times \\left[\\left(\\left[FRP\\right]_{Tot} + \\frac{1}{K_{ads-Q}^{FRP}} + \\left(\\left[TSS\\right] \\times Q^{FRP}_{max}\\right)\\right) - \\text{C} \\right] \\\\ \\\\ \\left[FRP\\right]^{FRP} &amp;= \\frac{1}{2} \\times \\left[\\left(\\left[FRP\\right]_{Tot} - \\frac{1}{K_{ads-Q}^{FRP}} - \\left(\\left[TSS\\right] \\times Q^{FRP}_{max}\\right)\\right) + \\text{C} \\right] \\\\ \\\\ \\text{C} &amp;= \\sqrt{\\left(\\left[FRP\\right]_{Tot} + \\frac{1}{K_{ads-Q}^{FRP}} - \\left(\\left[TSS\\right] \\times Q^{FRP}_{max}\\right)\\right)^2 + \\left(\\frac{4.0\\times \\left[TSS\\right] \\times Q^{FRP}_{max}}{K_{ads-Q}^{FRP}}\\right)} \\end{aligned}\\right\\} \\tag{H.6} \\end{equation}\\] \\(\\left[TSS\\right]\\) is again the sum of suspended sediment concentrations of sediment fractions that have been designated as able to adsorb FRP, \\(K_{ads-Q}^{FRP}\\) is the ratio of adsorption and desorption rate coefficients and \\(Q^{FRP}_{max}\\) is the maximum adsorption capacity of suspended sediment, for FRP. The above equations offer alternative approaches to simulating the distribution of total FRP between adsorbed and free states. Figures H.3 and H.4 (only Figure H.4 is interactive) provide indicative representations of the general form of these relationships, for assumed total FRP (0.1 mg/L) and TSS (5mg/L) concentrations. Figure H.3: The change in distribution of dissolved and adsorbed FRP under the linear adsorption model. This figure has no slider bar Figure H.4: The change in distribution of dissolved and adsorbed FRP under the quadratic adsorption model The parameters used to prepare the above figures were deliberately chosen to illustrate the different behaviour that can result from these two models. This underscores the need to make careful decisions regarding the selection of an adsorption model, and to use WQM diagnostic outputs to assess model performance. H.5 Settling At each timestep and within each active computational cell, the WQM computes the mass of adsorbed FRP that has settled either through the water column or onto the bed, using the settling velocities for each eligible sediment fraction, as provided by TUFLOW FV. Settled adsorbed FRP that reaches the bed is considered to be a permanent sink of FRP and is not returned to the WQM. If new sediment is (re)suspended by the STM then it is included in adsorption and desorption calculations as per Section H.4, but without returning any previously settled FRP to the water column. "],["AppPhy.html", "Appendix I Processes: phyto general I.1 General I.2 Units", " Appendix I Processes: phyto general I.1 General Any number of phytoplankton groups may be simulated within the WQM, however the majority of environmental modelling applications rarely require (or have data to justify) including more than a relatively small number. Each phytoplankton group can have its properties set independently, where these properties typically relate to interaction with temperature, light, salinity and nutrients. The WQM offers two constituent models for the simulation of phytoplankton. These are referred to as basic and advanced, and are primarily differentiated on the basis of whether internal nutrients are simulated, as: Constituent model basic does not include simulation of internal phytoplanktonic nutrients Constituent model advanced does include simulation of internal phytoplanktonic nutrients This constituent model naming is intended to reflect a view that excluding simulation of internal nutrients is a simpler, more rudimentary, approach to phytoplankton modelling. Similarly, internal nutrient simulation generally requires specification of a larger suite of parameters than when the process is excluded, so is often considered to be a more complex and involved approach to phytoplankton simulation. A WQM simulation can include any combination of these two constituent models if multiple phytoplankton groups are simulated. For example, if three phytoplankton groups are to be simulated, two groups could be set to use the basic constituent model, and one to use the advanced constituent model. Where WQM calculations are completed differently between these two constituent models, their respective approaches are presented in a complementary but distinct manner following. I.2 Units Phytoplankton is accounted within the WQM in units of carbon, however carbon need not be explicitly simulated within the WQM to support this approach. If this is the case, then uptake or loss of carbon by phytoplankton is still computed, but the associated carbon sources and sinks are assumed to be large and not specifically accounted for as carbonaceous computed variables. A user specified (or default) conversion ratio between mg of carbon and mg of chlorophyll a, \\(X_{cc}^{phy}\\)[WQParXcc], is used to present model outputs in units of \\(\\mu\\)/L chlorophyll a when necessary. "],["PhyRates-3.html", "Appendix J Processes: phyto biomass rates J.1 Primary productivity J.2 Respiration J.3 Exudation J.4 Settling", " Appendix J Processes: phyto biomass rates The rates that determine the temporal evolution of phytoplankton group biomass are primary productivity, respiration, exudation and settling. In general terms these processes can be thought of as follows: Primary productivity is the consumption of carbon and the generation of oxygen and carbohydrate due to photosynthesis. Photosynthetically active radiation catalyses this process so it occurs only durinig daylight hours Respiration is the consumption of oxygen and carbohydrate and the production of carbon. This can be thought of as the reverse of primary productivity. Respiration dominates phytoplankton dynamics during nighttime hours, although can still operate during the day Exudation (also referred to as photo exudation) is the loss of phytoplankton biomass as a result of primary productivity Settling is the physical settling of phytoplankton groups, including motility The general form of the phytoplankton flux relationship for any given computational cell is therefore given by Equation (J.1). \\[\\begin{equation} F^{phy} = \\text{Primary productivity} - f(\\text{Respiration, Exudation}) - \\text{Settling} \\tag{J.1} \\end{equation}\\] \\(f\\) represents functions described in Section M. The fundamental rates in Equation (J.1) are described following. J.1 Primary productivity The primary productivity rate is computed in a series of stages within the WQM, where the combination of these stages used for any given phytoplankton group depends on group configuration. These stages are described below. For clarity, supporting functions nested within primary productivity rate calculations (such as limitation functions) are initially presented in passing, but are cross referenced to detailed descriptions in subsequent sections. The rate of primary productivity (often referred to as just productivity or growth rate) of a phytoplankton group is a /day rate. It is computed initially within the WQM as per Equation (J.2). \\[\\begin{equation} R_{prod\\langle computed\\rangle}^{phy} = R_{prod}^{phy} \\times L_T^{phy} \\times \\text{min}\\left(L_{lght}^{phy},L_{nit}^{phy},L_{phs}^{phy},L_{sil}^{phy}\\right) \\tag{J.2} \\end{equation}\\] For each phytoplankton group, \\(R_{prod}^{phy}\\) is the user specified (or default) phytoplankton productivity (growth) rate at 20\\(^o\\)C with no light, temperature, salinty, silicate or nutrient limitation, and \\(L_T^{phy}\\), \\(L_{lght}^{phy}\\), \\(L_{nit}^{phy}\\), \\(L_{phs}^{phy}\\), \\(L_{sil}^{phy}\\) are the computed limitation functions for water temperature, light, nitrogen, phosphorus and silicate, respectively. These functions act to modify \\(R_{prod}^{phy}\\), noting that only \\(L_T^{phy}\\) always does so. The other limitation functions in Equation (J.2) act collectively, with only the most limiting (i.e. the smallest function value) of \\(L_{lght}^{phy}\\), \\(L_{nit}^{phy}\\), \\(L_{phs}^{phy}\\) and \\(L_{sil}^{phy}\\) being selected to also multiplicatively modify \\(R_{prod}^{phy}\\) with \\(L_T^{phy}\\). If nitrogen fixing is implemented, then the \\(R_{prod\\langle computed\\rangle}^{phy}\\) computed in Equation (J.2) is further modified as per Equation (J.3). \\[\\begin{equation} R_{prod\\langle computed\\rangle}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times \\left(L_{nit}^{phy} \\times \\left(1.0 - f_{nfix}^{phy}\\right)\\right) \\tag{J.3} \\end{equation}\\] \\(f_{nfix}^{phy}\\) is the user (or default) rate modifier that accounts for the metabolic cost of nitrogen fixing on primary productivity. This modifier can be thought of as a penalty function, with values of zero and one corresponding to no and maximum penalties, respectively. Because this rate modifier is applied to \\(R_{prod\\langle computed\\rangle}^{phy}\\) if a phytoplankton group is a nitrogen fixer, specification of a \\(f_{nfix}^{phy}\\) of one will set \\(R_{prod\\langle computed\\rangle}^{phy}\\) to zero: primary productivity will never occur. Conversely, if \\(f_{nfix}^{phy}\\) is set to 0, then no metabolic penalty is applied as result of implementing nitrogen fixing. Expectation is that the true penalty lies not at either zero or one, but at \\(0 \\lt f_{nfix}^{phy} \\lt 1\\). If salinity limitation is implemented, then the \\(R_{prod\\langle computed\\rangle}^{phy}\\) computed above is further modified as per Equation (J.4). \\[\\begin{equation} R_{prod\\langle computed\\rangle}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times L_{sal}^{phy} \\tag{J.4} \\end{equation}\\] \\(L^{phy}_{sal}\\) is the limitation function due to salinity. Once the rate of primary productivity has been computed by applying Equation (J.2), and potentially Equations (J.3) and (J.4), the corresponding flux of carbon (i.e. phytoplankton growth) to a phytoplankton group is computed as per Equation (J.5). \\[\\begin{equation} F_{prod-C}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times \\left[PHY\\right] \\tag{J.5} \\end{equation}\\] The WQM uses a minimum concentration \\(\\left[PHY\\right]_{min}\\) to maintain phytoplankton concentrations above zero. This is because if concentrations decrease to zero, then by Equation (J.5), phytoplankton fluxes (and therefore concentrations) will remain at zero regardless of computed primary productivity rates. J.2 Respiration The respiration rate is computed in a series of stages within the WQM, where the combination of these stages used for any given phytoplankton group depends on group configuration. These stages are described below. For clarity, supporting functions nested within respiration rate calculations (such as limitation functions) are initially presented in passing, but are cross referenced to detailed descriptions in subsequent sections. The rate of respiration of a phytoplankton group is a /day rate. It is computed initially within the WQM as per Equation (J.6). \\[\\begin{equation} R_{resp\\langle computed\\rangle}^{phy} = R_{resp}^{phy} \\times \\underbrace{\\left[\\theta_{resp}^{phy}\\right]^{\\left(T-20\\right)}}_{\\text{Influence of temperature}} \\tag{J.6} \\end{equation}\\] \\(R_{resp}^{phy}\\) is the user specified phytoplankton respiration rate at 20\\(^o\\)C, \\(\\theta_{resp}^{phy}\\) is the temperature coefficient for respiration, and \\(T\\) is ambient water temperature. Figure J.1: Move the slider to see the effect of changing temperature coefficient on the computed phytoplankton respiration rate If salinity limitation is implemented, and is one of the models XX, YY, ZZ, then the \\(R_{resp\\langle computed\\rangle}^{phy}\\) computed above is further modified as per Equation (J.7). , \\[\\begin{equation} R_{resp\\langle computed\\rangle}^{phy} = R_{resp\\langle computed\\rangle}^{phy} \\times L_{sal}^{phy} \\tag{J.7} \\end{equation}\\] \\(L^{phy}_{sal}\\) is the limitation function on respiration due to salinity. If a groups ambient phytoplankton concentration is less than the user defined (or default) minimum concentration \\(\\left[PHY\\right]_{min}\\), then respiration rate is set to zero. J.3 Exudation The exudation rate of a phytoplankton group is a /day rate. It is computed within the WQM as per Equation (J.8). \\[\\begin{equation} R_{exud\\langle computed\\rangle}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times f_{exud}^{phy} \\tag{J.8} \\end{equation}\\] \\(R_{prod\\langle computed\\rangle}^{phy}\\) is the previously computed phytoplankton primary production rate (Equations (J.2), and potentially (J.3) and (J.4)), and \\(f_{exud}^{phy}\\) is the user defined (or default) fraction of primary production lost to exudation. This exudation loss is a linear function. If a groups ambient phytoplankton concentration is less than the user defined (or default) minimum concentration \\(\\left[PHY\\right]_{min}\\), then the exudation rate is set to zero. J.4 Settling The settling rate \\(V_{sett}^{phy}\\) (also referred to as motility) of a phytoplankton group is computed within the WQM for each phytoplankton group, prior to the corresponding primary production, respiration and exudation rate calculations. There are several phytoplankton settling models available within the WQM. These are described following. J.4.1 None In this model, phytoplankton settling is set to zero, and phytoplankton are simply advected by the hydrodynamic flow field. J.4.2 Constant In this model, phytoplankton settling is set to a constant value, and phytoplankton are settled at this velocity. A negative specification of this quantity corresponds to a downwards settling velocity. J.4.3 Constant with density correction In this model, phytoplankton settling is set to a constant value, and phytoplankton are settled at this velocity, but corrected for ambient water density effects, as per Equation (J.9). \\[\\begin{equation} V_{sett\\langle computed\\rangle}^{phy} = V_{sett}^{phy} \\times \\frac{\\mu_{20}\\times\\rho_w}{\\mu\\times\\rho_{w20}} \\tag{J.9} \\end{equation}\\] \\(V_{sett}^{phy}\\) is the specified settling rate (velocity) at 20\\(^o\\)C, \\(\\mu\\) and \\(\\rho_w\\) are the ambient water dynamic viscosity (in Ns/m\\(^2\\)) and density (in kg/m\\(^3\\)), respectively, and \\(\\mu_{20}\\) and \\(\\rho_{w20}\\) are the dynamic viscosity and density of freshwater at 20\\(^o\\)C, respectively. A negative specification of \\(V_{sett}^{phy}\\) corresponds to a downwards settling velocity. J.4.4 Stokes In this model, phytoplankton settling is computed using the Stokes equation and cell diameter and density, as per Equation (J.10). \\[\\begin{equation} V_{sett\\langle computed\\rangle}^{phy} = -g \\times d_{phy}^2 \\times \\frac{\\left(\\rho_{phy}-\\rho_w\\right)}{18\\mu} \\tag{J.10} \\end{equation}\\] \\(g\\) is acceleration due to gravity, \\(d_{phy}\\) and \\(\\rho_{phy}\\) are phytoplankton cell diameter and density, respectively, and \\(\\rho_w\\) and \\(\\mu\\) are the ambient water density and dynamic viscosity, respectively. This model is only available if phytoplankton cell density is dynamically simulated. Cell density is therefore required to be simulated as a computed variable in both cases, with supporting initial and boundary condition specifications. Cell diameter is fixed at 1 \\(\\times\\) 10 \\(^{-5}\\) m. Even though a half saturation light intensity \\(I_K\\) is not required to compute the settling velocity directly, it is required to compute the cell density term in Equation (J.10). Cell density is computed as described in Section N.2. \\(I_K\\) can therefore be specified in the command to set stokes settling (referred to as \\(I_{K-sto}\\)(#WQParKstoSett)), if it is not already specified in a phytoplankton constituent model light limitation function. J.4.5 Motile The motility settling model can only be used if internal nutrients are simulated, via deployment of the advanced phytoplankton constituent model. In this model, phytoplankton are permitted to be motile, with the motility velocity being either a user specified value (and either upwards or downwards), or zero. This motility behaviour is governed by phytoplankton internal nutrient status and ambient environmental conditions, as follows: If \\(Q \\lt 0.675 \\times X_{N-C-max}^{phy}\\) then phytoplankton is starved of nutrients and swims downwards at a rate \\(V_{mot}^{phy}\\) If \\(Q \\gt 0.750 \\times X_{N-C-max}^{phy}\\) then phytoplankton is replete of nutrients and: If local photosynthetically available radiation is greater than \\(I_{K-mot}\\) then phytoplankton swim up at \\(V_{mot}^{phy}\\) If local photosynthetically available radiation is less than \\(I_{K-mot}\\) then phytoplankton are not motile If \\(0.675 \\times X_{N-C-max}^{phy} \\lt Q \\lt 0.750 \\times X_{N-C-max}^{phy}\\) then phytoplankton are not motile \\(V_{mot}^{phy}\\) is the user specified motility velocity where a negative value is treated as a downwards motility, \\(Q\\) is the instantaneous ratio of phytoplankton internal nitrogen to carbon computed by the WQM (N/C), \\(X_{N-C-max}^{phy}\\) is the maximum internal nitrogen to carbon concentration ratio either user specified (or default) in the advanced constituent model and \\(I_{K-mot}\\) is the half saturation constant for light limitation of growth. A value of \\(I_{K-mot}\\) specified in the settling model will be ignored if it has been specified in the light limitation model. Overriding all of the above is the condition that if local photosynthetically available radiation is greater than 95% of the water surface value, motility is set to zero as phytoplankton are considered to already be at the surface of the model domain. "],["PhyLimits-3.html", "Appendix K Processes: phyto limitation K.1 General K.2 Temperature K.3 Nitrogen K.4 Phosphorus K.5 Silicate K.6 Light K.7 Salinity", " Appendix K Processes: phyto limitation K.1 General Several functions are available within the WQM that allow for modification of computed phytoplankton rates in response to environmental conditions. These functions were mentioned in passing in previous sections and are called limitation functions and they describe how temperature, nitrogen, phosphorus, silicate, light and salinity potentially limit these phytoplankton rates. Their computed values are always dimensionless and between zero and one, and are applied multiplicatively to modify initially computed rates. Limitation functions of zero completely shut off initially computed rates, and conversely, limitation functions of one do not affect these rates whatsoever. Limitation functions that are valued between zero and one linearly affect computed rates as per Equation (J.2). The key principle of limitation functions is that they provide a quantitative comparison of phytoplanktonic rate requirements with ambient conditions, and then modify phytoplankton behaviour accordingly. For example, an initially computed \\(R_{prod\\langle computed\\rangle}^{phy}\\) may make a productivity demand on ambient nitrogen that exceeds instantaneous nitrogen availability. In this case, primary production will need to be reduced to reflect this nitrogen scarcity. This is affected via the multiplicative application to the initial primary productivity rate of a (computed) nitrogen limitation \\(L_{nit}^{phy}\\) that is less than one. A similar principle applies to temperaturem, phosphorus, silicate, light and salinity limitation functions: they modify computed phytoplanktonic rates based on a relative assessment of these rates to instantaneous ambient environmental conditions. There are multiple limitation functions available within the WQM for each of temperature, nitrogen, phosphorus, silicate, light and salinity. These are described below. K.2 Temperature Temperature limitation is often considered a key influencer of phytoplankton dynamics. The WQM offers the following temperature limitation functions. K.2.1 None This model includes no temperature limitation to the computed primary productivity rate. The temperature limitation is set to 1.0 for all temperatures. K.2.2 Standard This is a generic yet customisable temperature limitation function. It comprises three piecewise continuous sub functions: \\[\\begin{equation} L_{T}^{phy} = \\begin{cases} \\left[\\theta_{prod}^{phy}\\right]^{\\left(T-20\\right)} &amp; \\text{$T \\le T_{std}^{phy}$} \\\\ \\\\ f(T_{opt}^{phy},T_{std}^{phy},T_{max}^{phy}) &amp; \\text{$T_{std}^{phy} \\lt T \\le T_{max}^{phy}$} \\\\ \\\\ 0 &amp; \\text{$T_{max}^{phy} \\lt T$} \\end{cases} \\tag{K.1} \\end{equation}\\] \\(\\theta_{prod}^{phy}\\) is the temperature coefficient for primary productivity, \\(f\\) is a sub function of \\(T_{opt}^{phy}\\), \\(T_{std}^{phy}\\) and \\(T_{max}^{phy}\\), which are the optimal, standard and maximum water temperatures respectively, and \\(T\\) is ambient water temperature. The function \\(f\\) comprises a two stage algorithm: Stage 1. Preprocess \\(T_{opt}^{phy}\\), \\(T_{std}^{phy}\\) and \\(T_{max}^{phy}\\) in a once-off iterative calculation to generate a secondary suite of parameters that are then used in Stage 2 computations Stage 2. Use ambient environmental conditions, \\(\\theta_{prod}^{phy}\\), \\(T_{std}^{phy}\\) and the parameters generated in Stage 1 to compute the temperature limitation function at every water quality timestep and computational cell throughout a simulation Stage 1 The intent of Stage 1 is to use \\(T_{opt}^{phy}\\), \\(T_{std}^{phy}\\) and \\(T_{max}^{phy}\\) to iteratively compute three parameters \\(aTn\\), \\(bTn\\) and \\(kTn\\) that describe a curve fitting of \\(L_{T}^{phy}\\) between \\(T_{std}^{phy}\\) and \\(T_{max}^{phy}\\) (i.e. function \\(f\\) in Equation (K.1)). The conditions for this curve fitting ensure that \\(L_{T}^{phy}\\) is piecewise continuous: \\[\\begin{equation} L_{T}^{phy} = \\begin{cases} \\left[\\theta_{prod}^{phy}\\right]^{\\left(T-20\\right)} &amp; \\text{$T = T_{std}^{phy}$} \\\\ \\\\ 0 &amp; \\text{$T = T_{max}^{phy}$} \\end{cases} \\tag{K.2} \\end{equation}\\] To do so, the WQM uses Equation (K.3) to compute the intermediate quantity \\(G\\) by iterating on \\(kTn\\), with the \\(kTn\\) seed set to 6.0. \\[\\begin{equation} \\left.\\begin{aligned} G = &amp;\\left(kTn \\times \\left[\\theta_{prod}^{phy}\\right]^{\\left(kTn \\times T_{opt}^{phy}\\right)} \\times \\left[\\theta_{prod}^{phy}\\right]^{\\left(T_{max}^{phy} - 20.0 \\right)}\\right) - \\ldots \\\\ \\\\ &amp;\\left(\\left[\\theta_{prod}^{phy}\\right]^{\\left(T_{opt}^{phy} - 20.0 \\right)} \\times \\left( \\left[\\theta_{prod}^{phy}\\right]^{\\left(kTn \\times T_{max}^{phy}\\right)} - \\left[\\theta_{prod}^{phy}\\right]^{\\left(kTn \\times T_{std}^{phy}\\right)} \\right)\\right) \\end{aligned}\\right\\} \\tag{K.3} \\end{equation}\\] The iteration target is \\(|G| \\le 0.5\\). If this target is not met on a given iteration, a new value of \\(kTn\\) is computed as per Equation (K.4). \\[\\begin{equation} kTn = kTn - \\frac{G}{\\nabla G} \\tag{K.4} \\end{equation}\\] \\(\\nabla G\\) is computed as per Equation (K.5). \\[\\begin{equation} \\left.\\begin{aligned} \\nabla G =&amp; \\left(\\left(\\left[\\theta_{prod}^{phy}\\right]^{\\left(kTn \\times T_{opt}^{phy}\\right)} \\times \\left[\\theta_{prod}^{phy}\\right]^{\\left(T_{max}^{phy} - 20.0 \\right)}\\right) \\times \\left(1.0 + kTn \\times T_{opt}^{phy} \\times ln\\left(\\theta_{prod}^{phy}\\right)\\right)\\right) - \\ldots \\\\ \\\\ &amp;\\left(\\left[\\theta_{prod}^{phy}\\right]^{\\left(T_{opt}^{phy} - 20.0 \\right)} \\times ln\\left(\\theta_{T}^{hy}\\right) \\times \\left(T_{max}^{phy} \\times \\left[\\theta_{prod}^{phy}\\right]^{\\left(kTn \\times T_{max}^{phy}\\right)} - T_{std}^{phy} \\times \\left[\\theta_{prod}^{phy}\\right]^{\\left(kTn \\times T_{std}^{phy}\\right)}\\right)\\right) \\end{aligned}\\right\\} \\tag{K.5} \\end{equation}\\] Once the iteration target is met (i.e. \\(|G| \\le 0.5\\)), the final value of \\(kTn\\) is used to compute \\(aTn\\) and \\(bTn\\) as per Equation (K.6). \\[\\begin{equation} \\left.\\begin{aligned} aTn &amp;= \\frac{-ln\\left(\\frac{\\left[\\theta_{prod}^{phy}\\right]^{\\left(T_{opt}^{phy}-20\\right)}}{kTn \\times \\left[\\theta_{prod}^{phy}\\right]^{\\left(kTn \\times T_{opt}^{phy}\\right)}}\\right)}{kTn \\times ln\\left(\\theta_{prod}^{phy}\\right)} \\\\ \\\\ bTn &amp;= \\left[\\theta_{prod}^{phy}\\right]^{kTn \\times \\left(T_{std}^{phy}-aTn\\right)} \\end{aligned}\\right\\} \\tag{K.6} \\end{equation}\\] All of \\(aTn\\), \\(bTn\\) and \\(kTn\\) are fixed at the end of Stage 1 for repeated use in Stage 2. and used in Stage 2 at every timestep and model cell to compute \\(L_{T}^{phy}\\) in the water temperature range between \\(T_{std}^{phy}\\) and \\(T_{max}^{phy}\\). Stage 2 The intent of Stage 2 is to use \\(aTn\\), \\(bTn\\) and \\(kTn\\) to describe a curve for \\(L_{T}^{phy}\\) between \\(T_{std}^{phy}\\) and \\(T_{max}^{phy}\\). This curve is computed as per Equation (K.7). \\[\\begin{equation} L_{T}^{phy} = \\left[\\theta_{prod}^{phy}\\right]^{\\left(T-20\\right)} - \\left[\\theta_{prod}^{phy}\\right]^{kTn \\times \\left(T-aTn\\right)} + bTn \\tag{K.7} \\end{equation}\\] The complete piecewise continuous function for the generic temperature limitation function \\(L_T^{phy}\\) is provided in Equation (K.8). \\[\\begin{equation} L_{T}^{phy} = \\begin{cases} \\left[\\theta_{prod}^{phy}\\right]^{\\left(T-20\\right)} &amp; \\text{$T \\le T_{std}^{phy}$} \\\\ \\\\ \\left[\\theta_{prod}^{phy}\\right]^{\\left(T-20\\right)} - \\left[\\theta_{prod}^{phy}\\right]^{kTn \\times \\left(T-aTn\\right)} + bTn &amp; \\text{$T_{std}^{phy} \\lt T \\le T_{max}^{phy}$} \\\\ \\\\ 0 &amp; \\text{$T_{max}^{phy} \\lt T$} \\end{cases} \\tag{K.8} \\end{equation}\\] The form of \\(L_{T}^{phy}\\) with varying \\(T\\) depends on three user specified (or default) temperatures and their derived quantities \\(aTn\\), \\(bTn\\) and \\(kTn\\). As such, the following two figures present \\(L_{T}^{phy}\\) varying with \\(T\\) and at constant \\(T_{max}^{phy}\\) = 25\\(^o\\)C, with the following conditions: Figure K.1: Line 1: \\(T_{std}^{phy}\\) held constant at 10\\(^o\\)C, with the slider varying \\(T_{opt}^{phy}\\) Line 2: \\(T_{std}^{phy}\\) held constant at 18\\(^o\\)C, with the slider varying \\(T_{opt}^{phy}\\) Figure K.2: Line 1: \\(T_{opt}^{phy}\\) held constant at 10\\(^o\\)C, with the slider varying \\(T_{std}^{phy}\\) Line 2: \\(T_{opt}^{phy}\\) held constant at 18\\(^o\\)C, with the slider varying \\(T_{std}^{phy}\\) Figure K.1: Move the slider to see the effect of changing \\(T_{opt}^{phy}\\) on the computed temperature limitation function Figure K.2: Move the slider to see the effect of changing \\(T_{std}^{phy}\\) on the computed temperature limitation function K.3 Nitrogen Nitrogen offers two limitation functions, one for each of the basic and advanced phytoplankton constituent models. These are described separately following. If nitrogen fixing is implemented for a particular phytoplankton group, then the calculations following are not implemented and \\(L_{nit}^{phy}\\) is set to one. K.3.1 Basic phytoplankton constituent model If internal phytoplankton nutrients are not simulated dynamically, Equation (K.9) is used to compute \\(L_{nit}^{phy}\\). \\[\\begin{equation} L_{nit}^{phy} = \\frac{\\left(\\left[N\\right]_{avail} - \\left[N\\right]_{min}\\right)}{\\left(\\left[N\\right]_{avail} - \\left[N\\right]_{min}\\right) + K_{lim-N}^{phy}} \\tag{K.9} \\end{equation}\\] \\(\\left[N\\right]_{avail}\\) is the available nitrogen pool on which phytoplankton can draw for primary productivity, and is the sum of inorganic (ammonium and nitrate) nitrogen. \\(\\left[N\\right]_{min}^{phy}\\) is the nitrogen concentration below which phytoplankton is no longer permitted to uptake nitrogen. \\(K_{lim-N}^{phy}\\) is the half saturation nitrogen concentration for phytoplankton uptake. All these parameters are considered by the WQM to be combined quantities, i.e. they are not specific to any particular nitrogen species, but rather, to nitrogen-N concentrations across all species uptaken. In the case of the basic phytoplankton constituent model, this is simply the sum of ammonium-N and nitrate-N concentrations. See discussion is Section 4.2. Organic nitrogen is not taken up by phytoplankton, regardless of whether the organics simulation class is activated. Equation (K.9) has that when \\(K_{lim-N}^{phy}\\) is equal to the difference between ambient nitrogen concentration and \\(\\left[N\\right]_{min}\\), i.e. when \\[\\begin{equation} K_{lim-N}^{phy} = \\left[N\\right]_{avail} - \\left[N\\right]_{min} \\tag{K.10} \\end{equation}\\] then \\(L_{nit}^{phy}\\) = 0.5. The form of \\(L_{nit}^{phy}\\) with varying \\(\\left[N\\right]_{min}\\) and \\(K_{lim-N}^{phy}\\) is provided in Figure K.3, for constant \\(\\left[N\\right]_{avail}\\) = 1.0 mg/L. Figure K.3: Move the slider to see the effect of changing \\(K_{lim-N}^{phy}\\) on the computed nitrogen limitation function The parameter \\(K_{lim-N}^{phy}\\) is the same as that specified in the computation of the the fraction of ammonium that is taken up with primary production (Section L.2.1) in the basic phytoplankton constituent model (Equation (L.3)). As such its setting should be considered in terms of its impacts on both nitrogen limitation and uptake processes. K.3.2 Advanced phytoplankton constituent model If internal phytoplankton nutrients are simulated dynamically, and phytoplankton concentrations are greater than the specified (or default) minimum, then Equation (K.11) is used to compute \\(L_{nit}^{phy}\\). \\[\\begin{equation} L_{nit}^{phy} = \\frac{X_{N-C-max}^{phy} \\times \\left(1.0 - \\frac{X_{N-C-min}^{phy} \\times \\left[PHY\\right] }{\\left[N\\right]_{in}}\\right)}{X_{N-C-max}^{phy} - X_{N-C-min}^{phy}} \\tag{K.11} \\end{equation}\\] \\(X_{N-C-min}^{phy}\\) and \\(X_{N-C-max}^{phy}\\) are the specified (or default) minimum and maximum internal nitrogen to Chl a (or carbon if using mmm units) ratios, respectively and \\(\\left[PHY\\right]\\) and \\(\\left[N\\right]_{in}\\) are the current internal Chl a (or carbon) and nitrogen concentrations in the computational cell being considered, respectively. Substituting the definition for the minimum nitrogen to Chl a (or carbon) ratio \\(X_{N-C-min}^{phy}=\\left[N\\right]_{min}/\\left[PHY\\right]\\) (where \\(\\left[PHY\\right]\\) is in either mgl or mmm units) into Equation (K.11) and rearranging, reveals the form of \\(L_{nit}^{phy}\\) as per Equation (K.12). \\[\\begin{equation} L_{nit}^{phy} = \\frac{X_{N-C-max}^{phy} \\times \\left(1.0 - \\frac{\\left[N\\right]_{min}} {\\left[N\\right]_{in}}\\right)}{X_{N-C-max}^{phy} - X_{N-C-min}^{phy}} \\tag{K.12} \\end{equation}\\] \\(\\left[N\\right]_{min}\\) is the minimum internal nitrogen concentation corresponding to the current \\(\\left[PHY\\right]\\). Equation (K.12) demonstrates that: If an internal nitrogen concentration is equal to \\(\\left[N\\right]_{min}\\), then \\(L_{nit}^{phy}\\) is zero. This means that no internal nitrogen is available for primary production in the current timestep and that nitrogen is therefore completely preventing growth If an internal nitrogen concentration is equal to \\(\\left[N\\right]_{max}\\), then \\(L_{nit}^{phy}\\) is one. This means that maximum internal nitrogen is available for primary production in the current timestep and that nitrogen is therefore placing no limit on growth If internal phytoplankton nutrients are simulated dynamically, and phytoplankton concentration is less than the specified (or default) minimum, then phytoplankton will look to external nitrogen pools to support primary productivity. The associated limitation function is therefore computed in the same manner as Equation (K.9) in Section K.3.1. If this is the case, then the parameters \\(K_{lim-N}^{phy}\\) and \\(\\left[N\\right]_{min}^{phy}\\) are used. This same parameter is also used in the computation of the nitrogen that is taken up with primary production (Section L.2.2) in the advanced phytoplankton constituent model (Equation (L.4)). As such its setting should be considered in terms of its impacts on both nitrogen limitation and uptake processes in the advanced phytoplankton constituent model. K.4 Phosphorus Phosphorus offers two limitation functions, one for each of the basic and advanced phytoplankton constituent models. These are described separately following. K.4.1 Basic phytoplankton constituent model If internal phytoplankton nutrients are not dynamically simulated, Equation (K.13) is used to compute \\(L_{phs}^{phy}\\). \\[\\begin{equation} L_{phs}^{phy} = \\frac{\\left(\\left[P\\right]_{avail} - \\left[P\\right]_{min}\\right)}{\\left(\\left[P\\right]_{avail} - \\left[P\\right]_{min}\\right) + K_{lim-P}^{phy}} \\tag{K.13} \\end{equation}\\] \\(\\left[P\\right]_{avail}\\) is the available phosphorus pool on which phytoplankton can draw for primary productivity, and is simply FRP. \\(\\left[P\\right]_{min}\\) is the phosphorus concentration below which phytoplankton no longer is permitted to uptake phosphorus \\(K_{lim-P}^{phy}\\) is the half saturation phosphorus concentration for phytoplankton uptake. Equation (K.13) has that when \\(K_{lim-P}^{phy}\\) is equal to the difference between ambient phosphorus concentration and \\(\\left[P\\right]_{min}\\), i.e. when \\[\\begin{equation} K_{lim-P}^{phy} = \\left[P\\right]_{avail} - \\left[P\\right]_{min} \\tag{K.14} \\end{equation}\\] then \\(L_{phs}^{phy}\\) = 0.5. The form of \\(L_{phs}^{phy}\\) with varying \\(\\left[P\\right]_{min}\\) and \\(K_{lim-P}^{phy}\\) is provided in Figure K.4, for constant \\(\\left[P\\right]_{avail}\\) = 1.0 mg/L. Figure K.4: Move the slider to see the effect of changing \\(K_{lim-P}^{phy}\\) on the computed phosphorus limitation function K.4.2 Advanced phytoplankton constituent model If internal phytoplankton nutrients are simulated dynamically, and phytoplankton concentrations are greater than the specified (or default) minimum, then Equation (K.15) is used to compute \\(L_{phs}^{phy}\\). \\[\\begin{equation} L_{phs}^{phy} = \\frac{X_{P-C-max}^{phy} \\times \\left(1.0 - \\frac{X_{P-C-min}^{phy} \\times \\left[PHY\\right] }{\\left[P\\right]_{in}}\\right)}{X_{P-C-max}^{phy} - X_{P-C-min}^{phy}} \\tag{K.15} \\end{equation}\\] \\(X_{P-C-min}^{phy}\\) and [\\(X_{P-C-max}^{phy}\\)(#WQParMaxPClim) are the specified (or default) minimum and maximum internal phosphorus to Chl a (or carbon if using mmm units) ratios, respectively and \\(\\left[PHY\\right]\\) and \\(\\left[P\\right]_{in}\\) are the current internal Chla a (or carbon) and phosphorus concentrations in the computational cell being considered, respectively. Substituting the definition for the minimum phosphorus to Chl a (or carbon) ratio \\(X_{P-C-min}^{phy}=\\left[P\\right]_{min}/\\left[PHY\\right]\\) (where \\(\\left[PHY\\right]\\) is in either mgl or mmm units) into Equation (K.15) and rearranging, reveals the form of \\(L_{phs}^{phy}\\) as per Equation (K.16). \\[\\begin{equation} L_{phs}^{phy} = \\frac{X_{P-C-max}^{phy} \\times \\left(1.0 - \\frac{\\left[P\\right]_{min}} {\\left[P\\right]_{in}}\\right)}{X_{P-C-max}^{phy} - X_{P-C-min}^{phy}} \\tag{K.16} \\end{equation}\\] \\(\\left[P\\right]_{min}\\) is the minimum internal phosphorus concentation corresponding to the current \\(\\left[PHY\\right]\\). Equation (K.16) demonstrates that: If an internal phosphorus concentration is equal to \\(\\left[P\\right]_{min}\\), then \\(L_{phs}^{phy}\\) is zero. This means that no internal phosphorus is available for primary production in the current timestep and that phosphorus is therefore completely preventing growth If an internal phosphorus concentration is equal to \\(\\left[P\\right]_{max}\\), then \\(L_{phs}^{phy}\\) is one. This means that maximum internal phosphorus is available for primary production in the current timestep and that phosphorus is therefore placing no limit on growth If internal phytoplankton nutrients are simulated dynamically, and phytoplankton concentrations are less than the specified (or default) minimum, then phytoplankton will look to external phosphorus pools to support primary productivity. The associated limitation function is therefore computed in the same manner as Equation (K.13) in Section K.4.1. If this is the case, then the parameters \\(K_{lim-P}^{phy}\\) and \\(\\left[P\\right]_{min}^{phy}\\) are used. This same parameter is also used in the computation of the phosphorus that is taken up with primary production (Section L.3.2) in the advanced phytoplankton constituent model (Equation (L.8)). As such its setting should be considered in terms of its impacts on both phosphorus limitation and uptake processes in the advanced phytoplankton constituent model. K.5 Silicate Equation (K.17) is used to compute \\(L_{sil}^{phy}\\), if phytoplankton is configured to take up silicate. Specifying silicate limitation parameters will trigger the WQM to take up silicate (Section 4.7.3.5.1.6). \\[\\begin{equation} L_{sil}^{phy} = \\frac{\\left(\\left[Si\\right]_{avail} - \\left[Si\\right]_{min}\\right)}{\\left(\\left[Si\\right]_{avail} - \\left[Si\\right]_{min}\\right) + K_{lim-Si}^{phy}} \\tag{K.17} \\end{equation}\\] \\(\\left[Si\\right]_{avail}\\) is the available silicate pool on which phytoplankton can draw for growth. \\(\\left[Si\\right]_{min}\\) is the silicate concentration below which phytoplankton no longer is permitted to uptake silicate and \\(K_{lim-Si}^{phy}\\) is the half saturation silicate concentration for phytoplankton uptake. \\(K_{lim-Si}^{phy}\\) is specified as a silicate concentration. When this concentration is equal to the difference between the relevant ambient concentration and \\(\\left[Si\\right]_{min}\\), i.e. when \\[\\begin{equation} K_{lim-Si}^{phy} = \\left[Si\\right]_{avail} - \\left[Si\\right]_{min} \\tag{K.18} \\end{equation}\\] then \\(L_{sil}^{phy}\\) = 0.5. The form of \\(L_{sil}^{phy}\\) with varying \\(\\left[Si\\right]_{min}\\) and \\(K_{lim-Si}^{phy}\\) is provided in Figure K.5, for constant \\(\\left[Si\\right]_{avail}\\) = 1.0 mg/L. Figure K.5: Move the slider to see the effect of changing \\(K_{lim-Si}^{phy}\\) on the computed silicate limitation function K.6 Light Phytoplankton require photosynthetically active radiation (PAR) in order to affect primary productivity. The required PAR may not always be available due to a range of environmental factors and as such may limit phytoplankton growth. In addition, some phytoplankton groups may suffer photoinhibition, which is a reduction in the ability to photosynthesise as a result of damage incurred by greater levels of radiation. This is also referred to as light-induced damage, and in general terms means that increasing light intensity experienced by a phytoplankton group does not translate into a monotonic increase in the light limitation function: primary productivity can decrease with increasing available light where photoinhibition occurs. A saturating light intensity \\(I_S\\) is specified for those models that include photoinhibition (rather then a half saturation light for limitation \\(I_K\\) specified for models that exclude photoinhibition) and \\(I_S\\) can be interpreted as the light intensity at which the limitation function has its peak, usually at a value of 1.0. Either side of this \\(I_S\\) light intensity, the limitation function decreases toward zero. The WQM offers a number of different models that deploy combinations of these processes to estimate phytoplankton light limitation functions. These are described following. K.6.1 Basic This model includes phytoplankton light limitation but with no photoinhibition, as per Webb (1974). Limitation is therefore purely due to insufficient light availability. The limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (K.19). \\[\\begin{equation} L_{lght}^{phy} = 1.0 - \\left[ \\int_{\\frac{-PAR_b}{I_{K-bas}}}^{\\infty} \\! \\left( \\frac{e^{-t}}{t} \\right)\\, \\mathrm{d}t - \\int_{\\frac{-PAR_t}{I_{K-bas}}}^{\\infty} \\! \\left( \\frac{e^{-t}}{t} \\right)\\, \\mathrm{d}t\\right] \\times \\left[ \\vphantom{\\int_{\\frac{-PAR_b}{I_{K-bas}}}^{\\infty} \\! \\left( \\frac{e^{-t}}{t} \\right)\\, \\mathrm{d}t} \\frac{1}{\\text{max}(k_{bio}\\times dz,1e-03)}\\right] \\tag{K.19} \\end{equation}\\] \\(PAR_b\\) and \\(PAR_t\\) are photosynthetically available radiation at the bottom and top faces of a model cell, respectively, \\(I_{K-bas}\\) is the half saturation constant for light limitation of growth, \\(\\text{k}_\\text{bio}\\) is the local change in light extinction coefficient due to self shading and \\(dz\\) is cell vertical thickness. K.6.2 Monod This model includes phytoplankton light limitation but with no photoinhibition, as per Monod (1950). Limitation is therefore purely due to insufficient light availability. The limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (K.20). \\[\\begin{equation} L_{lght}^{phy} = \\frac{\\frac{PAR_c}{I_{K-mon}}}{1 + \\frac{PAR_c}{I_{K-mon}}} \\tag{K.20} \\end{equation}\\] \\(PAR_c\\) is the photosynthetically available radiation at the centre of a model cell and \\(I_{K-mon}\\) is the half saturation constant for light limitation of growth. Equation (K.20) has that when \\(PAR_c\\) is equal to \\(I_{K-mon}\\), \\(L_{lght}^{phy}\\) = 0.5. K.6.3 Steele This model includes phytoplankton light limitation with photoinhibition, as per Steele (1962). The limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (K.21). \\[\\begin{equation} L_{lght}^{phy} = \\frac{PAR_c}{I_{S-ste}} \\times e^{\\left(1.0 - \\frac{PAR_c}{I_{S-ste}}\\right)} \\tag{K.21} \\end{equation}\\] \\(PAR_c\\) is the photosynthetically available radiation at the centre of a model cell and \\(I_{S-ste}\\) is the saturating light intensity. Equation (K.21) has that when \\(PAR_c\\) is equal to \\(I_{S-ste}\\), \\(L_{lght}^{phy}\\) = 1.0, i.e., the light intensity at which no light limitation or photoinhibition occurs. The form of Equation (K.21) is presented in Figure K.6, with the abscissa spanning a typical range of instantaneous photosynthetically available radiation. Figure K.6: Move the slider to see the effect of changing \\(I_S\\) on the computed light limitation function K.6.4 Webb This model includes phytoplankton light limitation with no photoinhibition, as per Webb (1974). The limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (K.22). \\[\\begin{equation} L_{lght}^{phy} = 1.0 - e^{-\\left(\\frac{PAR_c}{I_{K-web}}\\right)} \\tag{K.22} \\end{equation}\\] \\(PAR_c\\) is the photosynthetically available radiation at the centre of a model cell and \\(I_{K-web}\\) is the half saturation constant for light limitation of growth. The form of Equation (K.22) is presented in Figure K.7, with the abscissa spanning a typical range of instantaneous photosynthetically available radiation. Figure K.7: Move the slider to see the effect of changing \\(I_K\\) on the computed light limitation function K.6.5 Jassby This model includes phytoplankton light limitation with no photoinhibition, as per Jassby and Platt (1976). The limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (K.23). \\[\\begin{equation} L_{lght}^{phy} = tanh\\left(\\frac{PAR_c}{I_{K-jas}}\\right) \\tag{K.23} \\end{equation}\\] \\(PAR_c\\) is the photosynthetically available radiation at the centre of a model cell and \\(I_{K-jas}\\) is the half saturation constant for light limitation of growth. The form of Equation (K.23) is presented in Figure K.8, with the abscissa spanning a typical range of instantaneous photosynthetically available radiation. Figure K.8: Move the slider to see the effect of changing \\(I_K\\) on the computed light limitation function K.6.6 Chalker This model includes phytoplankton light limitation with no photoinhibition, as per Chalker (1980). The limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (K.24). \\[\\begin{equation} L_{lght}^{phy} = \\frac{e^{1.5\\left(\\frac{PAR_c}{I_{K-cha}}\\right)}-1.0}{e^{1.5\\left(\\frac{PAR_c}{I_{K-cha}}\\right)}+0.5} \\tag{K.24} \\end{equation}\\] \\(PAR_c\\) is the photosynthetically available radiation at the centre of a model cell and \\(I_{K-cha}\\) is the half saturation constant for light limitation of growth. The form of Equation (K.24) is presented in Figure K.9, with the abscissa spanning a typical range of instantaneous photosynthetically available radiation. Figure K.9: Move the slider to see the effect of changing \\(I_K\\) on the computed light limitation function K.6.7 Klepper This model includes phytoplankton light limitation with photoinhibition, as per Klepper et al. (1988) and Ebenhoh et al. (1997). The limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (K.25). \\[\\begin{equation} L_{lght}^{phy} = \\frac{7.0\\times\\left(\\frac{PAR_c}{I_{S-kle}}\\right)}{1.0 + 5.0\\times\\left(\\frac{PAR_c}{I_{S-kle}}\\right) + \\left(\\frac{PAR_c}{I_{S-kle}}\\right)^2} \\tag{K.25} \\end{equation}\\] \\(PAR_c\\) is the photosynthetically available radiation at the centre of a model cell and \\(I_{S-kle}\\) is the saturating light intensity. The form of Equation (K.25) is presented in Figure K.10, with the abscissa spanning a typical range of instantaneous photosynthetically available radiation. Figure K.10: Move the slider to see the effect of changing \\(I_S\\) on the computed light limitation function K.6.8 Integrated This model includes phytoplankton light limitation with photoinhibition, and is the integrated form of the Steele (1962) model provided in Equation (K.21). In this form, the limitation function \\(L_{lght}^{phy}\\) is computed within a model cell as per Equation (K.26). \\[\\begin{equation} L_{lght}^{phy} = \\frac{e^{\\left(1.0 - \\frac{PAR_b}{I_{S-int}}\\right)} - e^{\\left(1.0 - \\frac{PAR_t}{I_{S-int}}\\right)}}{\\text{k}_\\text{bio} \\times dz} \\tag{K.26} \\end{equation}\\] \\(PAR_b\\) and \\(PAR_t\\) are photosynthetically available radiation at the bottom and top faces of a model cell, respectively, \\(I_{S-int}\\) is the saturating light intensity, \\(\\text{k}_\\text{bio}\\) is the local change in light extinction coefficient due to self shading and \\(dz\\) is cell vertical thickness. K.7 Salinity Phytoplankton can exhibit sensitivity to salinity. The WQM captures these sensitivities via multiplicative application of a salinity limitation function to relevant rates (Equation (J.4) and Equation (J.7)). One way to conceptualise this is as follows: A salinity limitation value less than one applied to phytoplankton primary productivity at a particular salinity will result in a reduction in primary productivity. Corresponding respiration rates will remain unaffected by salinity and therefore by Equation (J.1), phytoplankton biomass should be expected to decrease as a result A salinity limitation value less than one applied to phytoplankton respiration at a particular salinity will result in a reduction in respiration. Corresponding primary productivity rates will remain unaffected by salinity and therefore by Equation (J.1), phytoplankton biomass should be expected to increase as a result, noting however that exudation (which is another loss term) will continue and is related to primary productivity. The salinity limitation models available within the WQM are described following. K.7.1 None This model includes no salinity limitation to either of the computed primary productivity or respiration rates. The salinity limitation set to 1.0 for all salinities. K.7.2 Freshwater This model is typically used for phytoplankton groups that have a preference for fresh waters. As such, the salinity limitation is set to 1.0 for all salinities greater than zero and up to a specified (or default) optimal salinity. Above this optimal salinity, the limitation function decreases from 1.0 to a specified (or default) limitation function value at a specified (or default) maximum salinity. For salinities greater than optimal, the limitation function \\(L_{sal}^{phy}\\) is computed within a model cell as per Equation (K.27). \\[\\begin{equation} \\left.\\begin{aligned} L_{sal}^{phy} =&amp; \\left(\\frac{\\left(L^{phy}_{max-fresh}-1.0\\right)\\times S^2 - \\left(\\left(L^{phy}_{max-fresh}-1.0\\right) \\times 2.0 \\times S_{opt-fresh}^{phy}\\right)\\times S}{\\left(S_{max-fresh}^{phy} - S_{opt-fresh}^{phy}\\right)^2}\\right) + \\ldots \\\\ \\\\ &amp; \\ldots \\left(\\frac{\\left(\\left(L^{phy}_{max-fresh}-1.0\\right) \\times \\left(S_{opt-fresh}^{phy}\\right)^2\\right)}{\\left(S_{max-fresh}^{phy} - S_{opt-fresh}^{phy}\\right)^2}\\right) + 1.0 \\end{aligned}\\right\\} \\tag{K.27} \\end{equation}\\] \\(S_{opt-fresh}^{phy}\\) and \\(S_{max-fresh}^{phy}\\) are the optimal and maximum salinities respectively, \\(L^{phy}_{max-fresh}\\) is the value of the salinity limitation function at \\(S_{max-fresh}^{phy}\\) and \\(S\\) is ambient salinity. The intention of applying this salinity limitation function is that it be used to set \\(L^{phy}_{max-fresh}\\) as zero at the salinity above which a phytoplankton group is known to be entirely inhibited by salinity. For example, if a particular phytoplankton group was known to feel the effects of salinity above a salinity of 5 g/L, and to entirely cease functioning at salinities greater than 10 g/L, then the following would be set by the user: \\(S_{opt-fresh}^{phy}\\) = 5.0 g/L \\(S_{max-fresh}^{phy}\\) = 10.0 g/L, and \\(L^{phy}_{max-fresh}\\) = 0.0 Using these values but varying \\(S_{max-fresh}^{phy}\\), the form of Equation (K.27) is presented in Figure K.11. Figure K.11: Move the slider to see the effect of changing \\(S_{max-fresh}^{phy}\\) on the computed salinity limitation function. \\(S_{opt-fresh}^{phy}\\) = 5.0 g/L and \\(L^{phy}_{max-fresh}\\) = 0.0 and are fixed K.7.3 Marine This model is typically used for phytoplankton groups that have a preference for marine waters. As such, the salinity limitation is set to 1.0 for all salinities greater than a specified (or default) optimal salinity. Below this optimal salinity, the limitation function decreases from 1.0 to a specified (or default) limitation function value at zero salinity. For salinities less than optimal, the limitation function \\(L_{sal}^{phy}\\) is computed within a model cell as per Equation (K.28). \\[\\begin{equation} L_{sal}^{phy} = \\left(\\frac{\\left(L^{phy}_{zero}-1.0\\right)\\times S^2}{\\left(S_{opt-marine}^{phy}\\right)^2}\\right) - \\left(2.0 \\times \\frac{\\left(L^{phy}_{zero}-1.0\\right)\\times S}{\\left(S_{opt-marine}^{phy}\\right)}\\right) + L^{phy}_{zero} \\tag{K.28} \\end{equation}\\] \\(S_{opt-marine}^{phy}\\) is the optimal salinity , \\(L^{phy}_{zero}\\) is the value of the salinity limitation function at zero salinity and \\(S\\) is ambient salinity. The intention of applying this limitation function is that it be used to set \\(L^{phy}_{zero}\\) equal to zero at zero salinity, and to set \\(S_{opt-marine}^{phy}\\) as the point below which a phytoplankton group begins to be salinity inhibited. For example, if a particular phytoplankton group was known to begin being inhibited below a salinity of 20 g/L, then the following would be set by the user: \\(S_{opt-marine}^{phy}\\) = 20.0 g/L \\(L^{phy}_{zero}\\) = 0.0 Using these values but varying \\(S_{opt-marine}^{phy}\\), the form of Equation (K.28) is presented in Figure K.12. Figure K.12: Move the slider to see the effect of changing \\(S_{opt-marine}^{phy}\\) on the computed salinity limitation function. \\(L^{phy}_{zero}\\) = 0.0 and is fixed K.7.4 Mixed This model is typically used for phytoplankton groups that have a preference for mid range salinity waters. As such, the salinity limitation is set to 1.0 between specified (or default) optimal and maximum salinities, with the function decreasing either side of these salinities to a specified (or default) value at zero, and the sum of optimal and maximum salinities. The limitation function \\(L_{sal}^{phy}\\) is computed within a model cell as per Equation (K.29). \\[\\begin{equation} L_{sal}^{phy} = \\begin{cases} \\left(\\frac{\\left(L^{phy}_{zero-mix}-1.0\\right)\\times S^2}{\\left(S_{opt-mix}^{phy}\\right)^2}\\right) - \\left(2.0 \\times \\frac{\\left(L^{phy}_{zero-mix}-1.0\\right)\\times S}{\\left(S_{opt-mix}^{phy}\\right)}\\right) + L^{phy}_{zero-mix} &amp; \\text{$S \\le S_{opt-mix}^{phy}$} \\\\ \\\\ 1.0 &amp; \\text{$S_{opt-mix}^{phy} \\lt S \\le S_{max-mix}^{phy}$} \\\\ \\\\ \\left(\\frac{\\left(L^{phy}_{zero-mix}-1.0\\right)\\times \\left(S_{max-mix}^{phy} + S_{opt-mix}^{phy} - S\\right)^2}{\\left(S_{opt-mix}^{phy}\\right)^2}\\right) - \\ldots \\\\ \\ldots \\left(2.0 \\times \\frac{\\left(L^{phy}_{zero-mix}-1.0\\right)\\times \\left(S_{max-mix}^{phy} + S_{opt-mix}^{phy} - S\\right)}{\\left(S_{opt-mix}^{phy}\\right)}\\right) + L^{phy}_{zero-mix} &amp; \\text{$S_{max-mix}^{phy} \\lt S \\le \\left(S_{max-mix}^{phy} + S_{max-mix}^{phy}\\right)$} \\\\ \\\\ L^{phy}_{zero-mix} &amp; \\text{$\\left(S_{max-mix}^{phy} + S_{max-mix}^{phy}\\right) \\lt S$} \\end{cases} \\tag{K.29} \\end{equation}\\] \\(S_{opt-mix}^{phy}\\) and \\(S_{max-mix}^{phy}\\) are the optimal and maximum salinities, respectively, \\(L^{phy}_{zero-mix}\\) is the value of the salinity limitation function at salinities of zero and greater than (\\(S_{opt-mix}^{phy} + S_{max-mix}^{phy}\\)) and \\(S\\) is ambient salinity. The intention of applying this limitation function is that it be used to set \\(L^{phy}_{zero-mix}\\) equal to zero at high and low salinities, and to set a range of intermediate salinities (between \\(S_{opt-mix}^{phy}\\) and \\(S_{max-mix}^{phy}\\)) where the limitation function is one. Outside this intermediate range, a phytoplankton group begins to experience inhibition and limitation function values decrease. For example, if a particular phytoplankton group was known to prefer salinities between 5 and 10 g/L, then the following would be set by the user: \\(S_{opt-mix}^{phy}\\) = 5.0 g/L \\(S_{max-mix}^{phy}\\) = 10.0 g/L \\(L^{phy}_{zero-mix}\\) = 0.0 Using these values but varying \\(S_{opt-mix}^{phy}\\), the form of Equation (K.29) is presented in Figure K.13. The absolute range between \\(S_{opt-mix}^{phy}\\) and \\(S_{max-mix}^{phy}\\) is held constant at 5.0 g/L for ease of comparison, so \\(S_{max-mix}^{phy}\\) increases at the same rate as \\(S_{opt-mix}^{phy}\\) when the slider moves. Figure K.13: Move the slider to see the effect of changing \\(S_{opt-mix}^{phy}\\) on the computed salinity limitation function. \\(L^{phy}_{zero-mix}\\) = 0.0 and is fixed. \\(S_{max-mix}^{phy}\\) is set to be \\(S_{opt-mix}^{phy}\\) + 5.0 g/L K.7.5 Estuarine This model is typically used for phytoplankton groups that have a preference for mid range salinity (typically estuarine) waters. As such, the salinity limitation is set to one at a specified (or default) optimal mid range salinity, and decreases either side of that salinity. At higher salinities, the limitation function decreases to zero by a specified (or default) maximum salinity (and it stays at zero above this maximum), and at lower salinities it decreases at a rate determined by a specified (or default) power coefficient. The limitation function \\(L_{sal}^{phy}\\) is computed within a model cell as per Equation (K.30), with the applicable salinity ranges of each piecewise function being \\(S \\le S_{max-est}^{phy}\\) and \\(S_{max-est}^{phy} \\lt S\\), respectively. \\[\\begin{equation} L_{sal}^{phy} = \\begin{cases} e^{P^{phy}_{est}\\left(S-S_{opt-est}^{phy}\\right)} \\times \\left( \\frac{\\left(S_{max-est}^{phy}-S\\right)}{\\left(S_{max-est}^{phy}-S_{opt-est}^{phy}\\right)}\\right)^{P^{phy}_{est}\\left(S_{max-est}^{phy}-S_{opt-est}^{phy}\\right)} &amp; \\text{$S \\le S_{max-est}^{phy}$} \\\\ \\\\ 0.0 &amp; \\text{$S_{max-est}^{phy} \\lt S$} \\\\ \\\\ \\end{cases} \\tag{K.30} \\end{equation}\\] \\(S_{opt-est}^{phy}\\) and \\(S_{max-est}^{phy}\\) are the optimal and maximum salinities, respectively, \\(P^{phy}_{est}\\) is the power coefficient and \\(S\\) is ambient salinity. The intention of applying this limitation function is that it be applied to a relatively narrow band of mid range (estuarine) salinities. For example, if a particular phytoplankton group was known to grow optimally at a salinity of 15 g/L but was completely suppressed less than 5 g/L and greater than 20 g/L, then the following would be set by the user: \\(S_{opt-est}^{phy}\\) = 15.0 g/L \\(S_{max-est}^{phy}\\) = 20.0 g/L \\(P^{phy}_{est}\\) = 3.0 Using these values but varying \\(P^{phy}_{est}\\), the form of Equation (K.30) is presented in Figure K.14. \\(S_{opt-est}^{phy}\\) and \\(S_{max-est}^{phy}\\) are held constant at 15.0 g/L and 20 g/L, respectively. The slider starts at a \\(P^{phy}_{est}\\) value of 0.2, and the key feature to note is that the salinity limitation function distribution tightens as \\(P^{phy}_{est}\\) increases. Figure K.14: Move the slider to see the effect of changing \\(P^{phy}_{est}\\) on the computed salinity limitation function. \\(S_{opt-est}^{phy}\\) and \\(S_{max-est}^{phy}\\) are set to be 15 and 20 g/L, respectively, and are fixed "],["PhyUptake-3.html", "Appendix L Processes: phyto uptake L.1 Carbon L.2 Nitrogen L.3 Phosphorus L.4 Silicate", " Appendix L Processes: phyto uptake Once the primary productivity \\(R_{prod\\langle computed\\rangle}^{phy}\\) rate has been computed for a phytoplankton group via Equation (J.2) (and potentially Equations (J.3) and (J.4) if nitrogen fixing and salinity limitation are activated, respectively), then that rate drives the mass uptake of inorganic carbon, nitrogen, phosphorus and silicate. This uptake includes the operation of a number of user specified (or default) parameters, and the respective calculations are described following. Uptakes are denoted as fluxes, \\(F\\). L.1 Carbon Carbon has the simplest uptake calculation, as per Equation (L.1). \\[\\begin{equation} F_{C-uptake}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times \\left[PHY\\right] \\tag{L.1} \\end{equation}\\] \\(F_{C-uptake}^{phy}\\) is the uptake of carbon, \\(R_{prod\\langle computed\\rangle}^{phy}\\) is the computed primary productivity rate and \\(\\left[PHY\\right]\\) is a computational cells phytoplankton concentration. Carbon does not need to be explicitly simulated as a computed variable for this uptake to occur, but because carbon is used as the units of accounting for phytoplankton biomass, its uptake is computed by the WQM in order to report phytoplankton concentrations. These concentrations are either mmol C per m\\(^3\\) or \\(\\mu\\)g chlorophyll a per litre (using a specified or default conversion), depending on the specified simulation units system. Carbon stores from which phytoplankton uptake can draw are assumed to be unlimited and unaccounted for when carbon is not explicitly included in a simulation as a computed variable. L.2 Nitrogen The WQM allows for phytoplankton to uptake nitrate and ammonium (i.e. inorganic nitrogen) to meet primary production nitrogen demands. The parallel uptake of organic nitrogen (i.e. simulation of mixotrophic phytoplankton) is not yet implemented within the WQM. Uptake is computed differently for the basic and advanced phytoplankton constituent models L.2.1 Basic phytoplankton constituent model If internal phytoplankton nutrients are not simulated dynamically, nitrogen uptake is calculated as per Equation (L.2). \\[\\begin{equation} F_{N-uptake}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times \\left[PHY\\right] \\times X_{N-C-con}^{phy} \\tag{L.2} \\end{equation}\\] \\(F_{N-uptake}^{phy}\\) is the uptake of water column inorganic nitrogen, \\(R_{prod\\langle computed\\rangle}^{phy}\\) is the computed primary productivity rate, \\(\\left[PHY\\right]\\) is a computational cells phytoplankton concentration and \\(X_{N-C-con}^{phy}\\) is the specified (or default) constant ratio of internal nitrogen to carbon in the phytoplankton group being considered. This quantity \\(F_{N-uptake}^{phy}\\) is the total uptake of inorganic nitrogen. In order to disaggregate this uptake into that of ammonium and nitrate, the WQM applies Equation (L.3), for ammonium concentrations greater than zero. \\[\\begin{equation} \\left.\\begin{aligned} f_{amm-uptake}^{phy} =&amp; \\frac{\\left[NH_4\\right]\\times\\left[NO_3\\right]}{\\left(\\left[NH_4\\right] + K_{lim-N}^{phy}\\right)\\times\\left(\\left[NO_3\\right]+K_{lim-N}^{phy}\\right)} + \\frac{\\left[NH_4\\right]\\times K_{lim-N}^{phy}}{\\left(\\left[NH_4\\right] + \\left[NO_3\\right]\\right)\\times\\left(\\left[NO_3\\right]+K_{lim-N}^{phy}\\right)} \\\\ \\\\ F_{amm-uptake}^{phy} =&amp; F_{N-uptake}^{phy} \\times f_{amm-uptake}^{phy} \\\\ \\\\ F_{nit-uptake}^{phy} =&amp; F_{N-uptake}^{phy} \\times \\left(1.0 - f_{amm-uptake}^{phy}\\right) \\end{aligned}\\right\\} \\tag{L.3} \\end{equation}\\] \\(f_{amm-uptake}^{phy}\\) is the fraction of nitrogen uptake that is ammonium, and are the ambient water column ammonium and nitrate concentrations, respectively, \\(K_{lim-N}^{phy}\\) is the half saturation nitrogen concentration for phytoplankton uptake and \\(F_{amm-uptake}^{phy}\\) and \\(F_{nit-uptake}^{phy}\\) are the uptake by phytoplankton of ammonium and nitrate, respectively. The form of \\(f_{amm-uptake}^{phy}\\) in Equation (L.3) with ammonium concentration is presented in Figure L.1. Use the play button or drag the slider to see how different half saturation concentrations \\(K_{lim-N}^{phy}\\) change the fraction of ammonium taken up by phytoplankton (ordinate), as a function of ambient ammonium concentration (abscissa). Nitrate concentration is set to a fixed 5 mg/L. Figure L.1: Move the slider to see the effect of changing \\(K_{lim-N}^{phy}\\) on the fraction of ammonium taken up by phytoplankton. Nitrate concentration is set to 5 mg/L and is fixed To complement Figure L.1, the form of \\(f_{amm-uptake}^{phy}\\) in Equation (L.3) with nitrate concentration is presented in Figure L.2, using the same ordinate axis limits. Use the play button or drag the slider to see how different half saturation concentrations \\(K_{lim-N}^{phy}\\) change the fraction of ammonium taken up by phytoplankton (ordinate), as a function of ambient nitrate concentration (abscissa). Ammonium concentration is set to a fixed 2 mg/L. Figure L.2: Move the slider to see the effect of changing \\(K_{lim-N}^{phy}\\) on the fraction of ammonium taken up by phytoplankton. Ammonium concentration is set to 2 mg/L and is fixed The parameter [\\(K_{lim-N}^{phy}\\)] is the same as that used for calculation of the nitrogen limitation function in the basic (and advanced if internal nitrogen stores are exhausted) phytoplankton constituent model, so its specification should be considered in terms of its influence on both uptake on limitation. L.2.2 Advanced phytoplankton constituent model If internal phytoplankton nutrients are simulated dynamically, nitrogen uptake is calculated as per Equation (L.4). \\[\\begin{equation} F_{N-uptake}^{phy} = R_{N-uptake}^{phy} \\times L_{T}^{phy} \\times \\left[PHY\\right] \\times \\frac{\\left(X_{NC-max}^{phy} - \\frac{\\left[N\\right]_{in}}{\\left[PHY\\right]}\\right)}{\\left(X_{NC-max}^{phy} - X_{NC-min}^{phy}\\right)} \\times \\frac{\\left(\\left[N\\right]_{avail} - \\left[N\\right]_{min}\\right)}{\\left(\\left[N\\right]_{avail} - \\left[N\\right]_{min}\\right) + K_{lim-N}^{phy}} \\tag{L.4} \\end{equation}\\] \\(F_{N-uptake}^{phy}\\) is the uptake of water column inorganic nitrogen, \\(R_{N-uptake}^{phy}\\) is the specified (or default) rate of uptake of inorganic nitrogen, \\(L_{T}^{phy}\\) is the temperature limitation function, \\(\\left[PHY\\right]\\) and \\(\\left[N\\right]_{in}\\) are a computational cells phytoplankton and internal nitrogen concentrations respectively, \\(X_{N-C-min}^{phy}\\) and \\(X_{N-C-max}^{phy}\\) are the specified (or default) minimum and maximum ratios of internal nitrogen to carbon in the phytoplankton group being considered, respectively, \\(\\left[N\\right]_{avail}\\) is the available nitrogen pool on which phytoplankton can draw for primary productivity, and is the sum of inorganic (ammonium and nitrate) nitrogen, \\(\\left[N\\right]_{min}\\) is the nitrogen concentration below which phytoplankton is no longer permitted to uptake nitrogen and \\(K_{lim-N}^{phy}\\) is the half saturation nitrogen concentration for phytoplankton uptake. These last three parameters (and the last term in Equation (L.4)) are the same as that applied to the basic phytoplankton constituent model as per Equation (L.2), via calculation of the limitation function applied to \\(R_{prod\\langle computed\\rangle}^{phy}\\) (as per Equation (K.9)). Equation (L.4) reveals the following: The uptake of water column nitrogen to internal phytoplankton stores is governed by the specified (or default) nitrogen uptake rate This rate is modified by Temperature, using the specified (or default) temperature limitation model for uptake (Section K.2) The current internal nitrogen concentrations, relative to the specified (or default) minima and maxima Ambient water column inorganic nitrogen concentrations, and The half saturation nitrogen concentration for uptake, which is the same parameter as used in the basic phytoplankton constituent model If for example the internal nitrogen concentration \\(\\left[N\\right]_{in}\\) at a particular timestep and computational cell is equal to \\(X_{NC-max}^{phy} \\times \\left[PHY\\right]\\), then Equation (L.4) has that internal nitrogen stores are full and that uptake is therefore zero. Conversely, if \\(\\left[N\\right]_{in}\\) at a particular timestep and computational cell is equal to \\(X_{NC-min}^{phy} \\times \\left[PHY\\right]\\), then internal nitrogen stores are at their lowest and therefore (in themselves) do not limit uptake of water column nitrogen. Finally, if the available water column nitrogen \\(\\left[N\\right]_{avail}\\) is equal to the specified (or default) minimum allowable nitrogen concentration for uptake _{min}$, then uptake to internal nutrient stores is zero. If uptake from the water column to internal stores occurs, then the split between ammonium and nitrate uptake is computed as per Equation (L.3). The parameter \\(K_{lim-N}^{phy}\\) is the same as that used for calculation of the nitrogen limitation function in the advanced phytoplankton constituent model if internal nitrogen stores are exhausted, so its specification should be considered in terms of its influence on both uptake on limitation. L.2.3 Nitrogen fixing If nitrogen fixing by phytoplankton is simulated, then a modification to the above computed nitrogen uptakes (for both the basic and advanced phytoplankton constituent models) is applied. The flux of atmospheric nitrogen is computed as per Equation (L.5). \\[\\begin{equation} F_{N-fix}^{phy} = R_{N-fix}^{phy} \\times \\left(1.0 - L_{nit}^{phy}\\right) \\times \\left[PHY\\right] \\tag{L.5} \\end{equation}\\] \\(F_{N-fix}^{phy}\\) is the fixing of atmospheric nitrogen, \\(R_{N-fix}^{phy}\\) is the specified (or default) rate of nitrogen fixing, \\(L_{nit}^{phy}\\) is the nitrogen limitation function computed via either Equation (K.9) or (K.11) for the basic and advanced phytoplankton constituent models, respectively, before \\(L_{nit}^{phy}\\) is set to one. Once computed, \\(F_{N-uptake}^{phy}\\) is modified as follows: If \\(|F_{N-fix}^{phy}| \\ge |F_{N-uptake}^{phy}|\\) then all uptake is assigned to \\(F_{N-fix}^{phy}\\), and \\(F_{N-uptake}^{phy}\\) is set to zero. If If \\(|F_{N-fix}^{phy}| \\le |F_{N-uptake}^{phy}|\\) then nitrogen water column uptake is reduced as per Equation (L.6). \\[\\begin{equation} F_{N-uptake\\langle computed \\rangle}^{phy} = F_{N-uptake}^{phy} \\times \\frac{\\left(|F_{N-uptake}^{phy}| - F_{N-fix}^{phy}\\right)}{|F_{N-uptake}^{phy}|} \\tag{L.6} \\end{equation}\\] Equation (L.6) is a simple linearisation that maps \\(F_{N-uptake\\langle computed \\rangle}^{phy}\\) to a value between 0.0 (where \\(F_{N-fix}^{phy} = F_{N-uptake}^{phy}\\)) and \\(F_{N-uptake\\langle computed \\rangle}^{phy}\\) (where \\(F_{N-fix}^{phy}\\) is zero). L.3 Phosphorus The WQM allows for phytoplankton to uptake free reactive phosphorus (i.e. inorganic phosphorus, FRP) to meet primary production phosphorus demands. The parallel uptake of organic phosphorus (i.e. simulation of mixotrophic phytoplankton) is not yet implemented within the WQM. Uptake is computed differently for the basic and advanced phytoplankton constituent models L.3.1 Basic phytoplankton constituent model If internal phytoplankton nutrients are not simulated dynamically, phosphorus uptake is calculated as per Equation (L.7). \\[\\begin{equation} F_{P-uptake}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times \\left[PHY\\right] \\times X_{PC-con}^{phy} \\tag{L.7} \\end{equation}\\] \\(F_{P-uptake}^{phy}\\) is the uptake of inorganic phosphorus, \\(R_{prod\\langle computed\\rangle}^{phy}\\) is the computed primary productivity rate, \\(\\left[PHY\\right]\\) is a computational cells phytoplankton concentration and \\(X_{PC-con}^{phy}\\) is the specified (or default) constant ratio of internal phosphorus to carbon in the phytoplankton group being considered. L.3.2 Advanced phytoplankton constituent model If internal phytoplankton nutrients are simulated dynamically, phosphorus uptake is calculated as per Equation (L.8). \\[\\begin{equation} F_{P-uptake}^{phy} = R_{P-uptake}^{phy} \\times L_{T}^{phy} \\times \\left[PHY\\right] \\times \\frac{\\left(X_{PC-max}^{phy} - \\frac{\\left[P\\right]_{in}}{\\left[PHY\\right]}\\right)}{\\left(X_{PC-max}^{phy} - X_{PC-min}^{phy}\\right)} \\times \\frac{\\left(\\left[P\\right]_{avail} - \\left[P\\right]_{min}\\right)}{\\left(\\left[P\\right]_{avail} - \\left[P\\right]_{min}\\right) + K_{lim-P}^{phy}} \\tag{L.8} \\end{equation}\\] \\(F_{P-uptake}^{phy}\\) is the uptake of water column FRP, \\(R_{P-uptake}^{phy}\\) is the specified (or default) rate of uptake of FRP, \\(L_{T}^{phy}\\) is the temperature limitation function, \\(\\left[PHY\\right]\\) and \\(\\left[P\\right]_{in}\\) are a computational cells phytoplankton and internal phosphorus concentrations respectively, \\(X_{P-C-min}^{phy}\\) and \\(X_{P-C-max}^{phy}\\) are the specified (or default) minimum and maximum ratios of internal phosphorus to carbon in the phytoplankton group being considered, respectively, \\(\\left[P\\right]_{avail}\\) is the available FRP pool on which phytoplankton can draw for primary productivity, \\(\\left[P\\right]_{min}\\) is the FRP concentration below which phytoplankton is no longer permitted to uptake phosphorus and \\(K_{lim-P}^{phy}\\) is the half saturation FRP concentration for phytoplankton uptake. These last three parameters (and the last term in Equation (L.8)) are the same as that applied to the basic phytoplankton constituent model as per Equation (L.7), via calculation of the limitation function applied to \\(R_{prod\\langle computed\\rangle}^{phy}\\) (as per Equation (K.13)). Equation (L.8) reveals the following: The uptake of water column FRP to internal phytoplankton stores is governed by the specified (or default) phosphorus uptake rate This rate is modified by Temperature, using the specified (or default) temperature limitation model for uptake (Section K.2) The current internal phosphorus concentrations, relative to the specified (or default) minima and maxima Ambient water column FRP concentrations, and The half saturation phosphorus concentration for uptake, which is the same parameter as used in the basic phytoplankton constituent model If for example the internal phosphorus concentration \\(\\left[P\\right]_{in}\\) at a particular timestep and computational cell is equal to \\(X_{PC-max}^{phy}\\times \\left[PHY\\right]\\), then Equation (L.8) has that internal phosphorus stores are full and that uptake is therefore zero. Conversely, if \\(\\left[P\\right]_{in}\\) at a particular timestep and computational cell is equal to \\(X_{PC-min}^{phy} \\times \\left[PHY\\right]\\), then internal phosphorus stores are at their lowest and therefore (in themselves) do not limit uptake of water column FRP. Finally, if the available water column FRP \\(\\left[P\\right]_{avail}\\) is equal to the specified (or default) minimum allowable FRP concentration for uptake \\(\\left[P\\right]_{min}\\), then uptake to internal nutrient stores is zero. The parameter \\(K_{lim-P}^{phy}\\) is the same as that used for calculation of the phosphorus limitation function in the advanced phytoplankton constituent model if internal phosphorus stores are exhausted, so its specification should be considered in terms of its influence on both uptake on limitation. L.4 Silicate The WQM allows for phytoplankton to uptake silicate to meet primary production demands, for phytoplankton groups that require silicate. Silicate uptake is calculated as per Equation (L.9). \\[\\begin{equation} F_{Si-uptake}^{phy} = R_{prod\\langle computed\\rangle}^{phy} \\times \\left[PHY\\right] \\times X_{SiC-con}^{phy} \\tag{L.9} \\end{equation}\\] \\(F_{Si-uptake}^{phy}\\) is the uptake of silicate, \\(R_{prod\\langle computed\\rangle}^{phy}\\) is the computed primary productivity rate, \\(\\left[PHY\\right]\\) is a computational cells phytoplankton concentration and \\(X_{SiC-con}^{phy}\\) is the specified (or default) constant ratio of internal silicate to carbon in the phytoplankton group being considered. "],["PhyLosses-3.html", "Appendix M Processes: phyto losses M.1 Carbon M.2 Nitrogen M.3 Phosphorus M.4 Silicate", " Appendix M Processes: phyto losses Once the respiration \\(R_{resp\\langle computed\\rangle}^{phy}\\) and exudation \\(R_{exud\\langle computed\\rangle}^{phy}\\) rates have been computed for a phytoplankton group via Equation (J.6) (and potentially Equation (J.7) if salinity limitation is activated), then those rates drive the mass losses of carbon, nitrogen, phosphorus and silicate. These losses are computed using a number of user specified (or default) parameters, and for each relevant computed variable, comprise the following: Excretion loss: Computed from a combination of respiration and exudation rates (\\(R_{resp\\langle computed\\rangle}^{phy}\\) and \\(R_{exud\\langle computed\\rangle}^{phy}\\), respectively), and typically associated with delivery to dissolved inorganic and organic pools, and Mortality loss: Computed from a respiration rate \\(R_{resp\\langle computed\\rangle}^{phy}\\) and typically associated with delivery to particulate organic pools The specifics of the calculation of each relevant computed variables excretion (dissolved losses) and mortality (particulate losses) are described following. Losses are denoted as fluxes, \\(F\\). M.1 Carbon Equation (M.1) describes the calculation of excretion losses. \\[\\begin{equation} F_{C-excr}^{phy} = \\left(\\left[f_{DOM-loss}^{phy} \\times \\left(1.0 - f_{true-resp}^{phy}\\right) \\times R_{resp\\langle computed\\rangle}^{phy}\\right] + R_{exud\\langle computed\\rangle}^{phy}\\right) \\times \\left[PHY\\right] \\tag{M.1} \\end{equation}\\] \\(F_{C-excr}^{phy}\\) is the excretive loss of carbon, \\(f_{DOM-loss}^{phy}\\) is the fraction of loss that becomes dissolved organic matter, \\(f_{true-resp}^{phy}\\) is the fraction of loss that is true respiration, \\(R_{resp\\langle computed\\rangle}^{phy}\\) and \\(R_{exud\\langle computed\\rangle}^{phy}\\) are the computed respiration and exudation rates, respectively and \\(\\left[PHY\\right]\\) is a computational cells phytoplankton concentration. Equation (M.2) describes the calculation of mortality losses. \\[\\begin{equation} F_{C-mort}^{phy} = \\left(\\left(1.0 - f_{DOM-loss}^{phy}\\right) \\times \\left(1.0 - f_{true-resp}^{phy}\\right) \\times R_{resp\\langle computed\\rangle}^{phy}\\right) \\times \\left[PHY\\right] \\tag{M.2} \\end{equation}\\] As with primary productivity, carbon does not need to be explicitly simulated as a computed variable for these losses to occur, but because carbon is used as the units of accounting for phytoplankton biomass, its losses are computed by the WQM in order to report phytoplankton concentrations. These concentrations are either mmol C per m\\(^3\\) or \\(\\mu\\)g chlorophyll a per litre (using a specified or default conversion), depending on the specified simulation units system. Carbon stores to which the phytoplankton losses in Equations (M.1) and (M.2) deliver are assumed to be unlimited when carbon is not explicitly included in a simulation as a computed variable. The form of the entire multiplicative factors immediately preceding \\(\\left[PHY\\right]\\) in Equations (M.1) and (M.2) are presented in Figure M.1, as a function of \\(f_{DOM-loss}^{phy}\\). Use the play button or drag the slider to see how different values of \\(f_{true-resp}^{phy}\\) change these multiplicative factors (ordinate), which are shown as functions of \\(f_{DOM-loss}^{phy}\\) (abscissa). \\(R_{resp\\langle computed\\rangle}^{phy}\\) and \\(R_{exud\\langle computed\\rangle}^{phy}\\) are set to fixed values of 0.1 and 0.05 /day, respectively. Figure M.1: Move the slider to see the effect of changing \\(f_{true-resp}^{phy}\\) on the form of the multiplicative factors preceding \\([PHY]\\) in the above loss equations. \\(R_{resp&lt;computed&gt;}^{phy}\\) and \\(R_{exud&lt; computed&gt;}^{phy}\\) are set to fixed values of 0.1 and 0.05 /day, respectively To complement Figure M.1, the form of the entire multiplicative factors immediately preceding \\(\\left[PHY\\right]\\) in Equations (M.1) and (M.2) are again presented in Figure M.2, but as a function of \\(f_{true-resp}^{phy}\\). Use the play button or drag the slider to see how different values of \\(f_{DOM-loss}^{phy}\\) change these multiplicative factors (ordinate), which are shown as functions of \\(f_{true-resp}^{phy}\\) (abscissa). \\(R_{resp\\langle computed\\rangle}^{phy}\\) and \\(R_{exud\\langle computed\\rangle}^{phy}\\) are again set to the same fixed values of 0.1 and 0.05 /day, respectively. Figure M.2: Move the slider to see the effect of changing \\(f_{DOM-loss}^{phy}\\) on the form of the multiplicative factors preceding \\([PHY]\\) in the above loss equations. \\(R_{resp&lt;computed&gt;}^{phy}\\) and \\(R_{exud&lt; computed&gt;}^{phy}\\) are set to fixed values of 0.1 and 0.05 /day, respectively Some key features of the Figures M.1 and M.2 are as follows: If \\(f_{true-resp}^{phy}\\) is set to 1.0, then carbonaceous excretion losses are due solely to exudation, and mortality losses are zero. This is consistent with interpreting \\(f_{true-resp}^{phy}\\) as the fraction of respiration that is associated only with the re-release of energy through metabolism of carbon biomass generated and stored during antecedent phytoplanktonic photosynthesis Conversely, if \\(f_{true-resp}^{phy}\\) is set to 0.0, then (potentially unrealistically) respiration does not re-release any energy, but rather, sees the entire respiration rate expended on excretion of carbon biomass (subject to the value of \\(f_{DOM-loss}^{phy}\\)) If \\(f_{DOM-loss}^{phy}\\) is set to 1.0, then mortality losses are zero. This is consistent with interpreting mortality as delivering carbonaceous organic matter to the particulate organics pool. This value of 1.0 dictates that no such particulates are generated through mortality, and that (subject to the value of \\(f_{true-resp}^{phy}\\)), the delivery of dissolved carbonaceous organic matter through excretive losses is maximised. Conversely, if \\(f_{DOM-loss}^{phy}\\) is set to 0.0, then dissolved excretive carbonaceous losses are due only to exudation, and (subject to the value of \\(f_{true-resp}^{phy}\\)), the delivery of particulate organic matter through mortality losses is maximised Intermediate behaviours to the above limits can be inferred from interacting with Figures M.1 and M.2. Organics need not be simulated as computed variables within a WQM simulation for the above processes to operate. If this is the case, then losses to carbonaceous organics are computed but not accounted for explicitly. M.2 Nitrogen Equation (M.3) describes the calculation of excretion losses. \\[\\begin{equation} F_{N-excr}^{phy} = \\left(\\left(f_{DOM-loss}^{phy} \\times R_{resp\\langle computed\\rangle}^{phy}\\right) + R_{exud\\langle computed\\rangle}^{phy}\\right) \\times X_{N-C}^{phy} \\times \\left[PHY\\right] \\tag{M.3} \\end{equation}\\] \\(F_{N-excr}^{phy}\\) is the excretive loss of nitrogen, \\(f_{DOM-loss}^{phy}\\) is the fraction of loss that becomes dissolved organic matter, \\(R_{resp\\langle computed\\rangle}^{phy}\\) and and \\(R_{exud\\langle computed\\rangle}^{phy}\\) are the computed respiration and exudation rates, respectively, and \\(\\left[PHY\\right]\\) is a computational cells phytoplankton concentration. If the basic phytoplankton constituent model is used, then \\(X_{N-C}^{phy}\\) is the specified (or default) constant ratio of internal nitrogen to carbon. If the advanced phytoplankton constituent model is used, then \\(X_{N-C}^{phy}\\) is the dynamically computed ratio of internal nitrogen to carbon concentrations, where this ratio varies only between the specified (or default) minimum and maximum ratios \\(X_{N-C-min}^{phy}\\) and \\(X_{N-C-max}^{phy}\\), respectively. Equation (M.4) describes the calculation of mortality losses. \\[\\begin{equation} F_{N-mort}^{phy} = \\left(\\left(1.0 - f_{DOM-loss}^{phy}\\right) \\times R_{resp\\langle computed\\rangle}^{phy}\\right) \\times X_{N-C}^{phy} \\times \\left[PHY\\right] \\tag{M.4} \\end{equation}\\] Some key features of the Equations (M.3) and (M.4) are as follows: If \\(f_{DOM-loss}^{phy}\\) is set to 1.0, then mortality losses are zero. This is consistent with interpreting mortality as delivering nitrogenous organic matter to the particulate organics pool. This value of 1.0 dictates that no such particulates are generated through mortality, and that the delivery of dissolved organic matter through excretive losses is maximised. Conversely, if \\(f_{DOM-loss}^{phy}\\) is set to 0.0, then dissolved excretive nitrogenous losses are due only to exudation, and the delivery of particulate organic matter through mortality losses is maximised. Organics need not be simulated as computed variables within a WQM simulation for the above processes to operate. If this is the case, then losses are still computed as above, but the associated fluxes are applied to the ammonium nitrogen pool (both for excretion and mortality), rather than the dissolved organic (excretion) and particulate organic (mortality) nitrogen pools. M.3 Phosphorus Equation (M.5) describes the calculation of excretion losses. \\[\\begin{equation} F_{P-excr}^{phy} = \\left(\\left(f_{DOM-loss}^{phy} \\times R_{resp\\langle computed\\rangle}^{phy}\\right) + R_{exud\\langle computed\\rangle}^{phy}\\right) \\times X_{P-C}^{phy} \\times \\left[PHY\\right] \\tag{M.5} \\end{equation}\\] \\(F_{P-excr}^{phy}\\) is the excretive loss of phosphorus, \\(f_{DOM-loss}^{phy}\\) is the fraction of loss that becomes dissolved organic matter, \\(R_{resp\\langle computed\\rangle}^{phy}\\) and and \\(R_{exud\\langle computed\\rangle}^{phy}\\) are the computed respiration and exudation rates, respectively, and \\(\\left[PHY\\right]\\) is a computational cells phytoplankton concentration. If the basic phytoplankton constituent model is used, then \\(X_{P-C}^{phy}\\) is the specified (or default) constant ratio of internal phosphorus to carbon. If the advanced phytoplankton constituent model is used, then \\(X_{P-C}^{phy}\\) is the dynamically computed ratio of internal phosphorus to carbon concentrations, where this ratio varies only between the specified (or default) minimum and maximum ratios \\(X_{P-C-min}^{phy}\\) and \\(X_{P-C-max}^{phy}\\), respectively. Equation (M.6) describes the calculation of mortality losses. \\[\\begin{equation} F_{P-mort}^{phy} = \\left(\\left(1.0 - f_{DOM-loss}^{phy}\\right) \\times R_{resp\\langle computed\\rangle}^{phy}\\right) \\times X_{P-C}^{phy} \\times \\left[PHY\\right] \\tag{M.6} \\end{equation}\\] Some key features of the Equations (M.5) and (M.6) are as follows: If \\(f_{DOM-loss}^{phy}\\) is set to 1.0, then mortality losses are zero. This is consistent with interpreting mortality as delivering phosphoric organic matter to the particulate organics pool. This value of 1.0 dictates that no such particulates are generated through mortality, and that the delivery of dissolved organic matter through excretive losses is maximised. Conversely, if \\(f_{DOM-loss}^{phy}\\) is set to 0.0, then dissolved excretive phosphoric losses are due only to exudation, and the delivery of particulate organic matter through mortality losses is maximised. Organics need not be simulated as computed variables within a WQM simulation for the above processes to operate. If this is the case, then losses are still computed as above, but the associated fluxes are applied to the FRP phosphorus pool (both for excretion and mortality), rather than the dissolved organic (excretion) and particulate organic (mortality) phosphorus pools. M.4 Silicate Equation (M.7) describes the calculation of excretion losses, if silicate is included in phytoplanktonic calculations. \\[\\begin{equation} F_{Si-excr}^{phy} = \\left(\\left(f_{DOM-loss}^{phy} \\times R_{resp\\langle computed\\rangle}^{phy}\\right) + R_{exud\\langle computed\\rangle}^{phy}\\right) \\times X_{Si-C}^{phy} \\times \\left[PHY\\right] \\tag{M.7} \\end{equation}\\] \\(F_{Si-excr}^{phy}\\) is the excretive loss of silicate, \\(f_{DOM-loss}^{phy}\\) is the fraction of loss that becomes dissolved organic matter, \\(R_{resp\\langle computed\\rangle}^{phy}\\) and and \\(R_{exud\\langle computed\\rangle}^{phy}\\) are the computed respiration and exudation rates, respectively, \\(X_{Si-C}^{phy}\\) is the specified (or default) constant ratio of internal silicate to carbon in the phytoplankton group being considered and \\(\\left[PHY\\right]\\) is a computational cells phytoplankton concentration. Equation (M.8) describes the calculation of mortality losses. \\[\\begin{equation} F_{Si-mort}^{phy} = \\left(\\left(1.0 - f_{DOM-loss}^{phy}\\right) \\times R_{resp\\langle computed\\rangle}^{phy}\\right) \\times X_{Si-C}^{phy} \\times \\left[PHY\\right] \\tag{M.8} \\end{equation}\\] Some key features of the Equations (M.5) and (M.6) are as follows: If \\(f_{DOM-loss}^{phy}\\) is set to 1.0, then mortality losses are zero. This is consistent with interpreting mortality as delivering silicate matter to a particulate silicate pool. This is purely an accounting calculation however, because the WQM does not simulate an equivalent particulate silicate pool. Nonetheless, this value of 1.0 dictates that no such particulates would be generated through mortality, and that the delivery of dissolved silicate through excretive losses is maximised. Conversely, if \\(f_{DOM-loss}^{phy}\\) is set to 0.0, then dissolved excretive silicate losses are due only to exudation, and the delivery of particulate silicate matter through mortality losses would be maximised if simulated. Despite not simulating particulate silicate, Equations (M.5) and (M.6) nonetheless ensure that the mass of silicate delivered to the dissolved pool (that is simulated by the WQM) is consistent with that of carbon, nitrogen and phosphorus. "],["AppphyOther.html", "Appendix N Processes: phyto other N.1 Self shading N.2 Cell density", " Appendix N Processes: phyto other N.1 Self shading Photosynthetically available radiation is provided to the WQM from TUFLOW for each computational cell at each water quality timestep. It is this two- or three-dimensional field that the WQM uses to compute phytoplanktonic responses to light. The WQM allows, however, for modification of this TUFLOW field to incorporate the effect of light attenuation due to the presence of phytoplankton. This additional light extinction is computed dynamically at each water quality timestep, based on instantaneous phytoplanktonic concentrations in individual computational cells, as per Equation (N.1). \\[\\begin{equation} Ke_{\\langle computed \\rangle}^{phy} = Ke^{phy} \\times \\left[PHY\\right] \\tag{N.1} \\end{equation}\\] For each phytoplankton group, \\(Ke^{phy}\\) is the user specified (or default) self shading coefficient and \\(\\left[PHY\\right]\\) is the instantaneous phytoplankton concentration in each cell. For each cell and at each timestep, this quantity \\(Ke_{\\langle computed \\rangle}^{phy}\\) is computed for each phytoplankton group. Results are then summed within each cell and returned to TUFLOW as a two- or three-dimensional field which TUFLOW then includes these in subsequent light distribution calculations. N.2 Cell density If the advanced phytoplankton constituent model is deployed, then cell density can be optionally simulated as an additional computed variable. It therefore needs to be specified as any other computed variable would be in initial and boundary conditions. The principle of the WQM density calculations is that cell density is set to increase during daylight primary production (when carbohydrates are created via photosynthesis) and decrease during darkness respiration (when carbohydrates are consumed). Equations (N.2) and (N.3) are used to describe these processes, respectively. \\[\\begin{equation} PHY_{\\rho\\langle computed \\rangle} = PHY_{\\rho} + \\frac{0.124 \\times \\left(1.0 - e^{\\frac{-PAR}{I_K}}\\right) - 0.0230}{60} \\tag{N.2} \\end{equation}\\] \\[\\begin{equation} PHY_{\\rho\\langle computed \\rangle} = PHY_{\\rho} - \\frac{0.0230}{60} \\tag{N.3} \\end{equation}\\] \\(PHY_{\\rho\\langle computed \\rangle}\\) and \\(PHY_{\\rho}\\) are the computed and initial (previous timestep) cell densities, respectively and \\(PAR\\) and \\(I_K\\) are the ambient cell photosynthetically active radiation and half saturation light intensity, respectively. \\(I_K\\) is specified via the light limitation function, or if not, then via the specification of the stokes settling model, or as the default. Computed cell densities are checked against specified (or default) global minima and maxima and reset to these limits if exceeded. "],["AppParams.html", "Appendix O Parameters", " Appendix O Parameters .book .book-body .page-wrapper .page-inner { max-width: 95%; } Following are parameters that can be specified within the WQM via user commands. Tips for use: Use the search box to dynamically filter the table Sort the filtered (or unfiltered) table by clicking the arrows at the top of each column Use s on your keyboard to toggle the contents pane on and off to provide more screen width if needed UD = user defined N/A = not applicable For each parameter, use the links in the final column to navigate to either: A description of the corresponding control file command that includes the parameter (these links are all suffixed with ==) The section describing the relevant science and/or equations (these links are all called science) Where numerical limits are provided for phytoplankton simulation parameters, the conversion bewteen \\(\\mu\\)g/L Clh a and mmol/m\\(^3\\) or carbon is assumed to be 27.0 mg C/mg Chl a Table O.1: WQM parameters Parameter Notation Units Range Default Description Links Sediment oxygen flux \\(F_{sed}^{O_2}\\) mg O\\(_2\\)/m\\(^2\\)/d mmol O\\(_2\\)/m\\(^2\\)/d (-6400, 0) (-200, 0) 0 0 The rate at which dissolved oxygen is exchanged between the sediments and overlying water column at 20\\(^o\\)C excluding the influence of overlying dissolved oxygen concentration. Can be varied spatially via use of model mesh material types. This is not the maxuimum rate of oxygen sediment flux oxygen flux == science Sediment half saturation oxygen concentration for oxygen flux \\(K_{sed-O_2}^{O_2}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed sediment oxygen flux is half the user specified rate, at 20\\(^o\\)C. Cannot be varied spatially oxygen benthic == science Sediment oxygen flux temperature coefficient \\(\\theta_{sed}^{O_2}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on oxygen sediment flux. A value of 1.0 will remove the effect of temperature oxygen benthic == science Minimum dissolved oxygen concentration \\(\\left[DO\\right]_{min}^{O_2}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 0.5) (0, 15.6) NA NA The minimum allowable dissolved oxygen concentration. If the WQM detects a concentration less than this, then it will be reset to this value, and reported in the WQM log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual oxygen min max == science Maximum dissolved oxygen concentration \\(\\left[DO\\right]_{max}^{O_2}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (6, 20) (187.5, 625) NA NA The maximum allowable dissolved oxygen concentration. If the WQM detects a concentration greater than this, then it will be reset to this value, and reported in the WQM log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues oxygen min max == science Timestep \\(dt\\) seconds (UD, UD) 900 The timestep at which the WQM is called from the hydrodynamic model wq dt == science Sediment silicate flux \\(F_{sed}^{Si}\\) mg Si/m\\(^2\\)/d mmol Si/m\\(^2\\)/d (0, 140) (0, 5) 0 0 The rate at which silicate is exchanged between the sediments and overlying water column at 20\\(^o\\)C excluding the influence of overlying dissolved oxygen concentration. Can be varied spatially via use of model mesh material types. This is not the maxuimum rate of silicate sediment flux silicate flux == science Sediment half saturation oxygen concentration for silicate flux \\(K_{sed-O_2}^{Si}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed sediment silicate flux is half the user specified rate, at 20\\(^o\\)C. Cannot be varied spatially silicate benthic == science Sediment silicate flux temperature coefficient \\(\\theta_{sed}^{Si}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on silicate sediment flux. A value of 1.0 will remove the effect of temperature silicate benthic == science Minimum silicate concentration \\(\\left[Si\\right]_{min}^{Si}\\) mg/L Si mmol/m\\(^3\\) Si (0, 2.8) (0, 100) NA NA The minimum allowable silicate concentration. If the WQM detects a concentration less than this, then it will be reset to this value, and reported in the WQM log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual silicate min max == science Maximum silicate concentration \\(\\left[Si\\right]_{max}^{Si}\\) mg/L Si mmol/m\\(^3\\) Si (0, 140) (0, 5000) NA NA The maximum allowable silicate concentration. If the WQM detects a concentration greater than this, then it will be reset to this value, and reported in the WQM log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues silicate min max == science Sediment ammonium flux \\(F_{sed}^{NH_4}\\) mg NH\\(_4\\)-N/m\\(^2\\)/d mmol NH\\(_4\\)-N/m\\(^2\\)/d (0, 140) (0, 10) 0 0 The rate at which ammonium is exchanged between the sediments and overlying water column at 20\\(^o\\)C excluding the influence of overlying dissolved oxygen concentration. Can be varied spatially via use of model mesh material types. This is not the maxuimum rate of ammonium sediment flux ammonium flux == science Sediment half saturation oxygen concentration for ammonium flux \\(K_{sed-O_2}^{NH_4}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed sediment ammonium flux is half the user specified rate, at 20\\(^o\\)C. Cannot be varied spatially ammonium benthic == science Sediment ammonium flux temperature coefficient \\(\\theta_{sed}^{NH_4}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on ammonium sediment flux. A value of 1.0 will remove the effect of temperature ammonium benthic == science Minimum ammonium concentration \\(\\left[NH_4\\right]_{min}^{NH_4}\\) mg/L NH\\(_4\\)-N mmol/m\\(^3\\) NH\\(_4\\)-N (0, 0.098) (0, 7) NA NA The minimum allowable ammonium concentration. If the WQM detects a concentration less than this, then it will be reset to this value, and reported in the WQM log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual ammonium min max == science Maximum ammonium concentration \\(\\left[NH_4\\right]_{max}^{NH_4}\\) mg/L NH\\(_4\\)-N mmol/m\\(^3\\) NH\\(_4\\)-N (0, 98) (0, 7000) NA NA The maximum allowable ammonium concentration. If the WQM detects a concentration greater than this, then it will be reset to this value, and reported in the WQM log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues ammonium min max == science Sediment nitrate flux \\(F_{sed}^{NO_3}\\) mg NO\\(_3\\)-N/m\\(^2\\)/d mmol NO\\(_3\\)-N/m\\(^2\\)/d (0, 140) (0, 10) 0 0 The rate at which nitrate is exchanged between the sediments and overlying water column at 20\\(^o\\)C excluding the influence of overlying dissolved oxygen concentration. Can be varied spatially via use of model mesh material types. This is not the maxuimum rate of nitrate sediment flux ammonium flux == science Sediment half saturation oxygen concentration for nitrate flux \\(K_{sed-O_2}^{NO_3}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed sediment nitrate flux is half the user specified rate, at 20\\(^o\\)C. Cannot be varied spatially ammonium benthic == science Sediment nitrate flux temperature coefficient \\(\\theta_{sed}^{NO_3}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on nitrate sediment flux. A value of 1.0 will remove the effect of temperature ammonium benthic == science Minimum nitrate concentration \\(\\left[NO_3\\right]_{min}^{NO_3}\\) mg/L NO\\(_3\\)-N mmol/m\\(^3\\) NO\\(_3\\)-N (0, 0.098) (0, 7) NA NA The minimum allowable nitrate concentration. If the WQM detects a concentration less than this, then it will be reset to this value, and reported in the WQM log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual ammonium min max == science Maximum nitrate concentration \\(\\left[NO_3\\right]_{max}^{NO_3}\\) mg/L NO\\(_3\\)-N mmol/m\\(^3\\) NO\\(_3\\)-N (0, 98) (0, 7000) NA NA The maximum allowable nitrate concentration. If the WQM detects a concentration greater than this, then it will be reset to this value, and reported in the WQM log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues ammonium min max == science Nitrification rate \\(R_{nitrif}^{NH_4}\\) /d (0, 5) 0 0 The rate at which ammonium is nitrified to nitrate at 20\\(^o\\)C excluding the influence of ambient dissolved oxygen concentration. A value of 0.0 will switch off nitrification nitrification == science Half saturation oxygen concentration for nitrification \\(K_{nitrif-O_2}^{NH_4}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed nitrification rate is half the user specified rate, at 20\\(^o\\)C nitrification == science Nitrification temperature coefficient \\(\\theta_{nitrif}^{NH_4}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on nitrification. A value of 1.0 will remove the effect of temperature nitrification == science Denitrification rate \\(R_{denit}^{NO_3}\\) /d (0, 0.5) 0 0 The rate at which nitrate is denitrified to nitrogen gas N\\(_2\\) at 20\\(^o\\)C excluding the influence of ambient dissolved oxygen and nitrate concentrations. A value of 0.0 will switch off denitrification denitrification == science Half saturation oxygen concentration for denitrification \\(K_{denit-O2-MM}^{NO_3}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed denitrification rate is half the user specified rate, at 20\\(^o\\)C and with no influence of ambient nitrate concentration. This value is used if the Michaelis Menten denitrification model is speciifed as the first argument of the denitrification == command denitrification == science Normalising oxygen concentration for denitrification \\(K_{denit-O2-exp}^{NO_3}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration that divides (normalises) the ambient dissolved oxygen concentration in the exponent term of the exponential denitrification model, at 20\\(^o\\)C and with no influence of ambient nitrate concentration. This value is used if the exponential denitrification model is speciifed as the first argument of the denitrification == command denitrification == science Denitrification temperature coefficient \\(\\theta_{denit}^{NO_3}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on denitrification. A value of 1.0 will remove the effect of temperature denitrification == science Half saturation nitrate concentration for denitrification \\(K_{denit-NO3}^{NO_3}\\) mg/L NO\\(_3\\) mmol/m\\(^3\\) NO\\(_3\\) (0.07, 5) (0.07, 5) 0.07 5 The nitrate concentration for which the computed denitrification rate is half the user specified rate, at 20\\(^o\\)C and with no influence of ambient dissolved oxygen concentration. This is not user specifiable and is set to the default value denitrification == science Denitrification model Michaelis Menten;exponential 0 (, ) 0 The model used to simulate denitrification denitrification == science Wet atmospheric inorganic nitrogen deposition \\(\\left[{TN}\\right]_{rain}\\) mg/L N mmol/m\\(^3\\) N (0, 98) (0, 7000) 0 0 The concentration of total inorganic nitrogen in rainfall. This is the sum of ammonium and nitrate N and is applied as a multiplicative factor to rainfall depth to compute a mass flux atmospheric deposition == science Dry atmospheric inorganic nitrogen deposition \\(R_{atm-dry}^{TN}\\) mg/m\\(^2\\)/d N mmol/m\\(^2\\)/d N (0, 98) (0, 7000) 0 0 The rate of atmopsheric fallout of dry inorganic nitrogen. This is the sum of ammonium and nitrate N and is applied as a spatial and temporal constant value to compute a mass flux atmospheric deposition == science Fraction of atmospheric nitrogen deposition that is nitrate \\(f_{TN}^{NO_3}\\) [-] (0, 1) 0 The fraction of N that is nitrate in atmospheric deposition. The same factor is applied to both wet and dry deposition of N. A value of 1 (0) will set wet and dry deposition to be purely nitrate (ammonium) atmospheric deposition == science Minimum FRP concentration \\(\\left[FRP\\right]_{min}^{FRP}\\) mg/L PO\\(_4\\)-P mmol/m\\(^3\\) PO\\(_4\\)-P (0, 0.01) (0, 0.32) NA NA The minimum allowable FRP concentration. If the WQM detects a concentration less than this, then it will be reset to this value, and reported in the WQM log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual FRP min max == science Maximum FRP concentration \\(\\left[FRP\\right]_{max}^{FRP}\\) mg/L PO\\(_4\\)-P mmol/m\\(^3\\) PO\\(_4\\)-P (0, 10) (0, 320) NA NA The maximum allowable FRP concentration. If the WQM detects a concentration greater than this, then it will be reset to this value, and reported in the WQM log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues FRP min max == science Sediment FRP flux \\(F_{sed}^{FRP}\\) mg FRP/m\\(^2\\)/d mmol FRP/m\\(^2\\)/d (0, 155) (0, 5) 0 0 The rate at which FRP is exchanged between the sediments and overlying water column at 20\\(^o\\)C excluding the influence of overlying dissolved oxygen concentration. Can be varied spatially via use of model mesh material types. This is not the maxuimum rate of FRP sediment flux FRP flux == science Sediment half saturation oxygen concentration for FRP flux \\(K_{sed-O_2}^{FRP}\\) mg/L O\\(_2\\) mmol/m\\(^3\\) O\\(_2\\) (0, 4.8) (0, 150) 4 125 The dissolved oxygen concentration for which the computed sediment FRP flux is half the user specified rate, at 20\\(^o\\)C. Cannot be varied spatially FRP benthic == science Sediment FRP flux temperature coefficient \\(\\theta_{sed}^{FRP}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on FRP sediment flux. A value of 1.0 will remove the effect of temperature FRP benthic == science Wet atmospheric FRP deposition \\(\\left[{FRP}\\right]_{rain}\\) mg/L P mmol/m\\(^3\\) P (0, 10) (0, 320) 0 0 The concentration of FRP in rainfall. This is only FRP P and is applied as a multiplicative factor to rainfall depth to compute a mass flux atmospheric deposition == science Dry atmospheric FRP deposition \\(R_{atm-dry}^{adsFRP}\\) mg/m\\(^2\\)/d P mmol/m\\(^2\\)/d P (0, 10) (0, 320) 0 0 The rate of atmopsheric fallout of adsorbed FRP. This is only applied to adsorbed FRP P. If adsorbed FRP is not simulated then this value is ignored. If used, it is applied as a spatial and temporal constant value to compute a mass flux atmospheric deposition == science Minimum adsorbed FRP concentration \\(\\left[adsFRP\\right]_{min}^{adsFRP}\\) mg/L PO\\(_4\\)-P mmol/m\\(^3\\) PO\\(_4\\)-P (0, 0.01) (0, 0.32) NA NA The minimum allowable adsorbed FRP concentration. If the WQM detects a concentration less than this, then it will be reset to this value, and reported in the WQM log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. A value other than zero for this parameter would be unusual ads FRP min max == science Maximum adsorbed FRP concentration \\(\\left[adsFRP\\right]_{max}^{adsFRP}\\) mg/L PO\\(_4\\)-P mmol/m\\(^3\\) PO\\(_4\\)-P (0, 10) (0, 320) NA NA The maximum allowable adsorbed FRP concentration. If the WQM detects a concentration greater than this, then it will be reset to this value, and reported in the WQM log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues ads FRP min max == science Linear FRP sorption partitioning coefficient \\(K_{ads-L}^{FRP}\\) L/mg (0.01, 0.1) 0.01 The coefficient that determines the partitioning of FRP between free and adsorbed states. Can be estimated by dividing adsorbed FRP by free FRP and the concentration of suspended sediment, if these three quantities are known adsorption == science Quadratic FRP sorption partitioning coefficient \\(K_{ads-Q}^{FRP}\\) L/mg (0.6, 0.8) 0.7 The ratio of adsorption and desorption rate coefficients for phosphorus adsorption == science Maximum adsorption capacity of phosphorus \\(Q^{FRP}_{max}\\) mg P/mg TSS (0.005, 0.006) 0.0051 The maximum mass of P that can be adsorbed onto ambient suspended sediment, per unit mass of suspended sediment adsorption == science Maximum adsorption particle size \\(D50_{ads-max}^{FRP}\\) m (1e-09, 1e-06) 1e-08 The maximum D\\(_{50}\\) of sediment fractions allowed to adsorb FRP. This should encompass typical fine sediments and is used in both linear and quadratic models adsorption == science Minimum phyto concentration \\(\\left[PHY\\right]_{min}^{PHY}\\) \\(\\mu\\)g/L Chl a mmol/m\\(^3\\) C (0.01, 0.1) (0.0225, 0.225) 0.01 0.0225 The minimum allowable group phytoplankton concentration. If the WQM detects a concentration less than this, then it will be reset to this value, and reported in the WQM log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues. It is also important the this minuimum value not be set to zero. If phytoplankton concentrations are allowed to reduce to zero then the numerical scheme will not allow the group to regrow because growth is applied as a multiplicative factor from one timestep to the next. Multiplying any growth rate by a previous timesteps zero group concentration will therefore always result in zero group oncentration for subsequent timesteps min max == science Maximum phyto concentration \\(\\left[PHY\\right]_{max}^{PHY}\\) \\(\\mu\\)g/L Chl a mmol/m\\(^3\\) C (0.01, 20) (0.0025, 45) NA NA The maximum allowable group phytoplankton concentration. If the WQM detects a concentration greater than this, then it will be reset to this value, and reported in the WQM log file. The root cause for requiring this reset should be addressed as this resetting is not intended to be a permanent solution and will cause mass conservation issues min max == science Standard temperature \\(T_{std}^{phy}\\) \\(^o\\)C (5, 25) 10 Used to compute shape of temperature limitation function between T\\(_{std}\\) and T\\(_{max}\\). Below T\\(_{std}\\), the phytoplankton temperature limitation function is a simple Arrhenius relationship. Must always be less than the specified T$_{max} temperature limitation == science Optimum temperature \\(T_{opt}^{phy}\\) \\(^o\\)C (5, 25) 20 Used to compute shape of temperature limitation function between T\\(_{std}\\) and T\\(_{max}\\). Must always be less than the specified T$_{max} temperature limitation == science Maximum temperature \\(T_{max}^{phy}\\) \\(^o\\)C (25, 35) 30 Used to compute shape of temperature limitation function between T\\(_{std}\\) and T\\(_{max}\\). Above T\\(_{max}\\), the phytoplankton temperature limitation function is 0. Must always be greater than the specified T\\(_{std} and T\\)_{opt}$ temperature limitation == science Optimum freshwater salinity \\(S_{opt-fresh}^{phy}\\) g/L (0, 45) 0 Used to compute the freshwater salinity limitation function. It is the maximum salinity at which the freshwater salinity limitation function has a value of 1 salinity limitation == science Maximum freshwater salinity \\(S_{max-fresh}^{phy}\\) g/L (0, 45) 5 Used to compute the freshwater salinity limitation function. It is the maximum salinity at which the freshwater salinity limitation function is greater than the vlaue of \\(L_{max-fresh}^{phy}\\) salinity limitation == science Limitation function at maximum freshwater salinity \\(L_{max-fresh}^{phy}\\) [-] (0, 1) 0 Used to compute the freshwater salinity limitation function. It is the value of the freshwater limitation function at a salinity of \\(S_{max-fresh}\\) salinity limitation == science Optimum marine salinity \\(S_{opt-marine}^{phy}\\) g/L (0, 45) 0 Used to compute the marine salinity limitation function. It is the minimum salinity at which the marine salinity limitation function has a value of 1 salinity limitation == science Limitation function at zero marine salinity \\(L_{max-fresh}^{phy}\\) [-] (0, 1) 0 Used to compute the marine salinity limitation function. It is the value of the marine limitation function at a salinity of zero salinity limitation == science Optimum mixed salinity \\(S_{opt-mix}^{phy}\\) g/L (0, 45) 0 Used to compute the mixed salinity limitation function. It is the minimum salinity at which the mixed salinity limitation function has a value of 1 salinity limitation == science Maximum mixed salinity \\(S_{max-mix}^{phy}\\) g/L (0, 45) 5 Used to compute the mixed salinity limitation function. It is the maximum salinity at which the mixed salinity limitation function has a value of 1 salinity limitation == science Limitation function at zero and (\\(S_{opt-mix}^{phy} + S_{max-mix}^{phy}\\)) mixed salinity \\(L_{zero-mix}^{phy}\\) [-] (0, 1) 0 Used to compute the mixed salinity limitation function. It is the value of the mixed limitation function at a salinity of zero and (\\(S_{opt-mix}^{phy} + S_{max-mix}^{phy}\\)) salinity limitation == science Optimum estuarine salinity \\(S_{opt-est}^{phy}\\) g/L (0, 45) 0 Used to compute the estuarine salinity limitation function. It is the salinity at which the estuarine salinity limitation function has a value of 1 salinity limitation == science Maximum estuarine salinity \\(S_{max-est}^{phy}\\) g/L (0, 45) 5 Used to compute the estuarine salinity limitation function. It is the maximum salinity at which the estuarine salinity limitation function has a value greater than zero salinity limitation == science Power coefficient for estuarine salinity limitation \\(P_{est}^{phy}\\) [-] (0, 5) 0 Used to compute the estuarine salinity limitation function. It determines the gradient of the estuarine limitation function (with salinity) above and below \\(S_{opt-est}^{phy}\\). Small (large) values of this parameter provide low (high) gradients salinity limitation == science Minimum concentration of N for phytoplankton uptake \\(\\left[N\\right]_{min}^{phy}\\) mg/L N mmol/m\\(^3\\) N (0, 0.1) (0.00, 7.14) 0.01 0.71 Used to compute the nitrogen limitation function in the basic phytoplankton model. Also used by the advanced phytoplankton model if internal nitrogen stores are exhausted. It is the minimum N concentration (as NH\\(_4\\)-N + NO\\(_3\\)-N) at which uptake of nitrogen by phytoplankton can occur nitrogen limitation == science Half saturation N concentration for phytoplankton uptake of N \\(K_{lim-N}^{phy}\\) mg/L N mmol/m\\(^3\\) N (1, 5) (71.4, 357.14) 1 71.43 Used to compute the nitrogen limitation function in the basic phytoplankton model. Also used by the advanced phytoplankton model if internal nitrogen stores are exhausted. It is the concentration of N (ammonium-N and nitrate-N) that when added to the specified minimum \\(\\left[N\\right]_{min}^{phy}\\) sets the nitrogen limitation function to a value of 0.5. A value of zero for this parameter will set the nitrogen limitation function to always be 1 nitrogen limitation == science Minimum ratio of internal phytoplankton N to biomass \\(X_{N-C-min}^{phy}\\) mg N/mg Chl a mmol N/mmol C (2.97, 4.75) (0.09, 0.15) 2.97 0.09 Used to compute the nitrogen limitation function in the advanced phytoplankton model if internal nitrogen stores are not exhausted. It should be based on the Redfield ratio of 106:16:1 or C:N:P (or Chla a equivalent). Note the units of mg of Chl a rather than \\(\\mu\\)g nitrogen limitation == science Maximum ratio of internal phytoplankton N to biomass \\(X_{N-C-max}^{phy}\\) mg N/mg Chl a mmol N/mmol C (4.75, 6.54) (0.15, 0.21) 6.54 0.21 Used to compute the nitrogen limitation function in the advanced phytoplankton model if internal nitrogen stores are not exhausted. It should be based on the Redfield ratio of 106:16:1 or C:N:P (or Chla a equivalent). Note the units of mg of Chl a rather than \\(\\mu\\)g nitrogen limitation == science Minimum concentration of P for phytoplankton uptake \\(\\left[P\\right]_{min}^{phy}\\) mg/L P mmol/m\\(^3\\) P (0, 0.1) (0.0, 3.23) 0.001 0.03 Used to compute the phosphorus limitation function in the basic phytoplankton model. Also used by the advanced phytoplankton model if internal phosphorus stores are exhausted. It is the minimum P concentration (as FRP-P) at which uptake of phosphorus by phytoplankton can occur phosphorus limitation == science Half saturation P concentration for phytoplankton uptake of P \\(K_{lim-P}^{phy}\\) mg/L P mmol/m\\(^3\\) P (0.1, 0.5) (3.23, 16.13) 0.1 3.23 Used to compute the phosphorus limitation function in the basic phytoplankton model. Also used by the advanced phytoplankton model if internal phosphorus stores are exhausted. It is the concentration of P (FRP-P) that when added to the specified minimum \\(\\left[P\\right]_{min}^{phy}\\) sets the phosphorus limitation function to a value of 0.5. A value of zero for this parameter will set the phosphorus limitation function to always be 1 phosphorus limitation == science Minimum ratio of internal phytoplankton P to biomass \\(X_{P-C-min}^{phy}\\) mg P/mg Chl a mmol P/mmol C (0.33, 0.66) (0.005, 0.009) 0.33 0.005 Used to compute the phosphorus limitation function in the advanced phytoplankton model if internal phosphorus stores are not exhausted. It should be based on the Redfield ratio of 106:16:1 or C:N:P (or Chla a equivalent). Note the units of mg of Chl a rather than \\(\\mu\\)g phosphorus limitation == science Maximum ratio of internal phytoplankton P to biomass \\(X_{P-C-max}^{phy}\\) mg P/mg Chl a mmol P/mmol C (0.66, 0.99) (0.009, 0.014) 0.99 0.014 Used to compute the phosphorus limitation function in the advanced phytoplankton model if internal phosphorus stores are not exhausted. It should be based on the Redfield ratio of 106:16:1 or C:N:P (or Chla a equivalent). Note the units of mg of Chl a rather than \\(\\mu\\)g phosphorus limitation == science Minimum concentration of silicate for phytoplankton uptake \\(\\left[Si\\right]_{min}^{phy}\\) mg/L Si mmol/m\\(^3\\) Si (0, 0.1) (0.00, 3.57) 0.01 0.36 Used to compute the silicate limitation function in the basic and advanced phytoplankton model. It is the minimum silicate concentration at which uptake of silicate by phytoplankton can occur silicate limitation == science Half saturation silicate concentration for phytoplankton uptake of silicate \\(K_{lim-Si}^{phy}\\) mg/L Si mmol/m\\(^3\\) Si (1, 10) (35.71, 357.14) 1 35.71 Used to compute the silicate limitation function in the basic and advanced phytoplankton model. It is the concentration of silicate that when added to the specified minimum \\(\\left[Si\\right]_{min}^{phy}\\) sets the silicate limitation function to a value of 0.5. A value of zero for this parameter will set the silicate limitation function to always be 1 silicate limitation == science Half saturation constant for basic model light growth limitation \\(I_{K-bas}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the basic light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident on the top and bottom of a computational cell and forms the lower limit of the exponential integral light limitation == science Half saturation constant for monod model light growth limitation \\(I_{K-mon}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the monod light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident at the centre of a computational cell light limitation == science Saturating light intensity for the steele model light growth limitation \\(I_{S-ste}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the steele light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident at the centre of a computational cell. This limitation function includes photoinhibition light limitation == science Half saturation constant for webb model light growth limitation \\(I_{K-web}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the webb light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident at the centre of a computational cell light limitation == science Half saturation constant for jassby model light growth limitation \\(I_{K-jas}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the jassby light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident at the centre of a computational cell light limitation == science Half saturation constant for chalker model light growth limitation \\(I_{K-cha}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the chalker light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident at the centre of a computational cell light limitation == science Saturating light intensity for the klepper model light growth limitation \\(I_{S-kle}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the klepper light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident at the centre of a computational cell. This limitation function includes photoinhibition light limitation == science Saturating light intensity for the integrated model light growth limitation \\(I_{S-int}\\) W/m\\(^2\\) (1, 1500) 20 Used to compute the integrated light limitation function for both basic and advanced phytoplankton constituent models. It divides (normalises) the photosynthetically available radiation incident on the top and bottom of a computational cell. This limitation function includes photoinhibition light limitation == science Constant ratio of internal phytoplankton N to biomass \\(X_{N-C-con}^{phy}\\) mg N/mg Chl a mmol N/mmol C (2.97, 6.54) (0.09, 0.21) 4.75 0.15 Used to compute the uptake of nitrogen during growth in the basic phytoplankton constituent model only. It should be based on the Redfield ratio of 106:16:1 or C:N:P (or Chla a equivalent). Note the units of mg of Chl a rather than \\(\\mu\\)g uptake == science Constant ratio of internal phytoplankton P to biomass \\(X_{P-C-con}^{phy}\\) mg P/mg Chl a mmol P/mmol C (0.33, 0.99) (0.009, 0.014) 0.66 0.009 Used to compute the uptake of phosphorus during growth in the basic phytoplankton constituent model only. It should be based on the Redfield ratio of 106:16:1 or C:N:P (or Chla a equivalent). Note the units of mg of Chl a rather than \\(\\mu\\)g uptake == science Constant ratio of internal phytoplankton silicate to biomass \\(X_{Si-C-con}^{phy}\\) mg Si/mg Chl a mmol Si/mmol C (5.94, 11.89) (0.09, 0.19) 8.92 0.14 Used to compute the uptake of silicate during growth in the basic and advanced phytoplankton constituent models. It should be based on the extended Redfield ratio of 106:16:1:15 or C:N:P:Si (or Chla a equivalent). Note the units of mg of Chl a rather than \\(\\mu\\)g uptake == science Rate of inorganic nitrogen uptake by phytoplankton \\(R_{N-uptake}^{phy}\\) mg N/mg Chl a/d mmol N/mmol C/d (0.080, 2.704) (0.0025, 0.086) 0 0 Used to compute the uptake of nitrogen during growth in the advanced phytoplankton constituent model only. It is the nitrogen uptake rate per unit of phytoplankton (per day) without any influence of temperature or nutrient limitation. The unit of phytoplankton is either mg (not \\(\\mu\\)g) Chl a or mmol C, depending on the units systm used uptake == science Rate of inorganic phosphorus uptake by phytoplankton \\(R_{P-uptake}^{phy}\\) mg P/mg Chl a/d mmol P/mmol C/d (0.011, 0.374) (0.0002, 0.005) 0 0 Used to compute the uptake of phosphorus during growth in the advanced phytoplankton constituent model only. It is the phosphorus uptake rate per unit of phytoplankton (per day) without any influence of temperature or nutrient limitation. The unit of phytoplankton is either mg (not \\(\\mu\\)g) Chl a or mmol C, depending on the units systm used uptake == science Constant rate of phytoplankton settling \\(V_{sett-con}^{phy}\\) m/d (0, 50) 0 The constant settling velocity applied to phytoplankton using either the basic or advanced phytoplankton constituent model. A negative value is a downwards velocity settling == science Constant rate of phytoplankton settling with thermal adjustment \\(V_{sett-thr}^{phy}\\) m/d (0, 50) 0 The constant settling velocity applied to phytoplankton, that is then modified by local water temperature (via viscosity). It can be applied to either the basic or advanced phytoplankton constituent model. A negative value is a downwards velocity settling == science Stokes settling light half saturation light intensity \\(I_{K-sto}\\) W/m\\(^2\\) (0, 1500) 20 The half saturation light intensity used to compute cell density, which is in turn required for calculation of Stokes settling velocity. It can be applied to either the basic or advanced phytoplankton constituent model. This value is ignored if \\(I_K\\) has been specified in a light limitation model within the same phytoplankton constituent model block settling == science Motile settling velocity \\(V_{mot}^{phy}\\) m/d (0, 50) 0 The motile settling velocity applied to phytoplankton, that is then modified by local light conditions. It can be applied to only to the advanced phytoplankton constituent model. A negative value is a downwards velocity settling == science Motile settling light half saturation light intensity \\(I_{K-mot}\\) W/m\\(^2\\) (0, 1500) 20 The half saturation light intensity used to compute direction of motility. It can be applied only to the advanced phytoplankton constituent model. This value is ignored if \\(I_K\\) has been specified in a light limitation model within the same phytoplankton constituent model block settling == science Carbon to chlorophyll a ratio \\(X_{cc}^{phy}\\) mg carbon / mg chlorophyll a (20, 40) 27 The ratio of carbon to chlorophyll a in the cellular biomass of a phytoplankton group. The units of chlorophyll a in this ratio are milligrams (mg), not \\(\\mu\\)g. This value is constant for a given phytoplankton group carbon chla ratio == science Nitrogen fixing rate \\(R_{nfix}^{N_2}\\) mg N / mg Chl a / d mmol N / mmol C /d (0, 5) (0, 0.158730158730159) 0 0 The rate at which nitrogen N is fixed from the atmosphere to complement nitrogen uptake from the water column. This rate excludes the influence of nitrogen limitation due to water column nutrient scarcity. It is the mass (or molar) rate of uptake of nitrogen N from the atmopshere, not N\\(_2\\). Note the units of chlorophyll a are in mg, not \\(\\mu\\)g nitrogen fixing == science Penalty function of nitrogen fixing on primary productivity \\(f_{nfix}^{phy}\\) [-] (0, 1) 1 A rate modifier that accounts for the metabolic cost of nitrogen fixing on primary productivity. This modifier can be thought of as a penalty function, with values of zero and one corresponding to no and maximum penalties, respectively. A penalty of 1 (the default) will always set primary productivity to zero nitrogen fixing == science Phytoplankton primary productivity rate \\(R_{prod}^{phy}\\) /d (0, 3.5) 0 The phytoplankton primary productivity (growth) rate at 20\\(^o\\)C with no light, temperature, salinty, silicate or nutrient limitation. This rate is multiplied by ambient phytoplankton concentration to derive initial carbon, nutrient and silicate uptake fluxes growth == science Phytoplankton primary productivity temperature coefficient \\(\\theta_{prod}^{phy}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on phytoplankton growth in the standard temperature limitation function. A value of 1.0 will remove the effect of temperature growth == science Phytoplankton respiration rate \\(R_{resp}^{phy}\\) /d (0, 0.1) 0 The phytoplankton respiration rate at 20\\(^o\\)C with no temperature or salinty limitation. This rate is multiplied by ambient phytoplankton concentration to derive excretion and mortality fluxes. It is added to the parallel primary productivity and exudation rates and then multiplied by ambient phytoplankton concentration to compute biomass flux respiration == science Phytoplankton respiration temperature coefficient \\(\\theta_{resp}^{phy}\\) [-] (1, 1.1) 1 The factor to which (\\(T\\)-20) is raised to account for temperature effects on phytoplankton respiration. A value of 1.0 will remove the effect of temperature respiration == science Fraction of phytoplankton respiration that is true respiration \\(f_{true-resp}^{phy}\\) [-] (0, 1) 1 The proportion of consumed carbohydrates (that were generated during photosynthesis) that are converted to energy, as opposed to waste matter. A value of one (zero) has all consumed carbohydrates converted to energy (waste), and will minimise (maximise) excretive losses respiration == science Fraction of phytoplanton biomass loss that becomes dissolved organic matter \\(f_{DOM-loss}^{phy}\\) [-] (0, 1) 0 The proportion of non-exudation excretive losses that are lost as dissolved organic matter. If \\(f_{true-resp}^{phy}\\) is set to one (zero) then this parameter has no (maximum) effect. respiration == science Fraction of primary production lost to exudation \\(f_{exud}^{phy}\\) [-] (0, 1) 0 The proportion of primary production that does not generate retained cellular carbon biomass, but is lost through exudation (and hence excretion). Exudation losses are summed with potentially modified respiration losses to compute excretion respiration == science Phytoplankton specific shading coefficient \\(Ke^{phy}\\) /(\\(\\mu\\)g Chl a/L)/m /(mmol C/m\\(^3\\))/m (0, 0.0225) (0, 0.01) 0 0 The rate at which light is attenuated by phytoplankton. This coefficient is per unit concentration of phytoplankton, per metre (depth). It is multiplied by phytoplankton concentration in each computational cell to leave a value that has units of per meter, which is the same as standard extinction coefficients and therefore is ble to be added to other (e.g. background) parallel extinction coefficients. This parameter is used in all light limitation == commands, but only the reference to the basic model is included in this table. Use the navigation in the commands Appendix to see linkages with other light limitation commands light limitation == science "],["AppCompQuans.html", "Appendix P Computed quantities", " Appendix P Computed quantities .book .book-body .page-wrapper .page-inner { max-width: 95%; } Following are quantities that are computed by the WQM, with or without user inputs. Some fixed parameters are also included. Tips for use: Use the search box to dynamically filter the table Sort the filtered (or unfiltered) table by clicking the arrows at the top of each column Use s on your keyboard to toggle the contents pane on and off to provide more screen width if needed For each parameter, use the link in the final column to navigate to the section describing the relevant science and/or equations. These links are all called science Table P.1: WQM computed quantities Quantity Notation Units Description Links Schmidt number \\(Sc_{atm}^{O_2}\\) [-] Used to subsequently compute a piston velocity for atmospheric oxygenation of surface waters. Requires temperature and salinity for calculation science Piston velocity \\(V_{pist}^{O_2}\\) m/s The rate at which atmospheric oxygen enters the water column. Relies on calculation of the Schmidt number science Wind speed \\(V_{wind}^{O_2}\\) m/s The wind speed passed from TUFLOW to the WQM. Assumed to be 10 metres from the water surface, and used to compute flux of atmospheric oxygen into the surface of a model science Atmospheric flux of oxygen \\(F_{atm}^{O_2}\\) mg O\\(_2\\)/m\\(^2\\)/d mmol O\\(_2\\)/m\\(^2\\)/d The flux of oxygen from the atmosphere into the surface layer of a model. Assumed that the atmospheric oxygen concentration is the saturated oxygen concentration in water that has the temperature and salinity of the surface layer at the time of calculation science Water temperature \\(T\\) \\(^o\\)C Computed ambient water temperature in each computational cell provided to the WQM by the hydrodynamic model science Water salinity \\(S\\) g/L Computed ambient water salinity in each computational cell provided to the WQM by the hydrodynamic model science Dissolved oxygen concentration \\(\\left[DO\\right]\\) mg O\\(_2\\)/L mmol O\\(_2\\)/m\\(^3\\) Computed ambient dissolved oxygen concentration in each computational cell. This is a concentration of the diatomic O\\(^2\\) molecule science Atmospheric oxygen concentration \\(\\left[DO\\right]_{air}\\) mg O\\(_2\\)/L mmol O\\(_2\\)/m\\(^3\\) Computed atmospheric oxygen concentration. Assumed to be the saturated oxygen concentration of water at the computed temperature and salinity of the surface water to which atmospheric aeration is applied. This is a concentration of the diatomic O\\(^2\\) molecule science "],["AppMBal.html", "Appendix Q Mass Balance", " Appendix Q Mass Balance TBC "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
